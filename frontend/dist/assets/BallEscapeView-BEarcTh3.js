import{i as be}from"./client-B9f43BVd.js";import{d as _e,o as Se,D as Me,b as A,e as o,t as k,n as le,C as ye,k as ie,F as Ce,v as we,r as R,c as Pe,a as T}from"./vue-En_qHaif.js";import{_ as Ie}from"./index-2HdLWYgI.js";import"./index-D5GkNzM3.js";const xe={class:"ball-escape-view"},Ae={class:"game-header"},ke={class:"game-id"},Re={class:"label"},Te={class:"balance-badge"},Ee={class:"arena-container"},Ge={key:0,class:"result-text won"},Fe={key:1,class:"result-text lost"},Le={class:"hash-row"},He={class:"hash-value"},Be={class:"bet-row"},De=["onClick","disabled"],Xe={class:"action-row"},Ye=["disabled"],Oe={key:0},Ne={key:1},Ve={key:2},f=320,ce=420,g=120,E=12,oe=.45,We=.12,de=.65,ue=.992,Ue=.008,$e=.02,J=12,q=160,z=140,h=340,G=60,qe=_e({__name:"BallEscapeView",setup(ze){const ne=R(null),Y=R(10),he=[.5,1,3,5,10],M=R(1),a=R("idle"),x=R(1),se=R(Math.floor(Math.random()*9e5)+1e5),K=R("---");let y=null,O=0,p=0,Q=0,c=0,d=0,s=0,r=0,u=[],re=0,ee=5e3,Z=!1,N=1,m=!1,V=null;const fe=Pe(()=>a.value==="won"?"#4ade80":a.value==="lost"?"#ef4444":x.value>=2?"#4ade80":"#22d3ee");function ge(n){a.value==="idle"&&(M.value=n)}async function ve(){if(a.value==="playing"||Y.value<M.value)return;Y.value-=M.value,a.value="playing",x.value=1,se.value=Math.floor(Math.random()*9e5)+1e5;const n=Math.random()*Math.PI*2,e=20+Math.random()*30;c=Math.cos(n)*e,d=Math.sin(n)*e,s=(Math.random()-.5)*2,r=(Math.random()-.5)*2+1,O=0,p=.02,Q=Math.random()*Math.PI*2,u=[],m=!1,V=null;try{const t=await be({amount:M.value,client_seed:Math.random().toString(36).substring(2,10),nonce:Date.now(),user_id:"user"});Z=t.escaped,ee=t.duration_ms,N=t.multiplier,K.value=t.server_seed_hash.slice(0,6)+"..."+t.server_seed_hash.slice(-4)}catch{Z=Math.random()<.4,ee=4e3+Math.random()*3e3,N=1.5+Math.random()*3.5,K.value=Math.random().toString(36).slice(2,8)+"..."}re=Date.now(),y=requestAnimationFrame(j)}function j(){const n=Date.now()-re,e=Math.min(n/ee,1);x.value=1+(N-1)*e,p=.02+e*.025,O+=p;const t=Q+O;if(m){r+=.4,s*=.99;const i=q+c,C=((Z?f*.25:f*.75)-i)*.003;if(s+=C,c+=s,d+=r,u.unshift({x:q+c,y:z+d}),u.length>J&&u.pop(),z+d>=h-E){V=q+c<f/2?"green":"red",d=h-E-z,r=0,s=0,pe(V==="green");return}F(),y=requestAnimationFrame(j);return}const l=Math.sqrt(c*c+d*d);if(l>.1){const i=Ue*p*p*l,B=c/l*i,C=d/l*i;s+=B,r+=C}const L=$e*p,W=-r*L,H=s*L;s+=W,r+=H,r+=We,s*=ue,r*=ue,c+=s,d+=r,u.unshift({x:c,y:d}),u.length>J&&u.pop();const b=g-E;if(l>b){const i=Math.atan2(d,c);if(Math.abs(me(i-t))<oe/2&&l>b-5){m=!0,u=[],s=Math.cos(i)*3,r=Math.sin(i)*3+2,F(),y=requestAnimationFrame(j);return}c=Math.cos(i)*b,d=Math.sin(i)*b;const w=Math.cos(i),P=Math.sin(i),D=s*w+r*P;if(D>0){s=(s-2*D*w)*de,r=(r-2*D*P)*de;const X=-P,I=w,_=p*l*.3;s+=X*_,r+=I*_;const v=p*8;s+=(Math.random()-.5)*v,r+=(Math.random()-.5)*v}}if(e>=1&&!m){m=!0,u=[];const i=Z?-60:60;c=0,d=g,s=i/25,r=2}F(),y=requestAnimationFrame(j)}function pe(n){y&&cancelAnimationFrame(y),x.value=N,n?(a.value="won",Y.value+=M.value*N):a.value="lost",F(),setTimeout(()=>{a.value="idle",x.value=1,F()},2500)}function me(n){for(;n>Math.PI;)n-=Math.PI*2;for(;n<-Math.PI;)n+=Math.PI*2;return n}function F(){const n=ne.value;if(!n)return;const e=n.getContext("2d");if(!e)return;const t=q,l=z;e.fillStyle="#0a0c14",e.fillRect(0,0,f,ce);const L=e.createLinearGradient(0,h,0,h+G);L.addColorStop(0,"rgba(34, 197, 94, 0.4)"),L.addColorStop(1,"rgba(34, 197, 94, 0.2)"),e.fillStyle=L,e.fillRect(0,h,f/2,G);const W=e.createLinearGradient(0,h,0,h+G);W.addColorStop(0,"rgba(239, 68, 68, 0.4)"),W.addColorStop(1,"rgba(239, 68, 68, 0.2)"),e.fillStyle=W,e.fillRect(f/2,h,f/2,G),e.strokeStyle="rgba(255, 255, 255, 0.3)",e.lineWidth=2,e.beginPath(),e.moveTo(f/2,h),e.lineTo(f/2,h+G),e.stroke(),e.strokeStyle="rgba(255, 255, 255, 0.2)",e.lineWidth=1,e.beginPath(),e.moveTo(0,h),e.lineTo(f,h),e.stroke(),e.font="bold 14px -apple-system, sans-serif",e.textAlign="center",e.textBaseline="middle",e.fillStyle=V==="green"?"#4ade80":"rgba(74, 222, 128, 0.6)",e.fillText("WIN",f/4,h+G/2),e.fillStyle=V==="red"?"#ef4444":"rgba(239, 68, 68, 0.6)",e.fillText("LOSE",f*3/4,h+G/2);const H=Q+O,b=e.createRadialGradient(t,l,g-20,t,l,g+10);b.addColorStop(0,"rgba(139, 92, 246, 0.0)"),b.addColorStop(.7,"rgba(139, 92, 246, 0.15)"),b.addColorStop(1,"rgba(139, 92, 246, 0.0)"),e.fillStyle=b,e.beginPath(),e.arc(t,l,g+10,0,Math.PI*2),e.fill(),e.strokeStyle="rgba(139, 92, 246, 0.6)",e.lineWidth=8,e.lineCap="round";const i=H-oe/2,B=H+oe/2;e.beginPath(),e.arc(t,l,g,B,i+Math.PI*2),e.stroke();const C=t+Math.cos(H)*g,w=l+Math.sin(H)*g,P=e.createRadialGradient(C,w,0,C,w,35),D=.3+Math.sin(Date.now()/200)*.15;if(P.addColorStop(0,`rgba(251, 191, 36, ${D})`),P.addColorStop(1,"rgba(251, 191, 36, 0)"),e.fillStyle=P,e.beginPath(),e.arc(C,w,35,0,Math.PI*2),e.fill(),e.strokeStyle="#fbbf24",e.lineWidth=4,e.beginPath(),e.arc(t,l,g+6,i,B),e.stroke(),a.value==="playing"&&!m)for(let U=0;U<4;U++){const $=O+U*Math.PI*2/4,te=t+Math.cos($)*(g-15),ae=l+Math.sin($)*(g-15);e.save(),e.translate(te,ae),e.rotate($+Math.PI/2),e.fillStyle=`rgba(139, 92, 246, ${.3+p*5})`,e.beginPath(),e.moveTo(0,-6),e.lineTo(4,2),e.lineTo(-4,2),e.closePath(),e.fill(),e.restore()}const X=e.createRadialGradient(t-30,l-30,0,t,l,g);if(X.addColorStop(0,"rgba(139, 92, 246, 0.1)"),X.addColorStop(.5,"rgba(139, 92, 246, 0.03)"),X.addColorStop(1,"rgba(0, 0, 0, 0)"),e.fillStyle=X,e.beginPath(),e.arc(t,l,g-10,0,Math.PI*2),e.fill(),u.length>1&&a.value==="playing")for(let S=1;S<u.length;S++){const U=1-S/J,$=E*(1-S/J*.7);e.fillStyle=`rgba(34, 211, 238, ${U*.4})`,e.beginPath();const te=m?u[S].x:t+u[S].x,ae=m?u[S].y:l+u[S].y;e.arc(te,ae,$,0,Math.PI*2),e.fill()}let I,_;m?(I=q+c,_=z+d):(I=t+c,_=l+d),e.shadowColor=a.value==="won"?"rgba(74, 222, 128, 0.6)":a.value==="lost"?"rgba(239, 68, 68, 0.6)":"rgba(34, 211, 238, 0.6)",e.shadowBlur=15;const v=e.createRadialGradient(I-3,_-3,0,I,_,E);a.value==="won"?(v.addColorStop(0,"#86efac"),v.addColorStop(1,"#22c55e")):a.value==="lost"?(v.addColorStop(0,"#fca5a5"),v.addColorStop(1,"#ef4444")):(v.addColorStop(0,"#67e8f9"),v.addColorStop(1,"#06b6d4")),e.fillStyle=v,e.beginPath(),e.arc(I,_,E,0,Math.PI*2),e.fill(),e.shadowBlur=0,e.fillStyle="rgba(255, 255, 255, 0.4)",e.beginPath(),e.arc(I-3,_-3,E*.3,0,Math.PI*2),e.fill(),a.value==="idle"&&(e.textAlign="center",e.textBaseline="middle",e.fillStyle="rgba(255, 255, 255, 0.5)",e.font="13px -apple-system, sans-serif",e.fillText("Ð¨Ð°Ñ€Ð¸Ðº Ð²Ñ‹Ð»ÐµÑ‚Ð°ÐµÑ‚ Ñ‡ÐµÑ€ÐµÐ· Ð´Ñ‹Ñ€ÐºÑƒ",t,l-10),e.fillText("ÐŸÐ°Ð´Ð°ÐµÑ‚ Ð½Ð° Ð·ÐµÐ»Ñ‘Ð½Ð¾Ðµ = WIN",t,l+10))}return Se(()=>{F()}),Me(()=>{y&&cancelAnimationFrame(y)}),(n,e)=>(T(),A("div",xe,[o("header",Ae,[o("button",{class:"header-close",onClick:e[0]||(e[0]=t=>n.$router.back())},[...e[1]||(e[1]=[o("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M18 6L6 18M6 6l12 12"})],-1),o("span",null,"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ",-1)])]),o("div",ke,[o("span",Re,"Game #"+k(se.value),1)]),o("div",Te,[o("span",null,k(Y.value.toFixed(2))+" â—‡",1)])]),o("div",Ee,[o("canvas",{ref_key:"gameCanvas",ref:ne,class:"game-canvas",width:f,height:ce},null,512),o("div",{class:le(["multiplier-overlay",a.value])},[o("div",{class:"multiplier-value",style:ye({color:fe.value})},k(x.value.toFixed(2))+"x ",5),a.value==="won"?(T(),A("div",Ge,"ESCAPED! ðŸŽ‰")):ie("",!0),a.value==="lost"?(T(),A("div",Fe,"CAUGHT! ðŸ’€")):ie("",!0)],2)]),o("div",Le,[e[2]||(e[2]=o("span",{class:"hash-label"},"Hash:",-1)),o("span",He,k(K.value),1)]),o("div",Be,[(T(),A(Ce,null,we(he,t=>o("button",{key:t,class:le(["bet-btn",{active:M.value===t}]),onClick:l=>ge(t),disabled:a.value==="playing"},k(t)+" â—‡ ",11,De)),64))]),o("div",Xe,[o("button",{class:le(["play-btn",{playing:a.value==="playing"}]),disabled:a.value==="playing"||Y.value<M.value,onClick:ve},[a.value==="idle"?(T(),A("span",Oe,"Play "+k(M.value)+" â—‡",1)):a.value==="playing"?(T(),A("span",Ne,k(x.value.toFixed(2))+"x",1)):(T(),A("span",Ve,"Play Again"))],10,Ye)])]))}}),Qe=Ie(qe,[["__scopeId","data-v-ddbd1519"]]);export{Qe as default};
