import{d as Ve,x as He,j as qe,J as ze,y as Oe,c as T,b as a,F as he,f as fe,t as I,H as se,K as ke,n as ne,z as Pe,L as Xe,I as Ye,r as M,l as Ze,o as A,k as je,G as Je}from"./vue-DrcrC0TO.js";import{a as Ke}from"./index-nHsVjOhL.js";const Qe={class:"plinko-view"},et={class:"stars-bg"},tt={class:"plinko-header"},lt={class:"header-balance"},at={class:"balance-value"},ot={class:"game-info-bar"},st={class:"info-item"},nt={class:"info-value"},it={class:"info-item"},rt={class:"info-item"},dt={class:"result-multiplier"},ut={class:"bet-section"},vt={class:"bet-amounts"},ct=["onClick","disabled"],ht={class:"action-row"},ft=["disabled"],gt=["disabled"],pt={key:0,class:"loading-spinner"},mt={key:1},bt=["disabled"],yt={class:"auto-play"},Mt={class:"auto-label"},wt=["disabled"],Ct={class:"history-section"},St={class:"history-header"},_t={class:"history-list"},kt={class:"history-mult"},Pt={class:"history-amount"},m=7,Ie=.14,$e=.978,Te=.38,Ae=.25,ge=5.5,O=30,N=38,F=4,It=.12,pe=.998,$t=Ve({__name:"PlinkoView",setup(Tt){const R=M(5.16),me=M(48291),P=M(!1),K=M(!1),be=M(0),G=M(0),Q=M("medium"),V=M(12),Be=[.5,1,2,5,10],f=M(1),ee=M(!1),X=M(10),ie=M([]),$=M(null),ye=M(null);let v=380,B=500;const Le={low:{8:[5.6,1.5,.8,.5,.3,.5,.8,1.5,5.6],12:[8.9,3,1.2,.7,.5,.3,.2,.3,.5,.7,1.2,3,8.9],16:[16,9,2,1,.7,.4,.3,.2,.2,.3,.4,.7,1,2,9,16]},medium:{8:[13,3,.9,.4,.2,.4,.9,3,13],12:[33,11,3,1.2,.5,.3,.2,.3,.5,1.2,3,11,33],16:[110,41,10,3,1.2,.5,.3,.2,.2,.3,.5,1.2,3,10,41,110]},high:{8:[29,4,.9,.2,.1,.2,.9,4,29],12:[170,24,8.1,1.5,.4,.1,.1,.4,1.5,8.1,24,170],16:[1e3,130,26,9,2,.5,.1,.1,.1,.1,.5,2,9,26,130,1e3]}},te=Ze(()=>{const e=Le[Q.value];return e[V.value]||e[12]});let l=null,Y=[],x=[],H=null,q=null,re=0,w=0,C=0,g=0,L="idle",de=0,Z=28,le=0,ae=4,j=80,Me=0;const ue=()=>{Y=[];const e=V.value;e<=8?(Z=36,ae=5):e<=12?(Z=28,ae=4):(Z=22,ae=3.5),j=F+N+30,Me=B-36-10,le=(Me-j)/(e-1);const o=v/2;for(let i=0;i<e;i++){const n=i+3,r=(n-1)*Z,d=o-r/2;for(let c=0;c<n;c++)Y.push({x:d+c*Z,y:j+i*le,radius:ae,glowIntensity:0})}},we=(e,t,o,i)=>{for(let n=0;n<i;n++){const r=Math.random()*Math.PI*2,d=1+Math.random()*3;x.push({x:e,y:t,vx:Math.cos(r)*d,vy:Math.sin(r)*d,life:1,maxLife:15+Math.random()*15,color:o,size:1.5+Math.random()*2})}},Ce=()=>{for(let e=x.length-1;e>=0;e--){const t=x[e];t.x+=t.vx,t.y+=t.vy,t.vy+=.05,t.vx*=.97,t.life+=1,t.life>=t.maxLife&&x.splice(e,1)}},Ee=e=>({left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,width:`${Math.random()*2+1}px`,height:`${Math.random()*2+1}px`,animationDelay:`${Math.random()*3}s`,animationDuration:`${Math.random()*2+2}s`}),Fe=()=>{f.value=Math.max(.1,f.value/2)},Re=()=>{f.value=Math.min(R.value,f.value*2)},Se=async()=>{if(P.value||R.value<f.value)return;P.value=!0,K.value=!1,R.value-=f.value,me.value++;const e=te.value,t=(e.length-1)/2,o=e.map((r,d)=>{const c=Math.abs(d-t)/t;return Math.exp(-c*c*8)}),i=o.reduce((r,d)=>r+d,0);let n=Math.random()*i;re=Math.floor(t);for(let r=0;r<o.length;r++)if(n-=o[r],n<=0){re=r;break}ue(),q&&(cancelAnimationFrame(q),q=null),l={x:w,y:F+N-m,vx:0,vy:0,trail:[]},L="holding",de=0,x=[],oe()},oe=()=>{if(!l)return;const e=$.value;if(!e)return;const t=e.getContext("2d");if(!t)return;if(C+=g,g+=-.015*C,g*=pe,Math.abs(C)<.01&&Math.abs(g)<.001&&(g+=(Math.random()-.5)*.005),w=v/2+Math.sin(C)*v*.12,L==="holding"){l.x=w,l.y=F+N-m-2,de++,de>25&&(L="releasing",l.vx=g*v*.04,l.vy=.5),U(t),H=requestAnimationFrame(oe);return}if(L==="releasing"){l.vy+=Ie*.8,l.x+=l.vx,l.y+=l.vy,l.y>F+N+15&&(L="falling"),U(t),H=requestAnimationFrame(oe);return}l.vy+=Ie,l.vx*=$e,l.vy*=$e,l.x+=l.vx,l.y+=l.vy;const o=Math.sqrt(l.vx*l.vx+l.vy*l.vy);o>ge&&(l.vx=l.vx/o*ge,l.vy=l.vy/o*ge),l.trail.push({x:l.x,y:l.y,age:0}),l.trail.length>12&&l.trail.shift();for(const n of l.trail)n.age++;for(const n of Y){const r=l.x-n.x,d=l.y-n.y,c=r*r+d*d,k=n.radius+m,ce=k*k;if(c<ce&&c>.01){const E=Math.sqrt(c),W=r/E,h=d/E,D=k-E;l.x+=W*(D+.5),l.y+=h*(D+.5);const s=l.vx*W+l.vy*h;if(s<0){l.vx-=(1+Te)*s*W,l.vy-=(1+Te)*s*h;const _=(Math.random()-.5)*.9;l.vx+=_;const z=l.y/B;if(z>.35){const J=te.value,Ue=v/J.length,We=(re+.5)*Ue,De=.008*Math.pow((z-.35)/.65,1.5),Ne=(We-l.x)*De;l.vx+=Ne}l.vx*=.85}n.glowIntensity=1;const u=Math.round((n.y-j)/le)/V.value,b=Math.round(59+-45*u),y=Math.round(130+81*u),S=Math.round(246+-8*u);we(n.x,n.y,`rgb(${b},${y},${S})`,4)}}l.x<m+10&&(l.x=m+10,l.vx=Math.abs(l.vx)*Ae),l.x>v-m-10&&(l.x=v-m-10,l.vx=-Math.abs(l.vx)*Ae);for(const n of Y)n.glowIntensity>0&&(n.glowIntensity*=.9,n.glowIntensity<.01&&(n.glowIntensity=0));Ce(),U(t);const i=B-36;if(l.y>i){Ge();return}H=requestAnimationFrame(oe)},Ge=()=>{if(!l)return;const e=te.value,t=v/e.length,o=Math.floor(l.x/t),i=Math.max(0,Math.min(e.length-1,o));be.value=e[i],G.value=f.value*e[i]-f.value,R.value+=f.value*e[i],ie.value.unshift({multiplier:e[i],win:G.value,bet:f.value});const n=(i+.5)*t,r=e[i]>=2?"#22c55e":e[i]>=1?"#3b82f6":"#ef4444";we(n,B-30,r,12),K.value=!0,l=null,P.value=!1,L="idle";const d=()=>{const c=$.value;if(!c)return;const k=c.getContext("2d");k&&(C+=g,g+=-.015*C,g*=pe,w=v/2+Math.sin(C)*v*.12,Ce(),U(k),x.length>0?H=requestAnimationFrame(d):_e())};d(),setTimeout(()=>{K.value=!1,ee.value&&X.value>0&&(X.value--,X.value>0&&R.value>=f.value&&Se())},1500)},U=e=>{const t=v,o=B;e.fillStyle="#0a0e1a",e.fillRect(0,0,t,o);const i=e.createRadialGradient(t/2,o*.3,0,t/2,o*.3,t*.8);i.addColorStop(0,"rgba(59, 130, 246, 0.04)"),i.addColorStop(1,"rgba(0, 0, 0, 0)"),e.fillStyle=i,e.fillRect(0,0,t,o);const n=w-O/2,r=F+N,d=e.createLinearGradient(n,0,n+O,0);d.addColorStop(0,"#1e3a5f"),d.addColorStop(.2,"#2563eb"),d.addColorStop(.5,"#3b82f6"),d.addColorStop(.8,"#2563eb"),d.addColorStop(1,"#1e3a5f"),e.fillStyle=d,e.beginPath(),e.roundRect(n,F,O,N,[6,6,4,4]),e.fill();const c=O*.55,k=e.createLinearGradient(w-c/2,0,w+c/2,0);k.addColorStop(0,"rgba(0,0,0,0.5)"),k.addColorStop(.5,"rgba(0,0,0,0.25)"),k.addColorStop(1,"rgba(0,0,0,0.5)"),e.fillStyle=k,e.fillRect(w-c/2,F+3,c,N-3),e.fillStyle="#2563eb",e.beginPath(),e.roundRect(n-3,r-6,O+6,6,[0,0,4,4]),e.fill(),e.strokeStyle="rgba(147, 197, 253, 0.4)",e.lineWidth=1,e.beginPath(),e.moveTo(n+4,F+3),e.lineTo(n+4,r-8),e.stroke(),(L==="holding"||L==="releasing")&&(e.save(),e.shadowColor="rgba(236, 72, 153, 0.6)",e.shadowBlur=15,e.fillStyle="rgba(236, 72, 153, 0.15)",e.beginPath(),e.ellipse(w,r,O*.6,6,0,0,Math.PI*2),e.fill(),e.restore());const ce=V.value;for(const s of Y){const p=Math.round((s.y-j)/le),u=Math.min(1,p/(ce-1)),b=Math.round(59+-45*u),y=Math.round(130+81*u),S=Math.round(246+-8*u),_=`rgb(${b},${y},${S})`;s.glowIntensity>.01&&(e.save(),e.shadowColor=_,e.shadowBlur=12*s.glowIntensity,e.fillStyle=`rgba(${b},${y},${S},${.3*s.glowIntensity})`,e.beginPath(),e.arc(s.x,s.y,s.radius*3,0,Math.PI*2),e.fill(),e.restore()),e.save(),e.shadowColor=`rgba(${b},${y},${S},0.4)`,e.shadowBlur=4;const z=e.createRadialGradient(s.x-s.radius*.3,s.y-s.radius*.3,0,s.x,s.y,s.radius),J=s.glowIntensity>.1?1.5:1;z.addColorStop(0,`rgba(${Math.min(255,b*J+80)},${Math.min(255,y*J+80)},${Math.min(255,S*J+80)},1)`),z.addColorStop(1,_),e.fillStyle=z,e.beginPath(),e.arc(s.x,s.y,s.radius+s.glowIntensity*1.5,0,Math.PI*2),e.fill(),e.restore()}for(const s of x){const p=1-s.life/s.maxLife;e.fillStyle=s.color.replace("rgb","rgba").replace(")",`,${p*.8})`),e.beginPath(),e.arc(s.x,s.y,s.size*(1-s.life/s.maxLife*.5),0,Math.PI*2),e.fill()}if(l){for(let p=0;p<l.trail.length;p++){const u=l.trail[p],b=(1-p/l.trail.length)*.4,y=m*(.3+.7*(1-p/l.trail.length));e.fillStyle=`rgba(236, 72, 153, ${b})`,e.beginPath(),e.arc(u.x,u.y,y,0,Math.PI*2),e.fill()}e.save(),e.shadowColor="rgba(236, 72, 153, 0.7)",e.shadowBlur=18;const s=e.createRadialGradient(l.x-m*.3,l.y-m*.3,0,l.x,l.y,m);s.addColorStop(0,"#f9a8d4"),s.addColorStop(.4,"#ec4899"),s.addColorStop(1,"#be185d"),e.fillStyle=s,e.beginPath(),e.arc(l.x,l.y,m,0,Math.PI*2),e.fill(),e.restore(),e.fillStyle="rgba(255, 255, 255, 0.55)",e.beginPath(),e.arc(l.x-m*.25,l.y-m*.3,m*.35,0,Math.PI*2),e.fill()}const E=te.value,W=t/E.length,h=o-36,D=34;E.forEach((s,p)=>{const u=p*W+1,b=W-2;let y,S;s>=10?(y="rgba(34, 197, 94, 0.35)",S="#4ade80"):s>=2?(y="rgba(34, 211, 238, 0.25)",S="#22d3ee"):s>=1?(y="rgba(99, 102, 241, 0.2)",S="#a5b4fc"):(y="rgba(239, 68, 68, 0.25)",S="#f87171"),e.fillStyle=y,e.beginPath();const _=4;e.moveTo(u+_,h),e.lineTo(u+b-_,h),e.arcTo(u+b,h,u+b,h+_,_),e.lineTo(u+b,h+D),e.lineTo(u,h+D),e.lineTo(u,h+_),e.arcTo(u,h,u+_,h,_),e.fill(),e.fillStyle=S,e.font=`bold ${E.length>13?8:10}px -apple-system, sans-serif`,e.textAlign="center",e.textBaseline="middle",e.fillText(`${s}x`,u+b/2,h+D/2)}),e.strokeStyle="rgba(255,255,255,0.06)",e.lineWidth=1;for(let s=1;s<E.length;s++){const p=s*W;e.beginPath(),e.moveTo(p,h),e.lineTo(p,h+D),e.stroke()}},ve=()=>{const e=$.value,t=ye.value;if(!e||!t)return;const o=t.clientWidth,i=window.devicePixelRatio||1;v=Math.min(o,500),B=Math.round(v*1.3),e.width=v*i,e.height=B*i,e.style.width=v+"px",e.style.height=B+"px";const n=e.getContext("2d");n&&n.scale(i,i),w=v/2,ue()},xe=()=>{if(ue(),$.value){const e=$.value.getContext("2d");e&&U(e)}};He(Q,()=>{if($.value&&!l){const e=$.value.getContext("2d");e&&U(e)}});const _e=()=>{C=(Math.random()-.5)*It,g=(Math.random()-.5)*.008,w=v/2;const e=()=>{const t=$.value;if(!t)return;const o=t.getContext("2d");o&&(C+=g,g+=-.015*C,g*=pe,Math.abs(C)<.01&&Math.abs(g)<.001&&(g+=(Math.random()-.5)*.004),w=v/2+Math.sin(C)*v*.12,U(o),q=requestAnimationFrame(e))};e()};return qe(async()=>{await ze(),ve(),_e(),window.addEventListener("resize",ve)}),Oe(()=>{H&&cancelAnimationFrame(H),q&&cancelAnimationFrame(q),window.removeEventListener("resize",ve)}),(e,t)=>(A(),T("div",Qe,[t[18]||(t[18]=a("div",{class:"game-plate"},[a("div",{class:"plate-title"},"Gift Plinko")],-1)),a("div",et,[(A(),T(he,null,fe(20,o=>a("div",{key:o,class:"star",style:je(Ee())},null,4)),64))]),a("header",tt,[a("button",{class:"header-back",onClick:t[0]||(t[0]=o=>e.$router.push("/solo"))},[...t[6]||(t[6]=[a("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("path",{d:"M15 18l-6-6 6-6"})],-1)])]),t[9]||(t[9]=a("div",{class:"header-title"},[a("span",{class:"title-main"},"Plinko"),a("span",{class:"title-badge"},"x1000")],-1)),a("div",lt,[t[7]||(t[7]=a("svg",{class:"balance-icon-svg",width:"16",height:"16",viewBox:"0 0 56 56",fill:"none"},[a("circle",{cx:"28",cy:"28",r:"28",fill:"#0098EA"}),a("path",{d:"M37.5603 15.6277H18.4386C14.9228 15.6277 12.6944 19.4202 14.4632 22.4861L26.2644 42.9409C27.0345 44.2765 28.9644 44.2765 29.7345 42.9409L41.5765 22.4861C43.3045 19.4202 41.0761 15.6277 37.5603 15.6277Z",fill:"white"})],-1)),a("span",at,I(R.value.toFixed(2)),1),t[8]||(t[8]=a("button",{class:"balance-add"},"+",-1))])]),a("div",ot,[a("div",st,[t[10]||(t[10]=a("span",{class:"info-label"},"ИГРА",-1)),a("span",nt,"#"+I(me.value),1)]),a("div",it,[t[12]||(t[12]=a("span",{class:"info-label"},"РИСК",-1)),se(a("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>Q.value=o),class:"risk-select"},[...t[11]||(t[11]=[a("option",{value:"low"},"Низкий",-1),a("option",{value:"medium"},"Средний",-1),a("option",{value:"high"},"Высокий",-1)])],512),[[ke,Q.value]])]),a("div",rt,[t[14]||(t[14]=a("span",{class:"info-label"},"РЯДЫ",-1)),se(a("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>V.value=o),class:"rows-select",onChange:xe},[...t[13]||(t[13]=[a("option",{value:8},"8",-1),a("option",{value:12},"12",-1),a("option",{value:16},"16",-1)])],544),[[ke,V.value]])])]),a("div",{class:"game-container",ref_key:"gameContainer",ref:ye},[a("canvas",{ref_key:"gameCanvas",ref:$,class:"game-canvas"},null,512),K.value?(A(),T("div",{key:0,class:ne(["result-overlay",{win:G.value>0,lose:G.value<=0}])},[a("div",dt,I(be.value)+"x",1),a("div",{class:ne(["result-amount",{positive:G.value>0}])},I(G.value>0?"+":"")+I(G.value.toFixed(2))+" TON ",3)],2)):Pe("",!0)],512),a("div",ut,[a("div",vt,[(A(),T(he,null,fe(Be,o=>a("button",{key:o,class:ne(["bet-btn",{active:f.value===o}]),onClick:i=>f.value=o,disabled:P.value},[Je(I(o)+" ",1),t[15]||(t[15]=a("svg",{class:"bet-ton-icon",width:"14",height:"14",viewBox:"0 0 56 56",fill:"none"},[a("circle",{cx:"28",cy:"28",r:"28",fill:"#0098EA"}),a("path",{d:"M37.5603 15.6277H18.4386C14.9228 15.6277 12.6944 19.4202 14.4632 22.4861L26.2644 42.9409C27.0345 44.2765 28.9644 44.2765 29.7345 42.9409L41.5765 22.4861C43.3045 19.4202 41.0761 15.6277 37.5603 15.6277Z",fill:"white"})],-1))],10,ct)),64))]),a("div",ht,[a("button",{class:"btn-half",onClick:Fe,disabled:P.value},"½",8,ft),a("button",{class:"btn-play",onClick:Se,disabled:P.value||R.value<f.value},[P.value?(A(),T("span",pt)):(A(),T("span",mt,I(P.value?"Игра...":`Играть ${f.value} TON`),1))],8,gt),a("button",{class:"btn-double",onClick:Re,disabled:P.value},"2x",8,bt)]),a("div",yt,[a("label",Mt,[se(a("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=o=>ee.value=o),disabled:P.value},null,8,wt),[[Xe,ee.value]]),t[16]||(t[16]=a("span",null,"Авто-игра",-1))]),ee.value?se((A(),T("input",{key:0,type:"number","onUpdate:modelValue":t[4]||(t[4]=o=>X.value=o),class:"auto-count",min:"1",max:"100",placeholder:"Кол-во"},null,512)),[[Ye,X.value,void 0,{number:!0}]]):Pe("",!0)])]),a("div",Ct,[a("div",St,[t[17]||(t[17]=a("span",null,"История",-1)),a("span",{class:"history-clear",onClick:t[5]||(t[5]=o=>ie.value=[])},"Очистить")]),a("div",_t,[(A(!0),T(he,null,fe(ie.value.slice(0,10),(o,i)=>(A(),T("div",{key:i,class:ne(["history-item",{win:o.win>0}])},[a("span",kt,I(o.multiplier)+"x",1),a("span",Pt,I(o.win>0?"+":"")+I(o.win.toFixed(2)),1)],2))),128))])])]))}}),Lt=Ke($t,[["__scopeId","data-v-4adf35ab"]]);export{Lt as default};
