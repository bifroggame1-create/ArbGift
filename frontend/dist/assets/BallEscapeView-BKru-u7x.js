import{e as $}from"./client-C6ea1EVy.js";import{d as W,o as z,E as L,b as R,e as t,z as A,t as v,F as U,j as V,L as Y,r as y,a as j,D as q}from"./vue-B64cNy51.js";import"./index-D5GkNzM3.js";const Z={class:"ball-escape-view min-h-screen flex flex-col",style:{background:"#000","padding-bottom":"16px"}},J={class:"px-3 pt-3 flex flex-col gap-2"},K={class:"flex items-center justify-between"},O={class:"flex items-center gap-1.5"},Q={class:"flex items-center gap-1.5 rounded-full px-3 py-1.5",style:{background:"rgba(255,255,255,0.08)"}},X={class:"text-white font-bold text-sm"},ee={class:"mx-3 mt-2 flex-1 flex items-center justify-center",style:{"min-height":"300px"}},te={class:"relative",style:{width:"300px",height:"300px"}},le={class:"px-3 py-3"},se={class:"flex gap-2 mb-3"},ae=["onClick"],ne={class:"text-white/75 text-sm"},ie={class:"flex items-center gap-2"},oe=["disabled"],re={class:"text-center mt-2"},ce={class:"text-white/20 text-xs"},d=300,w=105,_=14,I=22,pe=W({__name:"BallEscapeView",setup(de){const T=Y("gameCanvas"),g=y(3.16),D=[1,3,10,30,50],i=y(1),l=y("idle"),M=y("502d...1c83"),a=d/2,o=a-18;let m=null,p=0,b=1,r=-Math.PI/2,P=-Math.PI/2,k=null,C=Date.now();function F(f){l.value==="idle"&&(i.value=f)}function B(){return Math.random().toString(36).substring(2,6)+"..."+Math.random().toString(36).substring(2,6)}function E(){l.value==="playing"&&(P=r+(Math.random()-.3)*Math.PI*.8)}async function H(){if(l.value==="playing"||g.value<i.value)return;g.value-=i.value,l.value="playing",p=0,b=1,r=-Math.PI/2+(Math.random()-.5)*.5,P=r;let f=Math.random()<.35,e=3e3+Math.random()*2e3,s=3.75;try{C++;const n=await $({amount:i.value,client_seed:B(),nonce:C,user_id:"anonymous"});f=n.escaped,e=n.duration_ms,s=n.multiplier,M.value=n.server_seed_hash}catch{M.value=B()}const h=Date.now();function c(){const n=Date.now()-h;if(p=Math.min(n/e,1),b=1+p*(s-1),r+=(P-r)*.08,r+=(Math.random()-.5)*.05,p>=1){b=s,f?(r=Math.PI+.4+Math.random()*.3,l.value="won",g.value+=i.value*s):(r=-.1-Math.random()*.3,l.value="lost"),S(),k=setTimeout(()=>{l.value="idle",p=0},2e3);return}S(),m=requestAnimationFrame(c)}m=requestAnimationFrame(c)}function S(){const f=T.value;if(!f)return;const e=f.getContext("2d");if(!e)return;e.clearRect(0,0,d,d),e.fillStyle="#0a0c14",e.fillRect(0,0,d,d);const s=d-50,h=44,c=Math.floor(d*.62);e.fillStyle="rgba(34, 197, 94, 0.2)",e.beginPath(),e.roundRect(4,s,c-6,h,[8,0,0,8]),e.fill(),e.fillStyle="rgba(239, 68, 68, 0.2)",e.beginPath(),e.roundRect(c+2,s,d-c-6,h,[0,8,8,0]),e.fill(),e.font="15px sans-serif",e.textAlign="center",e.textBaseline="middle";const n=s+h/2;e.fillText("ðŸš€",28,n),e.fillText("ðŸ‘‘",c/2,n),e.fillText("ðŸŽ",c-22,n),e.fillText("ðŸ’€",c+(d-c)/2,n),e.beginPath(),e.arc(a,o,w,0,2*Math.PI),e.strokeStyle="rgba(255,255,255,0.07)",e.lineWidth=_,e.stroke();const N=-Math.PI/2+p*2*Math.PI;(l.value==="playing"||l.value==="won"||l.value==="lost")&&(e.shadowColor="rgba(217, 70, 239, 0.55)",e.shadowBlur=18,e.beginPath(),e.arc(a,o,w,-Math.PI/2,N),e.strokeStyle="#d946ef",e.lineWidth=_,e.lineCap="round",e.stroke(),e.shadowBlur=0);const u=a+Math.cos(r)*(w-_*.3),x=o+Math.sin(r)*(w-_*.3);if(e.shadowColor=l.value==="won"?"rgba(34,197,94,0.5)":"rgba(217,70,239,0.4)",e.shadowBlur=14,e.fillStyle="#4ade80",e.beginPath(),e.arc(u,x,I*.65,0,Math.PI*2),e.fill(),e.fillStyle="#60a5fa",e.beginPath(),e.arc(u,x-3,I*.55,Math.PI,0),e.fill(),e.fillStyle="#1e3a5f",e.beginPath(),e.arc(u,x-1,I*.38,Math.PI+.25,-.25),e.fill(),e.fillStyle="#fff",e.beginPath(),e.arc(u-4,x+2,2.5,0,Math.PI*2),e.arc(u+4,x+2,2.5,0,Math.PI*2),e.fill(),e.fillStyle="#000",e.beginPath(),e.arc(u-4,x+2.5,1.2,0,Math.PI*2),e.arc(u+4,x+2.5,1.2,0,Math.PI*2),e.fill(),e.shadowBlur=0,e.textAlign="center",e.textBaseline="middle",l.value==="idle")e.fillStyle="rgba(255,255,255,0.55)",e.font="bold 15px -apple-system, sans-serif",e.fillText("This is Preview",a,o-2),e.fillStyle="rgba(255,255,255,0.28)",e.font="11px -apple-system, sans-serif",e.fillText("Tap button below to play",a,o+18);else{const G=l.value==="won"?"#4ade80":l.value==="lost"?"#ef4444":"#4ade80";e.fillStyle=G,e.font="bold 30px -apple-system, sans-serif",e.fillText(`${b.toFixed(2)}x`,a,o-6),l.value==="won"?(e.fillStyle="#4ade80",e.font="bold 14px -apple-system, sans-serif",e.fillText("Escaped!",a,o+22),e.fillStyle="rgba(255,255,255,0.5)",e.font="11px -apple-system, sans-serif",e.fillText(`+${(i.value*b).toFixed(2)} â–¼`,a,o+40)):l.value==="lost"&&(e.fillStyle="#ef4444",e.font="bold 14px -apple-system, sans-serif",e.fillText("Caught!",a,o+22),e.fillStyle="rgba(255,255,255,0.4)",e.font="11px -apple-system, sans-serif",e.fillText(`-${i.value.toFixed(2)} â–¼`,a,o+40))}}return z(()=>{S()}),L(()=>{m&&cancelAnimationFrame(m),k&&clearTimeout(k)}),(f,e)=>(j(),R("div",Z,[t("div",J,[e[3]||(e[3]=t("div",{class:"rounded-xl px-4 py-2.5 flex items-center justify-between",style:{background:"linear-gradient(135deg, #ca8a04 0%, #22c55e 60%, #4ade80 100%)"}},[t("span",{class:"text-white font-bold text-sm"},"Giftomania"),t("span",{class:"text-white/70 text-xs font-mono"},"3:04:57:06")],-1)),t("div",K,[e[2]||(e[2]=A('<div class="flex gap-2"><button class="w-9 h-9 rounded-xl flex items-center justify-center" style="background:rgba(255,255,255,0.06);"><svg class="w-4 h-4" fill="none" stroke="rgba(255,255,255,0.45)" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke-width="1.5"></rect><path d="M16 2v4M8 2v4M3 10h18" stroke-width="1.5" stroke-linecap="round"></path></svg></button><div class="flex items-center gap-1 rounded-full px-3 py-1" style="background:rgba(255,255,255,0.08);"><span class="text-white/50 text-xs">Max Prize</span><span class="text-white/40 text-xs">â–¼</span><span class="text-white font-bold text-sm">30</span></div></div>',1)),t("div",O,[t("button",Q,[e[0]||(e[0]=t("span",{class:"text-white/45 text-xs"},"â–¼",-1)),t("span",X,v(g.value.toFixed(2)),1)]),e[1]||(e[1]=t("button",{class:"w-7 h-7 rounded-full flex items-center justify-center text-white/50 text-sm",style:{background:"rgba(255,255,255,0.12)"}},"+",-1))])])]),t("div",ee,[t("div",te,[t("canvas",{ref_key:"gameCanvas",ref:T,class:"absolute inset-0 w-full h-full cursor-pointer",width:300,height:300,onClick:E},null,512)])]),t("div",le,[t("div",se,[(j(),R(U,null,V(D,s=>t("button",{key:s,onClick:h=>F(s),class:"flex-1 py-2 rounded-lg font-bold flex items-center justify-center gap-1 transition-all",style:q(i.value===s?{background:"rgba(34,211,238,0.2)",border:"1px solid rgba(34,211,238,0.4)"}:{background:"rgba(255,255,255,0.06)",border:"1px solid transparent"})},[t("span",ne,v(s),1),e[4]||(e[4]=t("span",{class:"text-white/30 text-xs"},"â–¼",-1))],12,ae)),64))]),t("div",ie,[e[5]||(e[5]=A('<button class="flex flex-col items-center gap-0.5"><div class="w-10 h-10 rounded-xl flex items-center justify-center" style="background:rgba(255,255,255,0.06);"><div class="w-5 h-5 rounded-full flex items-center justify-center" style="background:#3b82f6;"><span class="text-white text-xs font-bold">â–¼</span></div></div><span class="text-white/35 text-xs">Swap â˜†</span></button>',1)),t("button",{onClick:H,disabled:l.value==="playing"||g.value<i.value,class:"flex-1 py-3 rounded-xl font-bold text-sm text-white transition-all disabled:opacity-40 disabled:cursor-not-allowed",style:{background:"linear-gradient(135deg, #22d3ee, #06b6d4)"}},v(l.value==="playing"?"Tap to escape!":`Play â–¼ ${i.value}`),9,oe),e[6]||(e[6]=t("button",{class:"flex flex-col items-center gap-0.5"},[t("div",{class:"w-10 h-10 rounded-full flex items-center justify-center text-white/50 text-lg",style:{background:"rgba(255,255,255,0.10)"}},"+"),t("span",{class:"text-white/35 text-xs"},"Deposit")],-1))]),t("div",re,[t("span",ce,"â± Hash: "+v(M.value),1)])])]))}});export{pe as default};
