import{l as Ht}from"./client-tq5cHUIs.js";import{d as Nt,j as Yt,y as Xt,c as O,b as i,t as $,n as gt,k as qt,z as _t,F as Vt,f as $t,r as H,l as Ut,o as N}from"./vue-Cp6PShP7.js";import{a as Wt}from"./index-BqAzz0A8.js";const zt={class:"ball-escape-view"},Zt={class:"game-header-bar"},jt={class:"header-balance"},Kt={class:"balance-val"},Jt={class:"arena-container"},Qt={key:0,class:"result-text won"},te={key:1,class:"result-text lost"},ee={class:"hash-row"},ae={class:"hash-value"},le={class:"bet-row"},oe=["onClick","disabled"],ne={class:"action-row"},se=["disabled"],ie={key:0},re={key:1},ce={key:2},p=340,yt=460,h=120,m=12,ft=.45,de=.3,he=.85,ue=.8,At=.998,ge=.02,fe=.04,pt=12,it=16,Y=170,Q=150,_=360,T=80,tt=.016,pe=5,me=.55,It=.6,be=.35,xt=.992,ve=Nt({__name:"BallEscapeView",setup(Me){const mt=H(null),U=H(10),Et=[.5,1,3,5,10],P=H(1),r=H("idle"),D=H(1),Rt=H(Math.floor(Math.random()*9e5)+1e5),rt=H("---");let F=null,X=0,k=0,et=0,n=0,s=0,e=0,a=0,b=[],L=0,ct=0,at=null,lt=0,bt=.02;const vt=[{main:"#fbbf24",glow:"rgba(251, 191, 36, ",light:"#fde68a"},{main:"#22d3ee",glow:"rgba(34, 211, 238, ",light:"#67e8f9"},{main:"#a855f7",glow:"rgba(168, 85, 247, ",light:"#c084fc"},{main:"#4ade80",glow:"rgba(74, 222, 128, ",light:"#86efac"},{main:"#f97316",glow:"rgba(249, 115, 22, ",light:"#fdba74"}],Mt={main:"#ec4899",glow:"rgba(236, 72, 153, ",light:"#f9a8d4"};let dt=Mt,St=0,ot=5e3,ht=!1,W=1,A=!1,q=null,nt=0;const Pt=Ut(()=>r.value==="won"?"#4ade80":r.value==="lost"?"#ef4444":D.value>=2?"#4ade80":"#22d3ee");function Ft(c){r.value==="idle"&&(P.value=c)}async function Lt(){if(r.value==="playing"||U.value<P.value)return;wt(),dt=vt[Math.floor(Math.random()*vt.length)],U.value-=P.value,r.value="playing",D.value=1,Rt.value=Math.floor(Math.random()*9e5)+1e5;const c=-Math.PI/2+(Math.random()-.5)*1.2,t=30+Math.random()*40;n=Math.cos(c)*t,s=Math.sin(c)*t;const l=Math.random()*Math.PI*2,d=4+Math.random()*3;e=Math.cos(l)*d,a=Math.sin(l)*d+2,X=0,k=tt,et=Math.random()*Math.PI*2,b=[],L=0,A=!1,q=null,nt=0;try{const S=await Ht({amount:P.value,client_seed:Math.random().toString(36).substring(2,10),nonce:Date.now(),user_id:"user"});ht=S.escaped,ot=S.duration_ms,W=S.multiplier,rt.value=S.server_seed_hash.slice(0,6)+"..."+S.server_seed_hash.slice(-4)}catch{ht=Math.random()<.4,ot=4e3+Math.random()*3e3,W=1.5+Math.random()*3.5,rt.value=Math.random().toString(36).slice(2,8)+"..."}St=Date.now(),F=requestAnimationFrame(st)}function st(){const c=Date.now()-St,t=Math.min(c/ot,1);D.value=1+(W-1)*t,k=tt,X+=tt;const l=et+X;if(A){if(a+=be,e*=xt,a*=xt,nt===0){const g=Y+n,u=((ht?p*.25:p*.75)-g)*.004;e+=u}n+=e,s+=a;const f=Y+n;if(Q+s>=_-m&&(s=_-m-Q,a=-Math.abs(a)*me,e*=.85,nt++,q=f<p/2?"green":"red",nt>=pe||Math.abs(a)<1.2)){a=0,e=0,Tt(q==="green");return}if(f<=m&&(n=m-Y,e=Math.abs(e)*It),f>=p-m&&(n=p-m-Y,e=-Math.abs(e)*It),Math.sqrt(n*n+s*s)<h+m+5&&s<0){const g=Math.atan2(s,n),o=h+m+6;n=Math.cos(g)*o,s=Math.sin(g)*o;const u=Math.cos(g),C=Math.sin(g),M=e*u+a*C;M<0&&(e-=2*M*u*.5,a-=2*M*C*.5)}b.unshift({x:Y+n,y:Q+s}),b.length>it&&b.pop(),z(),F=requestAnimationFrame(st);return}const d=Math.sqrt(n*n+s*s);if(d>1){const f=k*k,v=ge*f*d;e+=n/d*v,a+=s/d*v}const S=fe*k;e+=-a*S,a+=e*S,a+=de,e*=At,a*=At;const I=Math.sqrt(e*e+a*a);I>pt&&(e=e/I*pt,a=a/I*pt),n+=e,s+=a,b.unshift({x:n,y:s}),b.length>it&&b.pop(),L*=.88;const y=h-m;if(Math.sqrt(n*n+s*s)>=y){const f=Math.atan2(s,n);if(Math.abs(Dt(f-l))<ft/2){A=!0,b=[];const C=Math.max(Math.sqrt(e*e+a*a),5),M=l;e=Math.cos(M)*C,a=Math.sin(M)*C,n=Math.cos(M)*(h+m+2),s=Math.sin(M)*(h+m+2),z(),F=requestAnimationFrame(st);return}n=Math.cos(f)*y,s=Math.sin(f)*y;const g=Math.cos(f),o=Math.sin(f),u=e*g+a*o;if(u>0){const C=e-u*g,M=a-u*o,x=-u*he;e=C+x*g,a=M+x*o;const B=ue+Math.abs(u)*.2;e-=g*B,a-=o*B;const E=-o,R=g,j=k*h*.4;e+=E*j,a+=R*j;const V=(Math.random()-.5)*1.5;e+=E*V,a+=R*V,L=1,ct=f}}if(t>=1&&!A){const f=c-ot;if(f>2e3){A=!0,b=[];const v=l;n=Math.cos(v)*(h+m+2),s=Math.sin(v)*(h+m+2),e=Math.cos(v)*5,a=Math.sin(v)*5}else{const v=l,Z=Math.cos(v)*y,g=Math.sin(v)*y,o=Z-n,u=g-s,C=Math.sqrt(o*o+u*u);if(C>1){const M=1+f*.002;e+=o/C*M,a+=u/C*M}}}z(),F=requestAnimationFrame(st)}function Tt(c){F&&cancelAnimationFrame(F),D.value=W,c?(r.value="won",U.value+=P.value*W):r.value="lost",z(),setTimeout(()=>{r.value="idle",D.value=1,q=null,Ct()},2500)}function Dt(c){for(;c>Math.PI;)c-=Math.PI*2;for(;c<-Math.PI;)c+=Math.PI*2;return c}function z(){const c=mt.value;if(!c)return;const t=c.getContext("2d");if(!t)return;const l=Y,d=Q;t.fillStyle="#0a0c14",t.fillRect(0,0,p,yt);const S=_+T/2,I=t.createLinearGradient(0,_-60,0,_+T);I.addColorStop(0,"rgba(34, 197, 94, 0)"),I.addColorStop(.3,"rgba(34, 197, 94, 0.08)"),I.addColorStop(.6,"rgba(34, 197, 94, 0.25)"),I.addColorStop(1,"rgba(34, 197, 94, 0.5)"),t.fillStyle=I,t.fillRect(0,_-60,p/2,T+60);const y=t.createLinearGradient(0,_-60,0,_+T);y.addColorStop(0,"rgba(239, 68, 68, 0)"),y.addColorStop(.3,"rgba(239, 68, 68, 0.08)"),y.addColorStop(.6,"rgba(239, 68, 68, 0.25)"),y.addColorStop(1,"rgba(239, 68, 68, 0.5)"),t.fillStyle=y,t.fillRect(p/2,_-60,p/2,T+60),t.fillStyle="rgba(34, 197, 94, 0.6)",t.fillRect(0,_+10,p/2,T-10),t.fillStyle="rgba(239, 68, 68, 0.6)",t.fillRect(p/2,_+10,p/2,T-10),t.save(),t.shadowColor="rgba(255, 255, 255, 0.5)",t.shadowBlur=8,t.strokeStyle="rgba(255, 255, 255, 0.6)",t.lineWidth=2,t.beginPath(),t.moveTo(p/2,_-30),t.lineTo(p/2,_+T),t.stroke(),t.restore(),t.font="28px -apple-system, sans-serif",t.textAlign="center",t.textBaseline="middle";const ut=p/4,f=q==="green";t.globalAlpha=f?1:.7,t.fillText("ðŸ‘‘",ut-18,S+8),t.fillText("ðŸ’Ž",ut+18,S+8),t.globalAlpha=1;const v=p*3/4,Z=q==="red";t.globalAlpha=Z?1:.7,t.fillText("ðŸ’€",v-18,S+8),t.fillText("â˜ ï¸",v+18,S+8),t.globalAlpha=1;const g=et+X,o=dt,u=t.createRadialGradient(l,d,h-20,l,d,h+15);u.addColorStop(0,o.glow+"0.0)"),u.addColorStop(.6,o.glow+"0.12)"),u.addColorStop(1,o.glow+"0.0)"),t.fillStyle=u,t.beginPath(),t.arc(l,d,h+15,0,Math.PI*2),t.fill();const C=g-ft/2,M=g+ft/2;t.save(),t.lineWidth=10,t.lineCap="round";const x=t.createLinearGradient(l-h,d-h,l+h,d+h);if(x.addColorStop(0,o.main),x.addColorStop(.3,o.light),x.addColorStop(.5,o.main),x.addColorStop(.8,o.main),x.addColorStop(1,o.light),t.strokeStyle=x,t.shadowColor=o.glow+"0.5)",t.shadowBlur=12,t.beginPath(),t.arc(l,d,h,M,C+Math.PI*2),t.stroke(),t.restore(),L>.05&&r.value==="playing"&&!A){const K=l+Math.cos(ct)*h,J=d+Math.sin(ct)*h,w=t.createRadialGradient(K,J,0,K,J,30*L);w.addColorStop(0,o.glow+`${L*.8})`),w.addColorStop(.5,o.glow+`${L*.4})`),w.addColorStop(1,o.glow+"0)"),t.fillStyle=w,t.beginPath(),t.arc(K,J,30*L,0,Math.PI*2),t.fill()}const B=t.createRadialGradient(l-30,d-30,0,l,d,h);if(B.addColorStop(0,o.glow+"0.05)"),B.addColorStop(.5,o.glow+"0.02)"),B.addColorStop(1,"rgba(0, 0, 0, 0)"),t.fillStyle=B,t.beginPath(),t.arc(l,d,h-10,0,Math.PI*2),t.fill(),b.length>1&&r.value==="playing"){const K=Math.sqrt(e*e+a*a),J=Math.min(K/8,1);for(let w=1;w<b.length;w++){const kt=(1-w/it)*(.3+J*.5),Bt=m*(1-w/it*.7);t.fillStyle=`rgba(34, 211, 238, ${kt})`,t.beginPath();const Gt=A?b[w].x:l+b[w].x,Ot=A?b[w].y:d+b[w].y;t.arc(Gt,Ot,Bt,0,Math.PI*2),t.fill()}}let E,R;A?(E=Y+n,R=Q+s):(E=l+n,R=d+s);const j=Math.sqrt(e*e+a*a),V=Math.min(.4+j/10,1);t.shadowColor=r.value==="won"?`rgba(74, 222, 128, ${V})`:r.value==="lost"?`rgba(239, 68, 68, ${V})`:`rgba(34, 211, 238, ${V})`,t.shadowBlur=10+j*2;const G=t.createRadialGradient(E-3,R-3,0,E,R,m);r.value==="won"?(G.addColorStop(0,"#86efac"),G.addColorStop(1,"#22c55e")):r.value==="lost"?(G.addColorStop(0,"#fca5a5"),G.addColorStop(1,"#ef4444")):(G.addColorStop(0,"#67e8f9"),G.addColorStop(1,"#06b6d4")),t.fillStyle=G,t.beginPath(),t.arc(E,R,m,0,Math.PI*2),t.fill(),t.shadowBlur=0,t.fillStyle="rgba(255, 255, 255, 0.4)",t.beginPath(),t.arc(E-3,R-3,m*.3,0,Math.PI*2),t.fill(),r.value==="idle"&&(t.textAlign="center",t.textBaseline="middle",t.fillStyle="rgba(255, 255, 255, 0.8)",t.font="bold 18px -apple-system, sans-serif",t.fillText("This is Preview",l,d+h+30),t.fillStyle="rgba(255, 255, 255, 0.4)",t.font="13px -apple-system, sans-serif",t.fillText("Tap button below to play",l,d+h+52))}function Ct(){dt=Mt,lt=Math.random()*Math.PI*2,bt=.015,X=0,k=tt,et=Math.PI*.7;const c=()=>{lt+=bt;const t=h*.4;n=Math.cos(lt)*t,s=Math.sin(lt)*t*.6+15,e=0,a=0,X+=tt,z(),at=requestAnimationFrame(c)};c()}function wt(){at&&(cancelAnimationFrame(at),at=null)}return Yt(()=>{Ct()}),Xt(()=>{F&&cancelAnimationFrame(F),wt()}),(c,t)=>(N(),O("div",zt,[i("header",Zt,[i("button",{class:"header-back",onClick:t[0]||(t[0]=l=>c.$router.push("/solo"))},[...t[1]||(t[1]=[i("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[i("path",{d:"M15 18l-6-6 6-6"})],-1)])]),t[4]||(t[4]=i("div",{class:"header-title"},[i("span",{class:"title-main"},"Ball Escape"),i("span",{class:"title-badge",style:{background:"#8b5cf6"}},"x50")],-1)),i("div",jt,[t[2]||(t[2]=i("svg",{width:"16",height:"16",viewBox:"0 0 56 56",fill:"none"},[i("circle",{cx:"28",cy:"28",r:"28",fill:"#0098EA"}),i("path",{d:"M37.5603 15.6277H18.4386C14.9228 15.6277 12.6944 19.4202 14.4632 22.4861L26.2644 42.9409C27.0345 44.2765 28.9644 44.2765 29.7345 42.9409L41.5765 22.4861C43.3045 19.4202 41.0761 15.6277 37.5603 15.6277Z",fill:"white"})],-1)),i("span",Kt,$(U.value.toFixed(2)),1),t[3]||(t[3]=i("button",{class:"balance-plus"},"+",-1))])]),i("div",Jt,[i("canvas",{ref_key:"gameCanvas",ref:mt,class:"game-canvas",width:p,height:yt},null,512),i("div",{class:gt(["multiplier-overlay",r.value])},[i("div",{class:"multiplier-value",style:qt({color:Pt.value})},$(D.value.toFixed(2))+"x ",5),r.value==="won"?(N(),O("div",Qt,"ESCAPED!")):_t("",!0),r.value==="lost"?(N(),O("div",te,"DEAD")):_t("",!0)],2)]),i("div",ee,[t[5]||(t[5]=i("span",{class:"hash-label"},"Hash:",-1)),i("span",ae,$(rt.value),1)]),i("div",le,[(N(),O(Vt,null,$t(Et,l=>i("button",{key:l,class:gt(["bet-btn",{active:P.value===l}]),onClick:d=>Ft(l),disabled:r.value==="playing"},$(l)+" â—‡ ",11,oe)),64))]),i("div",ne,[i("button",{class:gt(["play-btn",{playing:r.value==="playing"}]),disabled:r.value==="playing"||U.value<P.value,onClick:Lt},[r.value==="idle"?(N(),O("span",ie,"Play "+$(P.value)+" â—‡",1)):r.value==="playing"?(N(),O("span",re,$(D.value.toFixed(2))+"x",1)):(N(),O("span",ce,"Play Again"))],10,se)])]))}}),_e=Wt(ve,[["__scopeId","data-v-104e0edb"]]);export{_e as default};
