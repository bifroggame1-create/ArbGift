import{d as Pe,H as Ie,o as Te,I as Re,G as Be,b as k,e as a,F as Q,v as Z,t as _,x as q,J as ue,n as Y,k as ve,K as Fe,y as Le,r as m,c as Ae,a as S,E as We}from"./vue-CF-r4DcL.js";import{_ as Ee}from"./index-BNLjFMtA.js";const Ge={class:"plinko-view"},Ne={class:"stars-bg"},Ve={class:"plinko-header"},ze={class:"header-balance"},De={class:"balance-value"},Ue={class:"game-info-bar"},Oe={class:"info-item"},Xe={class:"info-value"},qe={class:"info-item"},Ye={class:"info-item"},He={class:"result-multiplier"},Je={class:"bet-section"},Ke={class:"bet-amounts"},je=["onClick","disabled"],Qe={class:"action-row"},Ze=["disabled"],et=["disabled"],tt={key:0,class:"loading-spinner"},st={key:1},at=["disabled"],ot={class:"auto-play"},lt={class:"auto-label"},nt=["disabled"],it={class:"history-section"},rt={class:"history-header"},dt={class:"history-list"},ut={class:"history-mult"},vt={class:"history-amount"},y=7,ct=.25,ce=.99,he=.65,fe=.4,ee=12,ht=Pe({__name:"PlinkoView",setup(ft){const P=m(5.16),te=m(48291),C=m(!1),N=m(!1),se=m(0),I=m(0),V=m("medium"),B=m(12),ge=[.5,1,2,5,10],f=m(1),z=m(!1),L=m(10),H=m([]),$=m(null),ae=m(null);let b=380,x=500;const pe={low:{8:[5.6,2.1,1.1,1,.5,1,1.1,2.1,5.6],12:[8.9,3,1.4,1.1,1,.5,.3,.5,1,1.1,1.4,3,8.9],16:[16,9,2,1.4,1.1,1,.5,.3,.3,.5,1,1.1,1.4,2,9,16]},medium:{8:[13,3,1.3,.7,.4,.7,1.3,3,13],12:[33,11,4,2,1.1,.6,.3,.6,1.1,2,4,11,33],16:[110,41,10,5,3,1.5,1,.5,.3,.5,1,1.5,3,5,10,41,110]},high:{8:[29,4,1.5,.3,.2,.3,1.5,4,29],12:[170,24,8.1,2,.7,.2,.2,.7,2,8.1,24,170],16:[1e3,130,26,9,4,2,.2,.2,.2,.2,2,4,9,26,130,1e3]}},D=Ae(()=>{const e=pe[V.value];return e[B.value]||e[12]});let s=null,A=[],T=[],U=null,J=0,F=28,O=0,X=4,W=50,oe=0;const K=()=>{A=[];const e=B.value;e<=8?(F=36,X=5):e<=12?(F=28,X=4):(F=22,X=3.5),W=45,oe=x-36-10,O=(oe-W)/(e-1);const l=b/2;for(let n=0;n<e;n++){const i=n+3,r=(i-1)*F,c=l-r/2;for(let d=0;d<i;d++)A.push({x:c+d*F,y:W+n*O,radius:X,glowIntensity:0})}},le=(e,t,l,n)=>{for(let i=0;i<n;i++){const r=Math.random()*Math.PI*2,c=1+Math.random()*3;T.push({x:e,y:t,vx:Math.cos(r)*c,vy:Math.sin(r)*c,life:1,maxLife:15+Math.random()*15,color:l,size:1.5+Math.random()*2})}},ne=()=>{for(let e=T.length-1;e>=0;e--){const t=T[e];t.x+=t.vx,t.y+=t.vy,t.vy+=.05,t.vx*=.97,t.life+=1,t.life>=t.maxLife&&T.splice(e,1)}},me=e=>({left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,width:`${Math.random()*2+1}px`,height:`${Math.random()*2+1}px`,animationDelay:`${Math.random()*3}s`,animationDuration:`${Math.random()*2+2}s`}),ye=()=>{f.value=Math.max(.1,f.value/2)},be=()=>{f.value=Math.min(P.value,f.value*2)},ie=async()=>{if(C.value||P.value<f.value)return;C.value=!0,N.value=!1,P.value-=f.value,te.value++;const e=D.value,t=e.map(r=>1/(r+.1)),l=t.reduce((r,c)=>r+c,0);let n=Math.random()*l;J=Math.floor(e.length/2);for(let r=0;r<t.length;r++)if(n-=t[r],n<=0){J=r;break}K();const i=(Math.random()-.5)*F*.3;s={x:b/2+i,y:-y*2,vx:(Math.random()-.5)*.8,vy:0,trail:[]},T=[],re()},re=()=>{if(!s)return;const e=$.value;if(!e)return;const t=e.getContext("2d");if(!t)return;s.vy+=ct,s.vx*=ce,s.vy*=ce,s.x+=s.vx,s.y+=s.vy;const l=Math.sqrt(s.vx*s.vx+s.vy*s.vy);l>ee&&(s.vx=s.vx/l*ee,s.vy=s.vy/l*ee),s.trail.push({x:s.x,y:s.y,age:0}),s.trail.length>12&&s.trail.shift();for(const i of s.trail)i.age++;for(const i of A){const r=s.x-i.x,c=s.y-i.y,d=r*r+c*c,w=i.radius+y,o=w*w;if(d<o&&d>.01){const v=Math.sqrt(d),u=r/v,h=c/v,g=w-v;s.x+=u*(g+.5),s.y+=h*(g+.5);const p=s.vx*u+s.vy*h;if(p<0){s.vx-=(1+he)*p*u,s.vy-=(1+he)*p*h;const ke=(Math.random()-.5)*1.8;s.vx+=ke;const de=s.y/x;if(de>.6){const Se=D.value,$e=b/Se.length,xe=((J+.5)*$e-s.x)*.005*(de-.6);s.vx+=xe}}i.glowIntensity=1;const R=Math.round((i.y-W)/O)/B.value,G=Math.round(59+-45*R),Ce=Math.round(130+81*R),_e=Math.round(246+-8*R);le(i.x,i.y,`rgb(${G},${Ce},${_e})`,4)}}s.x<y+10&&(s.x=y+10,s.vx=Math.abs(s.vx)*fe),s.x>b-y-10&&(s.x=b-y-10,s.vx=-Math.abs(s.vx)*fe);for(const i of A)i.glowIntensity>0&&(i.glowIntensity*=.9,i.glowIntensity<.01&&(i.glowIntensity=0));ne(),E(t);const n=x-36;if(s.y>n){we();return}U=requestAnimationFrame(re)},we=()=>{if(!s)return;const e=D.value,t=b/e.length,l=Math.floor(s.x/t),n=Math.max(0,Math.min(e.length-1,l));se.value=e[n],I.value=f.value*e[n]-f.value,P.value+=f.value*e[n],H.value.unshift({multiplier:e[n],win:I.value,bet:f.value});const i=(n+.5)*t,r=e[n]>=2?"#22c55e":e[n]>=1?"#3b82f6":"#ef4444";le(i,x-30,r,12),N.value=!0,s=null,C.value=!1;const c=()=>{const d=$.value;if(!d)return;const w=d.getContext("2d");w&&(ne(),E(w),T.length>0&&(U=requestAnimationFrame(c)))};c(),setTimeout(()=>{N.value=!1,z.value&&L.value>0&&(L.value--,L.value>0&&P.value>=f.value&&ie())},1500)},E=e=>{const t=b,l=x;e.fillStyle="#0a0e1a",e.fillRect(0,0,t,l);const n=e.createRadialGradient(t/2,l*.3,0,t/2,l*.3,t*.8);n.addColorStop(0,"rgba(59, 130, 246, 0.04)"),n.addColorStop(1,"rgba(0, 0, 0, 0)"),e.fillStyle=n,e.fillRect(0,0,t,l);const i=B.value;for(const o of A){const v=Math.round((o.y-W)/O),u=Math.min(1,v/(i-1)),h=Math.round(59+-45*u),g=Math.round(130+81*u),p=Math.round(246+-8*u),M=`rgb(${h},${g},${p})`;o.glowIntensity>.01&&(e.save(),e.shadowColor=M,e.shadowBlur=12*o.glowIntensity,e.fillStyle=`rgba(${h},${g},${p},${.3*o.glowIntensity})`,e.beginPath(),e.arc(o.x,o.y,o.radius*3,0,Math.PI*2),e.fill(),e.restore()),e.save(),e.shadowColor=`rgba(${h},${g},${p},0.4)`,e.shadowBlur=4;const R=e.createRadialGradient(o.x-o.radius*.3,o.y-o.radius*.3,0,o.x,o.y,o.radius),G=o.glowIntensity>.1?1.5:1;R.addColorStop(0,`rgba(${Math.min(255,h*G+80)},${Math.min(255,g*G+80)},${Math.min(255,p*G+80)},1)`),R.addColorStop(1,M),e.fillStyle=R,e.beginPath(),e.arc(o.x,o.y,o.radius+o.glowIntensity*1.5,0,Math.PI*2),e.fill(),e.restore()}for(const o of T){const v=1-o.life/o.maxLife;e.fillStyle=o.color.replace("rgb","rgba").replace(")",`,${v*.8})`),e.beginPath(),e.arc(o.x,o.y,o.size*(1-o.life/o.maxLife*.5),0,Math.PI*2),e.fill()}if(s){for(let v=0;v<s.trail.length;v++){const u=s.trail[v],h=(1-v/s.trail.length)*.4,g=y*(.3+.7*(1-v/s.trail.length));e.fillStyle=`rgba(236, 72, 153, ${h})`,e.beginPath(),e.arc(u.x,u.y,g,0,Math.PI*2),e.fill()}e.save(),e.shadowColor="rgba(236, 72, 153, 0.7)",e.shadowBlur=18;const o=e.createRadialGradient(s.x-y*.3,s.y-y*.3,0,s.x,s.y,y);o.addColorStop(0,"#f9a8d4"),o.addColorStop(.4,"#ec4899"),o.addColorStop(1,"#be185d"),e.fillStyle=o,e.beginPath(),e.arc(s.x,s.y,y,0,Math.PI*2),e.fill(),e.restore(),e.fillStyle="rgba(255, 255, 255, 0.55)",e.beginPath(),e.arc(s.x-y*.25,s.y-y*.3,y*.35,0,Math.PI*2),e.fill()}const r=D.value,c=t/r.length,d=l-36,w=34;r.forEach((o,v)=>{const u=v*c+1,h=c-2;let g,p;o>=10?(g="rgba(34, 197, 94, 0.35)",p="#4ade80"):o>=2?(g="rgba(34, 211, 238, 0.25)",p="#22d3ee"):o>=1?(g="rgba(99, 102, 241, 0.2)",p="#a5b4fc"):(g="rgba(239, 68, 68, 0.25)",p="#f87171"),e.fillStyle=g,e.beginPath();const M=4;e.moveTo(u+M,d),e.lineTo(u+h-M,d),e.arcTo(u+h,d,u+h,d+M,M),e.lineTo(u+h,d+w),e.lineTo(u,d+w),e.lineTo(u,d+M),e.arcTo(u,d,u+M,d,M),e.fill(),e.fillStyle=p,e.font=`bold ${r.length>13?8:10}px -apple-system, sans-serif`,e.textAlign="center",e.textBaseline="middle",e.fillText(`${o}x`,u+h/2,d+w/2)}),e.strokeStyle="rgba(255,255,255,0.06)",e.lineWidth=1;for(let o=1;o<r.length;o++){const v=o*c;e.beginPath(),e.moveTo(v,d),e.lineTo(v,d+w),e.stroke()}},j=()=>{const e=$.value,t=ae.value;if(!e||!t)return;const l=t.clientWidth,n=window.devicePixelRatio||1;b=Math.min(l,500),x=Math.round(b*1.3),e.width=b*n,e.height=x*n,e.style.width=b+"px",e.style.height=x+"px";const i=e.getContext("2d");if(i&&i.scale(n,n),K(),!s){const r=e.getContext("2d");r&&E(r)}},Me=()=>{if(K(),$.value){const e=$.value.getContext("2d");e&&E(e)}};return Ie(V,()=>{if($.value&&!s){const e=$.value.getContext("2d");e&&E(e)}}),Te(async()=>{await Re(),j(),window.addEventListener("resize",j)}),Be(()=>{U&&cancelAnimationFrame(U),window.removeEventListener("resize",j)}),(e,t)=>(S(),k("div",Ge,[a("div",Ne,[(S(),k(Q,null,Z(20,l=>a("div",{key:l,class:"star",style:We(me())},null,4)),64))]),a("header",Ve,[a("button",{class:"header-back",onClick:t[0]||(t[0]=l=>e.$router.push("/solo"))},[...t[6]||(t[6]=[a("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("path",{d:"M15 18l-6-6 6-6"})],-1)])]),t[9]||(t[9]=a("div",{class:"header-title"},[a("span",{class:"title-main"},"Plinko"),a("span",{class:"title-badge"},"x1000")],-1)),a("div",ze,[t[7]||(t[7]=a("span",{class:"balance-icon"},"ðŸ’Ž",-1)),a("span",De,_(P.value.toFixed(2)),1),t[8]||(t[8]=a("button",{class:"balance-add"},"+",-1))])]),a("div",Ue,[a("div",Oe,[t[10]||(t[10]=a("span",{class:"info-label"},"Ð˜Ð“Ð Ð",-1)),a("span",Xe,"#"+_(te.value),1)]),a("div",qe,[t[12]||(t[12]=a("span",{class:"info-label"},"Ð Ð˜Ð¡Ðš",-1)),q(a("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>V.value=l),class:"risk-select"},[...t[11]||(t[11]=[a("option",{value:"low"},"ÐÐ¸Ð·ÐºÐ¸Ð¹",-1),a("option",{value:"medium"},"Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹",-1),a("option",{value:"high"},"Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹",-1)])],512),[[ue,V.value]])]),a("div",Ye,[t[14]||(t[14]=a("span",{class:"info-label"},"Ð Ð¯Ð”Ð«",-1)),q(a("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>B.value=l),class:"rows-select",onChange:Me},[...t[13]||(t[13]=[a("option",{value:8},"8",-1),a("option",{value:12},"12",-1),a("option",{value:16},"16",-1)])],544),[[ue,B.value]])])]),a("div",{class:"game-container",ref_key:"gameContainer",ref:ae},[a("canvas",{ref_key:"gameCanvas",ref:$,class:"game-canvas"},null,512),N.value?(S(),k("div",{key:0,class:Y(["result-overlay",{win:I.value>0,lose:I.value<=0}])},[a("div",He,_(se.value)+"x",1),a("div",{class:Y(["result-amount",{positive:I.value>0}])},_(I.value>0?"+":"")+_(I.value.toFixed(2))+" TON ",3)],2)):ve("",!0)],512),a("div",Je,[a("div",Ke,[(S(),k(Q,null,Z(ge,l=>a("button",{key:l,class:Y(["bet-btn",{active:f.value===l}]),onClick:n=>f.value=l,disabled:C.value},_(l)+" ðŸ’Ž ",11,je)),64))]),a("div",Qe,[a("button",{class:"btn-half",onClick:ye,disabled:C.value},"Â½",8,Ze),a("button",{class:"btn-play",onClick:ie,disabled:C.value||P.value<f.value},[C.value?(S(),k("span",tt)):(S(),k("span",st,_(C.value?"Ð˜Ð³Ñ€Ð°...":`Ð˜Ð³Ñ€Ð°Ñ‚ÑŒ ${f.value} TON`),1))],8,et),a("button",{class:"btn-double",onClick:be,disabled:C.value},"2x",8,at)]),a("div",ot,[a("label",lt,[q(a("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=l=>z.value=l),disabled:C.value},null,8,nt),[[Fe,z.value]]),t[15]||(t[15]=a("span",null,"ÐÐ²Ñ‚Ð¾-Ð¸Ð³Ñ€Ð°",-1))]),z.value?q((S(),k("input",{key:0,type:"number","onUpdate:modelValue":t[4]||(t[4]=l=>L.value=l),class:"auto-count",min:"1",max:"100",placeholder:"ÐšÐ¾Ð»-Ð²Ð¾"},null,512)),[[Le,L.value,void 0,{number:!0}]]):ve("",!0)])]),a("div",it,[a("div",rt,[t[16]||(t[16]=a("span",null,"Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ",-1)),a("span",{class:"history-clear",onClick:t[5]||(t[5]=l=>H.value=[])},"ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ")]),a("div",dt,[(S(!0),k(Q,null,Z(H.value.slice(0,10),(l,n)=>(S(),k("div",{key:n,class:Y(["history-item",{win:l.win>0}])},[a("span",ut,_(l.multiplier)+"x",1),a("span",vt,_(l.win>0?"+":"")+_(l.win.toFixed(2)),1)],2))),128))])])]))}}),yt=Ee(ht,[["__scopeId","data-v-bff226b1"]]);export{yt as default};
