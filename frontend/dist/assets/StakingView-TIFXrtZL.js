import{f as J,h as X,a as o,b as s,t as l,F as b,k,p as u,s as Z,v as ss,i as as,x as v,m as ts,r,c as g,g as es,o as i,n as ls,j as T}from"./vue-DjRH996n.js";import{u as os}from"./useTonConnect-jnlkkonW.js";import{b as p}from"./client-BllIIJUg.js";import{a as is}from"./index-Der5g7Ax.js";import"./index-D5GkNzM3.js";const ns={class:"staking-view"},rs={class:"apy-hero"},ds={class:"apy-display"},cs={class:"apy-number"},us={class:"apy-stats-row"},ps={class:"stat-item"},vs={class:"stat-value"},ys={class:"stat-item"},_s={class:"stat-value"},ms={class:"stat-item"},fs={class:"stat-value"},ws={key:0,class:"stakes-section"},bs={class:"section-header"},ks=["disabled"],gs={class:"stakes-grid"},hs={class:"stake-header"},Cs=["src","alt"],Ss={class:"stake-info"},Ps={class:"stake-meta"},Ts={class:"value-badge"},Rs={class:"stake-progress"},Ns={class:"progress-bar"},xs={class:"progress-text"},Os={key:0},As={key:1},Fs={class:"stake-rewards"},Gs={class:"reward-item"},$s={class:"reward-value earnings-counter"},Es={class:"reward-item"},Bs={class:"reward-value"},Ls=["onClick"],Ms={key:0},Vs={key:1},Us={key:1,class:"empty-state"},Ds={class:"tiers-section"},Ws={class:"tiers-grid"},Ys=["onClick"],Is={key:0,class:"tier-badge"},Hs={key:1,class:"tier-badge premium-badge"},zs={class:"tier-title"},js={class:"tier-apr"},qs={class:"tier-days"},Ks={class:"tier-features"},Qs={class:"feature"},Js={key:0,class:"feature"},Xs={class:"tier-example"},Zs={class:"highlight"},sa={class:"available-section"},aa={class:"section-header"},ta={key:0,class:"connect-wallet-prompt"},ea={key:1,class:"no-gifts"},la={key:2,class:"gifts-grid"},oa=["onClick"],ia={class:"gift-card"},na=["src","alt"],ra={class:"gift-details"},da={class:"gift-meta"},ca={class:"value"},ua={class:"potential-apr"},pa={class:"highlight"},va={class:"modal-gift-preview"},ya=["src","alt"],_a={class:"preview-details"},ma={class:"value-badge"},fa={class:"period-selector"},wa={class:"period-options"},ba=["onClick"],ka={class:"period-label"},ga={class:"period-apr"},ha={key:0,class:"stake-preview"},Ca={class:"preview-row"},Sa={class:"preview-row"},Pa={class:"preview-row"},Ta={class:"preview-row highlight"},Ra={class:"preview-row highlight"},Na={class:"big"},xa={class:"preview-row reward"},Oa={class:"preview-row total"},Aa={class:"big"},Fa={class:"preview-row roi"},Ga={class:"big green"},$a=["disabled"],Ea=J({__name:"StakingView",setup(Ba){const A=es(),{wallet:h,connect:F}=os(),G=r(600),$=r(125e3),E=r(45e3),B=r(1250),y=r([]),f=r([]),w=r(""),C=r(!1),n=r(null),c=r(""),L=r("1m"),d=r(null),R=g(()=>[{period:"1w",label:"7 Days",days:7,apy:300,bonus:"Flexible unlock",popular:!1,premium:!1,exampleReward:"5.75"},{period:"2w",label:"14 Days",days:14,apy:400,bonus:"+10% early bird",popular:!0,premium:!1,exampleReward:"15.34"},{period:"1m",label:"30 Days",days:30,apy:450,bonus:"+20% boost",popular:!1,premium:!1,exampleReward:"36.99"},{period:"3m",label:"90 Days",days:90,apy:600,bonus:"+50% mega boost",extraBonus:"NFT Badge",popular:!1,premium:!0,exampleReward:"148.77"}]),N=g(()=>!!h.value),M=g(()=>y.value.some(e=>e.is_unlockable)),V=g(()=>{if(!w.value)return f.value;const e=w.value.toLowerCase();return f.value.filter(a=>a.name.toLowerCase().includes(e)||a.rarity.toLowerCase().includes(e))});async function _(){try{const e=await p.get("/staking/my-stakes");y.value=e.data.stakes||[]}catch(e){console.error("Failed to load stakes:",e)}}async function S(){if(!(!N.value||!h.value))try{const e=await p.get(`/gifts/owned/${h.value.account.address}`);f.value=e.data.gifts||[]}catch(e){console.error("Failed to load gifts:",e)}}function U(e){const m={common:1,uncommon:1.2,rare:1.5,epic:2,legendary:3,mythic:5}[e.rarity?.toLowerCase()]||1;return Math.round(600*m)}async function D(e){n.value=e,c.value="1m",C.value=!0,await W()}async function W(){if(!(!n.value||!c.value))try{const e=await p.get("/staking/preview",{params:{gift_value_ton:n.value.floor_price,period:c.value,rarity:n.value.rarity}});d.value=e.data}catch(e){console.error("Failed to load preview:",e)}}function P(){C.value=!1,n.value=null,c.value="",d.value=null}async function Y(){if(!(!n.value||!c.value))try{await p.post("/staking/stake",{gift_address:n.value.address,period:c.value}),alert("‚úÖ Stake created successfully!"),P(),await _(),await S()}catch(e){console.error("Stake failed:",e),alert("‚ùå Failed to create stake")}}async function I(e){e.is_unlockable?await H(e):await z(e)}async function H(e){try{await p.post(`/staking/claim/${e.id}`),alert(`‚úÖ Claimed ${e.total_at_unlock} TON!`),await _()}catch(a){console.error("Claim failed:",a),alert("‚ùå Failed to claim rewards")}}async function z(e){if(confirm(`‚ö†Ô∏è Early withdrawal penalty: 10% (${e.early_penalty} TON)

Continue?`))try{await p.post(`/staking/withdraw/${e.id}`),alert("Stake withdrawn with penalty"),await _()}catch(t){console.error("Withdrawal failed:",t),alert("Failed to withdraw")}}async function j(){try{await p.post("/staking/claim-all"),alert("‚úÖ All rewards claimed!"),await _()}catch(e){console.error("Claim all failed:",e)}}async function q(){await F(),await S()}function K(){A.push("/market")}function Q(){alert("Provably Fair verification coming soon!")}function x(e){return(typeof e=="string"?parseFloat(e):e).toFixed(2)}function O(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toString()}return X(async()=>{await _(),await S()}),(e,a)=>(i(),o("div",ns,[s("div",rs,[a[6]||(a[6]=s("div",{class:"apy-badge"},"üî• HIGHEST APR",-1)),a[7]||(a[7]=s("h1",{class:"apy-title"},"Stake Telegram Gifts",-1)),s("div",ds,[s("span",cs,l(G.value)+"%",1),a[2]||(a[2]=s("span",{class:"apy-label"},"APR",-1))]),a[8]||(a[8]=s("p",{class:"apy-subtitle"},"Lock your Gifts, earn TON daily",-1)),s("div",us,[s("div",ps,[s("span",vs,l(O($.value)),1),a[3]||(a[3]=s("span",{class:"stat-label"},"TON Staked",-1))]),s("div",ys,[s("span",_s,l(O(E.value)),1),a[4]||(a[4]=s("span",{class:"stat-label"},"TON Paid",-1))]),s("div",ms,[s("span",fs,l(B.value),1),a[5]||(a[5]=s("span",{class:"stat-label"},"Stakers",-1))])])]),y.value.length>0?(i(),o("section",ws,[s("div",bs,[a[10]||(a[10]=s("h2",null,"Your Stakes",-1)),s("button",{onClick:j,class:"claim-all-btn",disabled:!M.value},[...a[9]||(a[9]=[s("span",null,"üí∞",-1),s("span",null,"Claim All",-1)])],8,ks)]),s("div",gs,[(i(!0),o(b,null,k(y.value,t=>(i(),o("div",{key:t.id,class:"stake-card"},[s("div",hs,[s("img",{src:t.gift.image_url,alt:t.gift.name,class:"gift-image"},null,8,Cs),s("div",Ss,[s("h3",null,l(t.gift.name),1),s("div",Ps,[s("span",{class:v(["rarity-badge",`rarity-${t.gift.rarity}`])},l(t.gift.rarity),3),s("span",Ts,l(t.gift_value_ton)+" TON",1)])])]),s("div",Rs,[s("div",Ns,[s("div",{class:"progress-fill",style:ls({width:t.progressPercent+"%"})},null,4)]),s("div",xs,[t.is_unlockable?(i(),o("span",Os,"‚úÖ Unlocked!")):(i(),o("span",As,"‚è≥ "+l(t.days_remaining)+" days left",1))])]),s("div",Fs,[s("div",Gs,[a[11]||(a[11]=s("span",{class:"reward-label"},"Earned:",-1)),s("span",$s,"+"+l(x(t.earned_rewards))+" TON",1)]),s("div",Es,[a[12]||(a[12]=s("span",{class:"reward-label"},"APR:",-1)),s("span",Bs,l(t.effective_apy)+"%",1)])]),s("button",{onClick:m=>I(t),class:v(["action-btn",{unlocked:t.is_unlockable}])},[t.is_unlockable?(i(),o("span",Ms,"Claim "+l(x(t.total_at_unlock))+" TON",1)):(i(),o("span",Vs,"Unlock Early (-10% penalty)"))],10,Ls)]))),128))])])):u("",!0),y.value.length===0?(i(),o("div",Us,[...a[13]||(a[13]=[s("div",{class:"empty-icon"},"üéÅ",-1),s("h3",null,"No active stakes",-1),s("p",null,"Start staking your Gifts to earn up to 600% APR!",-1)])])):u("",!0),s("section",Ds,[a[16]||(a[16]=s("h2",null,"Choose Your Lock Period",-1)),s("div",Ws,[(i(!0),o(b,null,k(R.value,t=>(i(),o("div",{key:t.period,class:v(["tier-card",{popular:t.popular,premium:t.premium}]),onClick:m=>L.value=t.period},[t.popular?(i(),o("div",Is,"POPULAR")):u("",!0),t.premium?(i(),o("div",Hs,"BEST VALUE")):u("",!0),s("h3",zs,l(t.label),1),s("div",js,[T(l(t.apy)+"% ",1),a[14]||(a[14]=s("span",null,"APR",-1))]),s("div",qs,l(t.days)+" days lock",1),s("div",Ks,[s("div",Qs,"‚úÖ "+l(t.bonus),1),t.extraBonus?(i(),o("div",Js,"‚ú® "+l(t.extraBonus),1)):u("",!0)]),s("div",Xs,[a[15]||(a[15]=s("span",null,"100 TON stake ‚Üí",-1)),s("span",Zs,l(t.exampleReward)+" TON profit",1)])],10,Ys))),128))])]),s("section",sa,[s("div",aa,[a[17]||(a[17]=s("h2",null,"Your Gifts",-1)),Z(s("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>w.value=t),type:"text",placeholder:"Search gifts...",class:"search-input"},null,512),[[ss,w.value]])]),N.value?f.value.length===0?(i(),o("div",ea,[a[21]||(a[21]=s("div",{class:"no-gifts-icon"},"üò¢",-1)),a[22]||(a[22]=s("p",null,"You don't have any Gifts to stake",-1)),s("button",{onClick:K,class:"browse-btn"},"Browse Marketplace")])):(i(),o("div",la,[(i(!0),o(b,null,k(V.value,t=>(i(),o("div",{key:t.address,class:"gift-card-wrapper",onClick:m=>D(t)},[s("div",ia,[s("img",{src:t.image_url,alt:t.name},null,8,na),s("div",ra,[s("h4",null,l(t.name),1),s("div",da,[s("span",{class:v(["rarity",`rarity-${t.rarity}`])},l(t.rarity),3),s("span",ca,l(t.floor_price)+" TON",1)]),s("div",ua,[a[23]||(a[23]=T(" Earn up to ",-1)),s("span",pa,l(U(t))+"%",1),a[24]||(a[24]=T(" APR ",-1))])])])],8,oa))),128))])):(i(),o("div",ta,[a[18]||(a[18]=s("div",{class:"prompt-icon"},"üîó",-1)),a[19]||(a[19]=s("h3",null,"Connect Wallet",-1)),a[20]||(a[20]=s("p",null,"Connect your TON wallet to see your Gifts",-1)),s("button",{onClick:q,class:"connect-btn"},"Connect TON Wallet")]))]),a[41]||(a[41]=as('<section class="how-it-works" data-v-40513cb8><h2 data-v-40513cb8>How It Works</h2><div class="steps-grid" data-v-40513cb8><div class="step" data-v-40513cb8><div class="step-number" data-v-40513cb8>1</div><h3 data-v-40513cb8>Select Gift</h3><p data-v-40513cb8>Choose a Gift from your inventory</p></div><div class="step" data-v-40513cb8><div class="step-number" data-v-40513cb8>2</div><h3 data-v-40513cb8>Choose Period</h3><p data-v-40513cb8>Pick lock period: 7, 14, 30, or 90 days</p></div><div class="step" data-v-40513cb8><div class="step-number" data-v-40513cb8>3</div><h3 data-v-40513cb8>Earn Rewards</h3><p data-v-40513cb8>Get daily TON rewards automatically</p></div><div class="step" data-v-40513cb8><div class="step-number" data-v-40513cb8>4</div><h3 data-v-40513cb8>Claim</h3><p data-v-40513cb8>Unlock after period + claim your profit</p></div></div></section>',1)),s("section",{class:"provably-fair"},[a[25]||(a[25]=s("div",{class:"fair-icon"},"üîê",-1)),a[26]||(a[26]=s("h3",null,"Provably Fair Rewards",-1)),a[27]||(a[27]=s("p",null,"All staking rewards are calculated transparently on-chain. Verify anytime.",-1)),s("button",{onClick:Q,class:"verify-btn"},"Verify Fairness")]),C.value?(i(),o("div",{key:2,class:"modal-overlay",onClick:P},[s("div",{class:"modal-content",onClick:a[1]||(a[1]=ts(()=>{},["stop"]))},[s("button",{class:"modal-close",onClick:P},"‚úï"),s("h2",null,"Stake "+l(n.value?.name),1),s("div",va,[s("img",{src:n.value?.image_url,alt:n.value?.name},null,8,ya),s("div",_a,[s("span",{class:v(["rarity-badge",`rarity-${n.value?.rarity}`])},l(n.value?.rarity),3),s("span",ma,l(n.value?.floor_price)+" TON",1)])]),s("div",fa,[a[28]||(a[28]=s("h3",null,"Select Lock Period",-1)),s("div",wa,[(i(!0),o(b,null,k(R.value,t=>(i(),o("button",{key:t.period,class:v(["period-option",{selected:c.value===t.period}]),onClick:m=>c.value=t.period},[s("div",ka,l(t.label),1),s("div",ga,l(t.apy)+"% APR",1)],10,ba))),128))])]),d.value?(i(),o("div",ha,[a[37]||(a[37]=s("h3",null,"Stake Preview",-1)),s("div",Ca,[a[29]||(a[29]=s("span",null,"Gift Value:",-1)),s("span",null,l(d.value.gift_value_ton)+" TON",1)]),s("div",Sa,[a[30]||(a[30]=s("span",null,"Lock Period:",-1)),s("span",null,l(d.value.period_days)+" days",1)]),s("div",Pa,[a[31]||(a[31]=s("span",null,"Base APR:",-1)),s("span",null,l(d.value.base_apy_percent)+"%",1)]),s("div",Ta,[a[32]||(a[32]=s("span",null,"Rarity Bonus:",-1)),s("span",null,"√ó"+l(d.value.rarity_multiplier),1)]),s("div",Ra,[a[33]||(a[33]=s("span",null,"Effective APR:",-1)),s("span",Na,l(d.value.effective_apy_percent)+"%",1)]),a[38]||(a[38]=s("div",{class:"preview-divider"},null,-1)),s("div",xa,[a[34]||(a[34]=s("span",null,"Expected Reward:",-1)),s("span",null,"+"+l(d.value.expected_reward_ton)+" TON",1)]),s("div",Oa,[a[35]||(a[35]=s("span",null,"Total at Unlock:",-1)),s("span",Aa,l(d.value.total_at_unlock_ton)+" TON",1)]),s("div",Fa,[a[36]||(a[36]=s("span",null,"ROI:",-1)),s("span",Ga,"+"+l(d.value.roi_percent)+"%",1)])])):u("",!0),s("button",{onClick:Y,class:"confirm-stake-btn",disabled:!c.value},[...a[39]||(a[39]=[s("span",null,"üîí",-1),s("span",null,"Confirm Stake",-1)])],8,$a),a[40]||(a[40]=s("div",{class:"modal-warning"}," ‚ö†Ô∏è Early withdrawal penalty: 10% of Gift value ",-1))])])):u("",!0)]))}}),Wa=is(Ea,[["__scopeId","data-v-40513cb8"]]);export{Wa as default};
