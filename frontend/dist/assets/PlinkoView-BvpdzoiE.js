import{d as De,I as Ne,j as Ve,J as He,H as qe,c as T,b as a,F as he,f as fe,t as I,B as se,K as ke,n as ne,y as Pe,L as ze,C as Oe,r as w,l as Xe,o as A,k as Ye,D as Ze}from"./vue-DAmU7BeK.js";import{_ as je}from"./index-CKrxi2Gi.js";const Je={class:"plinko-view"},Ke={class:"stars-bg"},Qe={class:"plinko-header"},et={class:"header-balance"},tt={class:"balance-value"},lt={class:"game-info-bar"},at={class:"info-item"},ot={class:"info-value"},st={class:"info-item"},nt={class:"info-item"},it={class:"result-multiplier"},rt={class:"bet-section"},dt={class:"bet-amounts"},ut=["onClick","disabled"],vt={class:"action-row"},ct=["disabled"],ht=["disabled"],ft={key:0,class:"loading-spinner"},gt={key:1},pt=["disabled"],mt={class:"auto-play"},bt={class:"auto-label"},yt=["disabled"],wt={class:"history-section"},Mt={class:"history-header"},Ct={class:"history-list"},St={class:"history-mult"},_t={class:"history-amount"},m=7,Ie=.25,$e=.99,Te=.65,Ae=.4,ge=12,O=30,N=38,R=4,kt=.12,pe=.998,Pt=De({__name:"PlinkoView",setup(It){const F=w(5.16),me=w(48291),P=w(!1),K=w(!1),be=w(0),G=w(0),Q=w("medium"),V=w(12),Be=[.5,1,2,5,10],h=w(1),ee=w(!1),X=w(10),ie=w([]),$=w(null),ye=w(null);let d=380,B=500;const Le={low:{8:[5.6,2.1,1.1,1,.5,1,1.1,2.1,5.6],12:[8.9,3,1.4,1.1,1,.5,.3,.5,1,1.1,1.4,3,8.9],16:[16,9,2,1.4,1.1,1,.5,.3,.3,.5,1,1.1,1.4,2,9,16]},medium:{8:[13,3,1.3,.7,.4,.7,1.3,3,13],12:[33,11,4,2,1.1,.6,.3,.6,1.1,2,4,11,33],16:[110,41,10,5,3,1.5,1,.5,.3,.5,1,1.5,3,5,10,41,110]},high:{8:[29,4,1.5,.3,.2,.3,1.5,4,29],12:[170,24,8.1,2,.7,.2,.2,.7,2,8.1,24,170],16:[1e3,130,26,9,4,2,.2,.2,.2,.2,2,4,9,26,130,1e3]}},te=Xe(()=>{const e=Le[Q.value];return e[V.value]||e[12]});let l=null,Y=[],U=[],H=null,q=null,re=0,M=0,C=0,f=0,L="idle",de=0,Z=28,le=0,ae=4,j=80,we=0;const ue=()=>{Y=[];const e=V.value;e<=8?(Z=36,ae=5):e<=12?(Z=28,ae=4):(Z=22,ae=3.5),j=R+N+30,we=B-36-10,le=(we-j)/(e-1);const s=d/2;for(let i=0;i<e;i++){const n=i+3,v=(n-1)*Z,u=s-v/2;for(let g=0;g<n;g++)Y.push({x:u+g*Z,y:j+i*le,radius:ae,glowIntensity:0})}},Me=(e,t,s,i)=>{for(let n=0;n<i;n++){const v=Math.random()*Math.PI*2,u=1+Math.random()*3;U.push({x:e,y:t,vx:Math.cos(v)*u,vy:Math.sin(v)*u,life:1,maxLife:15+Math.random()*15,color:s,size:1.5+Math.random()*2})}},Ce=()=>{for(let e=U.length-1;e>=0;e--){const t=U[e];t.x+=t.vx,t.y+=t.vy,t.vy+=.05,t.vx*=.97,t.life+=1,t.life>=t.maxLife&&U.splice(e,1)}},Ee=e=>({left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,width:`${Math.random()*2+1}px`,height:`${Math.random()*2+1}px`,animationDelay:`${Math.random()*3}s`,animationDuration:`${Math.random()*2+2}s`}),Re=()=>{h.value=Math.max(.1,h.value/2)},Fe=()=>{h.value=Math.min(F.value,h.value*2)},Se=async()=>{if(P.value||F.value<h.value)return;P.value=!0,K.value=!1,F.value-=h.value,me.value++;const e=te.value,t=e.map(n=>1/(n+.1)),s=t.reduce((n,v)=>n+v,0);let i=Math.random()*s;re=Math.floor(e.length/2);for(let n=0;n<t.length;n++)if(i-=t[n],i<=0){re=n;break}ue(),q&&(cancelAnimationFrame(q),q=null),l={x:M,y:R+N-m,vx:0,vy:0,trail:[]},L="holding",de=0,U=[],oe()},oe=()=>{if(!l)return;const e=$.value;if(!e)return;const t=e.getContext("2d");if(!t)return;if(C+=f,f+=-.015*C,f*=pe,Math.abs(C)<.01&&Math.abs(f)<.001&&(f+=(Math.random()-.5)*.005),M=d/2+Math.sin(C)*d*.12,L==="holding"){l.x=M,l.y=R+N-m-2,de++,de>25&&(L="releasing",l.vx=f*d*.08,l.vy=.5),W(t),H=requestAnimationFrame(oe);return}if(L==="releasing"){l.vy+=Ie*.8,l.x+=l.vx,l.y+=l.vy,l.y>R+N+15&&(L="falling"),W(t),H=requestAnimationFrame(oe);return}l.vy+=Ie,l.vx*=$e,l.vy*=$e,l.x+=l.vx,l.y+=l.vy;const s=Math.sqrt(l.vx*l.vx+l.vy*l.vy);s>ge&&(l.vx=l.vx/s*ge,l.vy=l.vy/s*ge),l.trail.push({x:l.x,y:l.y,age:0}),l.trail.length>12&&l.trail.shift();for(const n of l.trail)n.age++;for(const n of Y){const v=l.x-n.x,u=l.y-n.y,g=v*v+u*u,k=n.radius+m,ce=k*k;if(g<ce&&g>.01){const E=Math.sqrt(g),x=v/E,c=u/E,D=k-E;l.x+=x*(D+.5),l.y+=c*(D+.5);const o=l.vx*x+l.vy*c;if(o<0){l.vx-=(1+Te)*o*x,l.vy-=(1+Te)*o*c;const _=(Math.random()-.5)*1.8;l.vx+=_;const z=l.y/B;if(z>.6){const J=te.value,We=d/J.length,xe=((re+.5)*We-l.x)*.005*(z-.6);l.vx+=xe}}n.glowIntensity=1;const r=Math.round((n.y-j)/le)/V.value,b=Math.round(59+-45*r),y=Math.round(130+81*r),S=Math.round(246+-8*r);Me(n.x,n.y,`rgb(${b},${y},${S})`,4)}}l.x<m+10&&(l.x=m+10,l.vx=Math.abs(l.vx)*Ae),l.x>d-m-10&&(l.x=d-m-10,l.vx=-Math.abs(l.vx)*Ae);for(const n of Y)n.glowIntensity>0&&(n.glowIntensity*=.9,n.glowIntensity<.01&&(n.glowIntensity=0));Ce(),W(t);const i=B-36;if(l.y>i){Ge();return}H=requestAnimationFrame(oe)},Ge=()=>{if(!l)return;const e=te.value,t=d/e.length,s=Math.floor(l.x/t),i=Math.max(0,Math.min(e.length-1,s));be.value=e[i],G.value=h.value*e[i]-h.value,F.value+=h.value*e[i],ie.value.unshift({multiplier:e[i],win:G.value,bet:h.value});const n=(i+.5)*t,v=e[i]>=2?"#22c55e":e[i]>=1?"#3b82f6":"#ef4444";Me(n,B-30,v,12),K.value=!0,l=null,P.value=!1,L="idle";const u=()=>{const g=$.value;if(!g)return;const k=g.getContext("2d");k&&(C+=f,f+=-.015*C,f*=pe,M=d/2+Math.sin(C)*d*.12,Ce(),W(k),U.length>0?H=requestAnimationFrame(u):_e())};u(),setTimeout(()=>{K.value=!1,ee.value&&X.value>0&&(X.value--,X.value>0&&F.value>=h.value&&Se())},1500)},W=e=>{const t=d,s=B;e.fillStyle="#0a0e1a",e.fillRect(0,0,t,s);const i=e.createRadialGradient(t/2,s*.3,0,t/2,s*.3,t*.8);i.addColorStop(0,"rgba(59, 130, 246, 0.04)"),i.addColorStop(1,"rgba(0, 0, 0, 0)"),e.fillStyle=i,e.fillRect(0,0,t,s);const n=M-O/2,v=R+N,u=e.createLinearGradient(n,0,n+O,0);u.addColorStop(0,"#1e3a5f"),u.addColorStop(.2,"#2563eb"),u.addColorStop(.5,"#3b82f6"),u.addColorStop(.8,"#2563eb"),u.addColorStop(1,"#1e3a5f"),e.fillStyle=u,e.beginPath(),e.roundRect(n,R,O,N,[6,6,4,4]),e.fill();const g=O*.55,k=e.createLinearGradient(M-g/2,0,M+g/2,0);k.addColorStop(0,"rgba(0,0,0,0.5)"),k.addColorStop(.5,"rgba(0,0,0,0.25)"),k.addColorStop(1,"rgba(0,0,0,0.5)"),e.fillStyle=k,e.fillRect(M-g/2,R+3,g,N-3),e.fillStyle="#2563eb",e.beginPath(),e.roundRect(n-3,v-6,O+6,6,[0,0,4,4]),e.fill(),e.strokeStyle="rgba(147, 197, 253, 0.4)",e.lineWidth=1,e.beginPath(),e.moveTo(n+4,R+3),e.lineTo(n+4,v-8),e.stroke(),(L==="holding"||L==="releasing")&&(e.save(),e.shadowColor="rgba(236, 72, 153, 0.6)",e.shadowBlur=15,e.fillStyle="rgba(236, 72, 153, 0.15)",e.beginPath(),e.ellipse(M,v,O*.6,6,0,0,Math.PI*2),e.fill(),e.restore());const ce=V.value;for(const o of Y){const p=Math.round((o.y-j)/le),r=Math.min(1,p/(ce-1)),b=Math.round(59+-45*r),y=Math.round(130+81*r),S=Math.round(246+-8*r),_=`rgb(${b},${y},${S})`;o.glowIntensity>.01&&(e.save(),e.shadowColor=_,e.shadowBlur=12*o.glowIntensity,e.fillStyle=`rgba(${b},${y},${S},${.3*o.glowIntensity})`,e.beginPath(),e.arc(o.x,o.y,o.radius*3,0,Math.PI*2),e.fill(),e.restore()),e.save(),e.shadowColor=`rgba(${b},${y},${S},0.4)`,e.shadowBlur=4;const z=e.createRadialGradient(o.x-o.radius*.3,o.y-o.radius*.3,0,o.x,o.y,o.radius),J=o.glowIntensity>.1?1.5:1;z.addColorStop(0,`rgba(${Math.min(255,b*J+80)},${Math.min(255,y*J+80)},${Math.min(255,S*J+80)},1)`),z.addColorStop(1,_),e.fillStyle=z,e.beginPath(),e.arc(o.x,o.y,o.radius+o.glowIntensity*1.5,0,Math.PI*2),e.fill(),e.restore()}for(const o of U){const p=1-o.life/o.maxLife;e.fillStyle=o.color.replace("rgb","rgba").replace(")",`,${p*.8})`),e.beginPath(),e.arc(o.x,o.y,o.size*(1-o.life/o.maxLife*.5),0,Math.PI*2),e.fill()}if(l){for(let p=0;p<l.trail.length;p++){const r=l.trail[p],b=(1-p/l.trail.length)*.4,y=m*(.3+.7*(1-p/l.trail.length));e.fillStyle=`rgba(236, 72, 153, ${b})`,e.beginPath(),e.arc(r.x,r.y,y,0,Math.PI*2),e.fill()}e.save(),e.shadowColor="rgba(236, 72, 153, 0.7)",e.shadowBlur=18;const o=e.createRadialGradient(l.x-m*.3,l.y-m*.3,0,l.x,l.y,m);o.addColorStop(0,"#f9a8d4"),o.addColorStop(.4,"#ec4899"),o.addColorStop(1,"#be185d"),e.fillStyle=o,e.beginPath(),e.arc(l.x,l.y,m,0,Math.PI*2),e.fill(),e.restore(),e.fillStyle="rgba(255, 255, 255, 0.55)",e.beginPath(),e.arc(l.x-m*.25,l.y-m*.3,m*.35,0,Math.PI*2),e.fill()}const E=te.value,x=t/E.length,c=s-36,D=34;E.forEach((o,p)=>{const r=p*x+1,b=x-2;let y,S;o>=10?(y="rgba(34, 197, 94, 0.35)",S="#4ade80"):o>=2?(y="rgba(34, 211, 238, 0.25)",S="#22d3ee"):o>=1?(y="rgba(99, 102, 241, 0.2)",S="#a5b4fc"):(y="rgba(239, 68, 68, 0.25)",S="#f87171"),e.fillStyle=y,e.beginPath();const _=4;e.moveTo(r+_,c),e.lineTo(r+b-_,c),e.arcTo(r+b,c,r+b,c+_,_),e.lineTo(r+b,c+D),e.lineTo(r,c+D),e.lineTo(r,c+_),e.arcTo(r,c,r+_,c,_),e.fill(),e.fillStyle=S,e.font=`bold ${E.length>13?8:10}px -apple-system, sans-serif`,e.textAlign="center",e.textBaseline="middle",e.fillText(`${o}x`,r+b/2,c+D/2)}),e.strokeStyle="rgba(255,255,255,0.06)",e.lineWidth=1;for(let o=1;o<E.length;o++){const p=o*x;e.beginPath(),e.moveTo(p,c),e.lineTo(p,c+D),e.stroke()}},ve=()=>{const e=$.value,t=ye.value;if(!e||!t)return;const s=t.clientWidth,i=window.devicePixelRatio||1;d=Math.min(s,500),B=Math.round(d*1.3),e.width=d*i,e.height=B*i,e.style.width=d+"px",e.style.height=B+"px";const n=e.getContext("2d");n&&n.scale(i,i),M=d/2,ue()},Ue=()=>{if(ue(),$.value){const e=$.value.getContext("2d");e&&W(e)}};Ne(Q,()=>{if($.value&&!l){const e=$.value.getContext("2d");e&&W(e)}});const _e=()=>{C=(Math.random()-.5)*kt,f=(Math.random()-.5)*.008,M=d/2;const e=()=>{const t=$.value;if(!t)return;const s=t.getContext("2d");s&&(C+=f,f+=-.015*C,f*=pe,Math.abs(C)<.01&&Math.abs(f)<.001&&(f+=(Math.random()-.5)*.004),M=d/2+Math.sin(C)*d*.12,W(s),q=requestAnimationFrame(e))};e()};return Ve(async()=>{await He(),ve(),_e(),window.addEventListener("resize",ve)}),qe(()=>{H&&cancelAnimationFrame(H),q&&cancelAnimationFrame(q),window.removeEventListener("resize",ve)}),(e,t)=>(A(),T("div",Je,[t[18]||(t[18]=a("div",{class:"game-plate"},[a("div",{class:"plate-title"},"Gift Plinko")],-1)),a("div",Ke,[(A(),T(he,null,fe(20,s=>a("div",{key:s,class:"star",style:Ye(Ee())},null,4)),64))]),a("header",Qe,[a("button",{class:"header-back",onClick:t[0]||(t[0]=s=>e.$router.push("/solo"))},[...t[6]||(t[6]=[a("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("path",{d:"M15 18l-6-6 6-6"})],-1)])]),t[9]||(t[9]=a("div",{class:"header-title"},[a("span",{class:"title-main"},"Plinko"),a("span",{class:"title-badge"},"x1000")],-1)),a("div",et,[t[7]||(t[7]=a("svg",{class:"balance-icon-svg",width:"16",height:"16",viewBox:"0 0 56 56",fill:"none"},[a("circle",{cx:"28",cy:"28",r:"28",fill:"#0098EA"}),a("path",{d:"M37.5603 15.6277H18.4386C14.9228 15.6277 12.6944 19.4202 14.4632 22.4861L26.2644 42.9409C27.0345 44.2765 28.9644 44.2765 29.7345 42.9409L41.5765 22.4861C43.3045 19.4202 41.0761 15.6277 37.5603 15.6277Z",fill:"white"})],-1)),a("span",tt,I(F.value.toFixed(2)),1),t[8]||(t[8]=a("button",{class:"balance-add"},"+",-1))])]),a("div",lt,[a("div",at,[t[10]||(t[10]=a("span",{class:"info-label"},"ИГРА",-1)),a("span",ot,"#"+I(me.value),1)]),a("div",st,[t[12]||(t[12]=a("span",{class:"info-label"},"РИСК",-1)),se(a("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>Q.value=s),class:"risk-select"},[...t[11]||(t[11]=[a("option",{value:"low"},"Низкий",-1),a("option",{value:"medium"},"Средний",-1),a("option",{value:"high"},"Высокий",-1)])],512),[[ke,Q.value]])]),a("div",nt,[t[14]||(t[14]=a("span",{class:"info-label"},"РЯДЫ",-1)),se(a("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>V.value=s),class:"rows-select",onChange:Ue},[...t[13]||(t[13]=[a("option",{value:8},"8",-1),a("option",{value:12},"12",-1),a("option",{value:16},"16",-1)])],544),[[ke,V.value]])])]),a("div",{class:"game-container",ref_key:"gameContainer",ref:ye},[a("canvas",{ref_key:"gameCanvas",ref:$,class:"game-canvas"},null,512),K.value?(A(),T("div",{key:0,class:ne(["result-overlay",{win:G.value>0,lose:G.value<=0}])},[a("div",it,I(be.value)+"x",1),a("div",{class:ne(["result-amount",{positive:G.value>0}])},I(G.value>0?"+":"")+I(G.value.toFixed(2))+" TON ",3)],2)):Pe("",!0)],512),a("div",rt,[a("div",dt,[(A(),T(he,null,fe(Be,s=>a("button",{key:s,class:ne(["bet-btn",{active:h.value===s}]),onClick:i=>h.value=s,disabled:P.value},[Ze(I(s)+" ",1),t[15]||(t[15]=a("svg",{class:"bet-ton-icon",width:"14",height:"14",viewBox:"0 0 56 56",fill:"none"},[a("circle",{cx:"28",cy:"28",r:"28",fill:"#0098EA"}),a("path",{d:"M37.5603 15.6277H18.4386C14.9228 15.6277 12.6944 19.4202 14.4632 22.4861L26.2644 42.9409C27.0345 44.2765 28.9644 44.2765 29.7345 42.9409L41.5765 22.4861C43.3045 19.4202 41.0761 15.6277 37.5603 15.6277Z",fill:"white"})],-1))],10,ut)),64))]),a("div",vt,[a("button",{class:"btn-half",onClick:Re,disabled:P.value},"½",8,ct),a("button",{class:"btn-play",onClick:Se,disabled:P.value||F.value<h.value},[P.value?(A(),T("span",ft)):(A(),T("span",gt,I(P.value?"Игра...":`Играть ${h.value} TON`),1))],8,ht),a("button",{class:"btn-double",onClick:Fe,disabled:P.value},"2x",8,pt)]),a("div",mt,[a("label",bt,[se(a("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=s=>ee.value=s),disabled:P.value},null,8,yt),[[ze,ee.value]]),t[16]||(t[16]=a("span",null,"Авто-игра",-1))]),ee.value?se((A(),T("input",{key:0,type:"number","onUpdate:modelValue":t[4]||(t[4]=s=>X.value=s),class:"auto-count",min:"1",max:"100",placeholder:"Кол-во"},null,512)),[[Oe,X.value,void 0,{number:!0}]]):Pe("",!0)])]),a("div",wt,[a("div",Mt,[t[17]||(t[17]=a("span",null,"История",-1)),a("span",{class:"history-clear",onClick:t[5]||(t[5]=s=>ie.value=[])},"Очистить")]),a("div",Ct,[(A(!0),T(he,null,fe(ie.value.slice(0,10),(s,i)=>(A(),T("div",{key:i,class:ne(["history-item",{win:s.win>0}])},[a("span",St,I(s.multiplier)+"x",1),a("span",_t,I(s.win>0?"+":"")+I(s.win.toFixed(2)),1)],2))),128))])])]))}}),Bt=je(Pt,[["__scopeId","data-v-5850305e"]]);export{Bt as default};
