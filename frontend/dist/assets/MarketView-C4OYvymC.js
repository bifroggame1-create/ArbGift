import{d as ke,o as ye,b as a,e as t,F as f,v as h,n as v,t as c,k as d,x as T,y as F,z as Q,A as J,j as W,h as X,w as Y,T as Z,B as we,r as u,c as g,C as _e,a as o,f as xe,D as Ce,E as Pe}from"./vue-CF-r4DcL.js";import{G as $e}from"./GiftCard-DlOmoLAT.js";import{u as Be,_ as Me}from"./index-BNLjFMtA.js";import{s as Se,g as ee,a as Te}from"./client-COG1KRRB.js";const Fe={class:"market-view"},Ve={class:"market-nav"},Ne=["onClick"],Oe={class:"market-toolbar"},Ee={key:0,class:"filter-badge"},Ge={class:"search-box"},Le={class:"sort-content"},ze={class:"sort-value"},Ue={class:"view-modes"},Ae={key:0,class:"active-filters"},De=["onClick"],He={class:"af-label"},Ie={class:"sort-menu"},Ke=["onClick"],Re={key:2,class:"loading-container"},je={key:3,class:"gift-grid-container"},qe={key:0,class:"pagination"},Qe={class:"page-controls"},Je=["disabled"],We={class:"page-info"},Xe={class:"current-page"},Ye={class:"total-pages"},Ze=["disabled"],et=["max"],tt={key:2,class:"empty-state"},lt={key:0,class:"filter-sidebar"},st={class:"filter-header"},it={class:"filter-body"},ot={class:"filter-section"},at={class:"filter-chips"},nt=["onClick"],rt={key:0,class:"filter-section"},ct={class:"filter-chips"},ut=["onClick"],dt={key:1,class:"filter-section"},vt={class:"filter-chips"},pt=["onClick"],ft={key:2,class:"filter-section"},ht={class:"filter-chips"},mt=["onClick"],bt={key:3,class:"filter-section"},gt={class:"filter-chips"},kt=["onClick"],yt={class:"filter-section"},wt={class:"filter-chips"},_t=["onClick"],xt={class:"filter-section"},Ct={class:"price-range"},Pt={class:"price-input-wrap"},$t={class:"price-input-wrap"},Bt={class:"filter-footer"},Mt={key:0,class:"filter-apply-count"},St={class:"market-footer"},Tt={class:"footer-left"},Ft={class:"ton-price"},Vt={class:"price-value"},Nt={class:"volume-info"},Ot={class:"volume-value"},V=50,Et=ke({__name:"MarketView",setup(Gt){const N=Ce(),{hapticImpact:k}=Be(),te=[{id:"all",label:"–í—Å–µ –ø–æ–¥–∞—Ä–∫–∏"},{id:"collections",label:"–ö–æ–ª–ª–µ–∫—Ü–∏–∏"},{id:"bundles",label:"–ë–∞–Ω–¥–ª—ã"}],G=u("all"),B=u(!0),M=u([]),O=u(""),S=u("listed_at desc"),C=u("large"),P=u(!1),y=u(!1),le=u(!1),se=u(!1),w=u([]),p=u(1),_=u(50),L=u("1.33"),z=u("247.5K"),i=_e({names:[],models:[],backdrops:[],patterns:[],symbols:[],rarities:[],minPrice:null,maxPrice:null}),m=u([]),ie=g(()=>[...new Set(m.value.map(s=>s.name).filter(Boolean))].sort()),U=g(()=>[...new Set(m.value.map(s=>s.model).filter(Boolean))].sort()),A=g(()=>[...new Set(m.value.map(s=>s.backdrop).filter(Boolean))].sort()),D=g(()=>[...new Set(m.value.map(s=>s.pattern).filter(Boolean))].sort()),H=g(()=>[...new Set(m.value.map(s=>s.symbol).filter(Boolean))].sort()),I=[{value:"common",label:"Common",color:"#6b7280"},{value:"uncommon",label:"Uncommon",color:"#22c55e"},{value:"rare",label:"Rare",color:"#3b82f6"},{value:"epic",label:"Epic",color:"#a855f7"},{value:"legendary",label:"Legendary",color:"#f59e0b"},{value:"mythic",label:"Mythic",color:"#ef4444"}],$=g(()=>{let s=0;return s+=i.names.length,s+=i.models.length,s+=i.backdrops.length,s+=i.patterns.length,s+=i.symbols.length,s+=i.rarities.length,i.minPrice!==null&&s++,i.maxPrice!==null&&s++,s}),K=g(()=>{const s=[];return i.names.forEach(e=>s.push({key:`name-${e}`,group:"names",value:e,label:e})),i.models.forEach(e=>s.push({key:`model-${e}`,group:"models",value:e,label:`–ú–æ–¥–µ–ª—å: ${e}`})),i.backdrops.forEach(e=>s.push({key:`backdrop-${e}`,group:"backdrops",value:e,label:`–§–æ–Ω: ${e}`})),i.patterns.forEach(e=>s.push({key:`pattern-${e}`,group:"patterns",value:e,label:`–ü–∞—Ç—Ç–µ—Ä–Ω: ${e}`})),i.symbols.forEach(e=>s.push({key:`symbol-${e}`,group:"symbols",value:e,label:`–°–∏–º–≤–æ–ª: ${e}`})),i.rarities.forEach(e=>{const l=I.find(n=>n.value===e);s.push({key:`rarity-${e}`,group:"rarities",value:e,label:l?.label||e})}),i.minPrice!==null&&s.push({key:"minPrice",group:"minPrice",value:String(i.minPrice),label:`–æ—Ç ${i.minPrice} TON`}),i.maxPrice!==null&&s.push({key:"maxPrice",group:"maxPrice",value:String(i.maxPrice),label:`–¥–æ ${i.maxPrice} TON`}),s}),x=(s,e)=>{const l=i[s],n=l.indexOf(e);n>-1?l.splice(n,1):l.push(e)},oe=s=>{if(s.group==="minPrice")i.minPrice=null;else if(s.group==="maxPrice")i.maxPrice=null;else{const e=i[s.group],l=e.indexOf(s.value);l>-1&&e.splice(l,1)}E()},R=()=>{i.names=[],i.models=[],i.backdrops=[],i.patterns=[],i.symbols=[],i.rarities=[],i.minPrice=null,i.maxPrice=null},E=()=>{y.value=!1,p.value=1,b()},j=[{value:"listed_at desc",label:"–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ"},{value:"listed_at asc",label:"–°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ"},{value:"price asc",label:"–î–µ—à–µ–≤–ª–µ"},{value:"price desc",label:"–î–æ—Ä–æ–∂–µ"}],ae=g(()=>j.find(s=>s.value===S.value)?.label||"–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ"),ne=s=>{k("light"),G.value=s,s==="collections"?N.push("/collection-list"):s==="bundles"&&N.push("/bundles")},re=s=>{k("light"),S.value=s,P.value=!1,b()};let q;const ce=()=>{clearTimeout(q),q=setTimeout(()=>{b()},300)},ue=()=>{p.value>1&&(p.value--,b())},de=()=>{p.value<_.value&&(p.value++,b())},b=async()=>{B.value=!0;try{const s=(p.value-1)*V,e=O.value?.trim();let l;if(e)l=await Se(e,{limit:V,collection_id:void 0});else{const r={is_on_sale:!0,sort:S.value,limit:V,offset:s};i.rarities.length===1&&(r.rarity=i.rarities[0]),i.models.length===1&&(r.model=i.models[0]),i.backdrops.length===1&&(r.backdrop=i.backdrops[0]),i.patterns.length===1&&(r.pattern=i.patterns[0]),i.symbols.length===1&&(r.symbol=i.symbols[0]),i.minPrice!==null&&(r.min_price=i.minPrice),i.maxPrice!==null&&(r.max_price=i.maxPrice),l=await ee(r)}let n=l.items||l||[];i.names.length>0&&(n=n.filter(r=>i.names.includes(r.name))),i.rarities.length>1&&(n=n.filter(r=>i.rarities.includes(r.rarity))),i.models.length>1&&(n=n.filter(r=>i.models.includes(r.model))),i.backdrops.length>1&&(n=n.filter(r=>i.backdrops.includes(r.backdrop))),i.patterns.length>1&&(n=n.filter(r=>i.patterns.includes(r.pattern))),i.symbols.length>1&&(n=n.filter(r=>i.symbols.includes(r.symbol))),M.value=n,m.value.length===0&&n.length>0&&(m.value=n),l.total&&(_.value=Math.ceil(l.total/V))}catch(s){console.error("Fetch gifts error:",s),M.value=[]}finally{B.value=!1}},ve=async()=>{try{const s=await ee({is_on_sale:!0,limit:500}),e=s.items||s||[];e.length>0&&(m.value=e)}catch{}},pe=async()=>{try{const s=await Te();s.volume_24h&&(z.value=fe(s.volume_24h)),s.ton_price&&(L.value=s.ton_price.toFixed(2))}catch{}},fe=s=>s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":s.toString(),he=s=>{k("light"),N.push(`/gift/${s.id}`)},me=s=>{k("medium")},be=s=>{k("light");const e=w.value.indexOf(s.id);e>-1?w.value.splice(e,1):w.value.push(s.id)},ge=()=>{k("heavy")};return ye(()=>{b(),pe(),ve()}),(s,e)=>(o(),a("div",Fe,[t("nav",Ve,[(o(),a(f,null,h(te,l=>t("button",{key:l.id,class:v(["nav-tab",{active:G.value===l.id}]),onClick:n=>ne(l.id)},c(l.label),11,Ne)),64))]),t("div",Oe,[t("button",{class:v(["toolbar-btn filter-btn",{"has-filters":$.value>0}]),onClick:e[0]||(e[0]=l=>y.value=!0)},[e[13]||(e[13]=t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M22 3H2l8 9.46V19l4 2v-8.54L22 3z"})],-1)),e[14]||(e[14]=t("span",null,"–§–∏–ª—å—Ç—Ä—ã",-1)),$.value>0?(o(),a("span",Ee,c($.value),1)):d("",!0)],2),t("div",Ge,[e[15]||(e[15]=t("svg",{class:"search-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("path",{d:"m21 21-4.35-4.35"})],-1)),T(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>O.value=l),type:"text",placeholder:"–ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫",class:"search-input",onInput:ce},null,544),[[F,O.value]])]),t("button",{class:"toolbar-btn sort-btn",onClick:e[2]||(e[2]=l=>P.value=!P.value)},[t("div",Le,[e[16]||(e[16]=t("span",{class:"sort-label"},"–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ",-1)),t("span",ze,c(ae.value),1)]),e[17]||(e[17]=t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"m6 9 6 6 6-6"})],-1))]),t("button",{class:"toolbar-btn activity-btn",onClick:e[3]||(e[3]=l=>le.value=!0)},[...e[18]||(e[18]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})],-1),t("span",null,"–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",-1)])]),t("div",Ue,[t("button",{class:v(["view-btn",{active:C.value==="small"}]),onClick:e[4]||(e[4]=l=>C.value="small")},[...e[19]||(e[19]=[Q('<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" data-v-88d5efba><rect x="3" y="3" width="7" height="7" data-v-88d5efba></rect><rect x="14" y="3" width="7" height="7" data-v-88d5efba></rect><rect x="3" y="14" width="7" height="7" data-v-88d5efba></rect><rect x="14" y="14" width="7" height="7" data-v-88d5efba></rect></svg>',1)])],2),t("button",{class:v(["view-btn",{active:C.value==="large"}]),onClick:e[5]||(e[5]=l=>C.value="large")},[...e[20]||(e[20]=[Q('<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" data-v-88d5efba><rect x="3" y="3" width="8" height="8" data-v-88d5efba></rect><rect x="13" y="3" width="8" height="8" data-v-88d5efba></rect><rect x="3" y="13" width="8" height="8" data-v-88d5efba></rect><rect x="13" y="13" width="8" height="8" data-v-88d5efba></rect></svg>',1)])],2)]),t("button",{class:"toolbar-btn refresh-btn",onClick:b},[...e[21]||(e[21]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M23 4v6h-6"}),t("path",{d:"M1 20v-6h6"}),t("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})],-1)])])]),K.value.length>0?(o(),a("div",Ae,[(o(!0),a(f,null,h(K.value,l=>(o(),a("button",{key:l.key,class:"active-filter-chip",onClick:n=>oe(l)},[t("span",He,c(l.label),1),e[22]||(e[22]=t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6 6 18"}),t("path",{d:"m6 6 12 12"})],-1))],8,De))),128)),t("button",{class:"clear-all-btn",onClick:e[6]||(e[6]=l=>{R(),E()})},"–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë")])):d("",!0),P.value?(o(),a("div",{key:1,class:"sort-dropdown",onClick:e[7]||(e[7]=J(l=>P.value=!1,["self"]))},[t("div",Ie,[(o(),a(f,null,h(j,l=>t("button",{key:l.value,class:v(["sort-option",{active:S.value===l.value}]),onClick:n=>re(l.value)},c(l.label),11,Ke)),64))])])):d("",!0),B.value?(o(),a("div",Re,[...e[23]||(e[23]=[t("div",{class:"loading-spinner"},null,-1)])])):(o(),a("div",je,[t("div",{class:v(["gift-grid",C.value])},[(o(!0),a(f,null,h(M.value,l=>(o(),W($e,{key:l.id,gift:l,selectable:se.value,"is-selected":w.value.includes(l.id),onClick:he,onBuy:me,onSelect:be},null,8,["gift","selectable","is-selected"]))),128))],2),_.value>0?(o(),a("div",qe,[t("div",Qe,[t("button",{class:"page-btn",disabled:p.value<=1,onClick:ue},[...e[24]||(e[24]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"m15 18-6-6 6-6"})],-1)])],8,Je),t("div",We,[t("span",Xe,c(p.value),1),e[25]||(e[25]=t("span",{class:"page-divider"},"/",-1)),t("span",Ye,c(_.value),1)]),t("button",{class:"page-btn",disabled:p.value>=_.value,onClick:de},[...e[26]||(e[26]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"m9 18 6-6-6-6"})],-1)])],8,Ze)]),T(t("input",{type:"range",class:"page-slider",min:1,max:_.value,"onUpdate:modelValue":e[8]||(e[8]=l=>p.value=l),onChange:b},null,40,et),[[F,p.value,void 0,{number:!0}]])])):d("",!0),w.value.length>0?(o(),a("button",{key:1,class:"bulk-buy-btn",onClick:ge},[e[27]||(e[27]=t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"}),t("path",{d:"M3 6h18"}),t("path",{d:"M16 10a4 4 0 0 1-8 0"})],-1)),t("span",null,c(w.value.length),1)])):d("",!0),!B.value&&M.value.length===0?(o(),a("div",tt,[...e[28]||(e[28]=[t("span",{class:"empty-icon"},"üéÅ",-1),t("p",{class:"empty-text"},"–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≥–∏—Ñ—Ç–æ–≤",-1),t("p",{class:"empty-hint"},"–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã",-1)])])):d("",!0)])),(o(),W(we,{to:"body"},[X(Z,{name:"filter-overlay"},{default:Y(()=>[y.value?(o(),a("div",{key:0,class:"filter-overlay",onClick:e[12]||(e[12]=J(l=>y.value=!1,["self"]))},[X(Z,{name:"filter-slide"},{default:Y(()=>[y.value?(o(),a("div",lt,[t("div",st,[e[30]||(e[30]=t("h3",{class:"filter-title"},"–§–∏–ª—å—Ç—Ä—ã",-1)),t("button",{class:"filter-close",onClick:e[9]||(e[9]=l=>y.value=!1)},[...e[29]||(e[29]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6 6 18"}),t("path",{d:"m6 6 12 12"})],-1)])])]),t("div",it,[t("div",ot,[e[31]||(e[31]=t("div",{class:"filter-section-title"},"–ü–æ–¥–∞—Ä–æ–∫",-1)),t("div",at,[(o(!0),a(f,null,h(ie.value,l=>(o(),a("button",{key:l,class:v(["filter-chip",{active:i.names.includes(l)}]),onClick:n=>x("names",l)},c(l),11,nt))),128))])]),U.value.length?(o(),a("div",rt,[e[32]||(e[32]=t("div",{class:"filter-section-title"},"–ú–æ–¥–µ–ª—å",-1)),t("div",ct,[(o(!0),a(f,null,h(U.value,l=>(o(),a("button",{key:l,class:v(["filter-chip",{active:i.models.includes(l)}]),onClick:n=>x("models",l)},c(l),11,ut))),128))])])):d("",!0),A.value.length?(o(),a("div",dt,[e[33]||(e[33]=t("div",{class:"filter-section-title"},"–§–æ–Ω",-1)),t("div",vt,[(o(!0),a(f,null,h(A.value,l=>(o(),a("button",{key:l,class:v(["filter-chip",{active:i.backdrops.includes(l)}]),onClick:n=>x("backdrops",l)},c(l),11,pt))),128))])])):d("",!0),D.value.length?(o(),a("div",ft,[e[34]||(e[34]=t("div",{class:"filter-section-title"},"–ü–∞—Ç—Ç–µ—Ä–Ω",-1)),t("div",ht,[(o(!0),a(f,null,h(D.value,l=>(o(),a("button",{key:l,class:v(["filter-chip",{active:i.patterns.includes(l)}]),onClick:n=>x("patterns",l)},c(l),11,mt))),128))])])):d("",!0),H.value.length?(o(),a("div",bt,[e[35]||(e[35]=t("div",{class:"filter-section-title"},"–°–∏–º–≤–æ–ª",-1)),t("div",gt,[(o(!0),a(f,null,h(H.value,l=>(o(),a("button",{key:l,class:v(["filter-chip",{active:i.symbols.includes(l)}]),onClick:n=>x("symbols",l)},c(l),11,kt))),128))])])):d("",!0),t("div",yt,[e[36]||(e[36]=t("div",{class:"filter-section-title"},"–†–µ–¥–∫–æ—Å—Ç—å",-1)),t("div",wt,[(o(),a(f,null,h(I,l=>t("button",{key:l.value,class:v(["filter-chip rarity-chip",{active:i.rarities.includes(l.value)}]),style:Pe(i.rarities.includes(l.value)?{background:l.color,borderColor:l.color}:{}),onClick:n=>x("rarities",l.value)},c(l.label),15,_t)),64))])]),t("div",xt,[e[38]||(e[38]=t("div",{class:"filter-section-title"},"–¶–µ–Ω–∞ (TON)",-1)),t("div",Ct,[t("div",Pt,[T(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>i.minPrice=l),type:"number",placeholder:"–ú–∏–Ω",class:"price-input",min:"0",step:"0.1"},null,512),[[F,i.minPrice,void 0,{number:!0}]])]),e[37]||(e[37]=t("span",{class:"price-dash"},"‚Äî",-1)),t("div",$t,[T(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>i.maxPrice=l),type:"number",placeholder:"–ú–∞–∫—Å",class:"price-input",min:"0",step:"0.1"},null,512),[[F,i.maxPrice,void 0,{number:!0}]])])])])]),t("div",Bt,[t("button",{class:"filter-reset",onClick:R},"–°–±—Ä–æ—Å–∏—Ç—å"),t("button",{class:"filter-apply",onClick:E},[e[39]||(e[39]=xe(" –ü–æ–∫–∞–∑–∞—Ç—å ",-1)),$.value>0?(o(),a("span",Mt,c($.value),1)):d("",!0)])])])):d("",!0)]),_:1})])):d("",!0)]),_:1})])),t("footer",St,[t("div",Tt,[t("div",Ft,[e[40]||(e[40]=t("img",{src:"https://ton.org/download/ton_symbol.svg",alt:"TON",class:"ton-logo"},null,-1)),t("span",Vt,c(L.value)+"$",1)]),t("div",Nt,[e[41]||(e[41]=t("span",{class:"volume-label"},"–û–±—â–∏–π –æ–±—ä–µ–º 24H",-1)),t("span",Ot,c(z.value),1),e[42]||(e[42]=t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",class:"volume-icon"},[t("path",{d:"M12 2L2 7l10 5 10-5-10-5z"})],-1))])]),e[43]||(e[43]=t("div",{class:"footer-right"},[t("button",{class:"footer-btn"},"–ù–∞—Å—Ç—Ä–æ–π–∫–∏"),t("a",{href:"https://t.me/portals_sup",target:"_blank",class:"footer-btn"},"–ü–æ–¥–¥–µ—Ä–∂–∫–∞"),t("a",{href:"https://t.me/portals",target:"_blank",class:"footer-btn"},"Telegram")],-1))])]))}}),Dt=Me(Et,[["__scopeId","data-v-88d5efba"]]);export{Dt as default};
