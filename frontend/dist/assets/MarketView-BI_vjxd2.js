const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/lottie-DzwejvuX.js","assets/_commonjsHelpers-BosuxZz1.js"])))=>i.map(i=>d[i]);
import{d as V,x as Ge,j as Q,y as Le,o as c,c as h,k as re,z as P,r as _,b as t,h as K,t as w,A as L,n as G,l as x,a as ae,g as A,F as E,f as O,w as j,T as I,B as ee,C as Fe,D as De}from"./vue-DrcrC0TO.js";import{_ as Ae,a as N,u as ne}from"./index-nHsVjOhL.js";import{s as Ee,g as te,a as Oe}from"./client-pJ2CWAUX.js";const Te={Gunmetal:{center:5004643,edge:3095362},"Electric Indigo":{center:11108595,edge:5989080},"Ranger Green":{center:6256713,edge:3952443},Lemongrass:{center:11450458,edge:5608261},Lavender:{center:12028388,edge:9067196},"Hunter Green":{center:9416312,edge:4948571},"Khaki Green":{center:11382896,edge:7044436},Raspberry:{center:14711685,edge:11950464},Cyberpunk:{center:8753139,edge:8806355},"Pacific Green":{center:7325587,edge:3906692},"Sky Blue":{center:5813448,edge:5475266},"Roman Silver":{center:10725557,edge:8159370},"Pine Green":{center:7055740,edge:4094320},"Coral Red":{center:14322027,edge:12870991},"French Violet":{center:12738790,edge:9522905},"Electric Purple":{center:13267142,edge:9855700},"Pacific Cyan":{center:5947046,edge:4036026},"Pure Gold":{center:13413185,edge:9993010},Copper:{center:13665878,edge:10315057},Mustard:{center:13932557,edge:12875538},"Onyx Black":{center:5067348,edge:3225144},"English Violet":{center:11634363,edge:8870545},"Battleship Grey":{center:9211013,edge:7105638},"Light Olive":{center:12758884,edge:8945221},Cappuccino:{center:11636862,edge:8151894},Platinum:{center:11710119,edge:8946814},Rosewood:{center:12024439,edge:8473682},"Navy Blue":{center:7118557,edge:6057673},Tomato:{center:15104318,edge:13913663},"Steel Grey":{center:9937580,edge:6517372},"Midnight Blue":{center:6056325,edge:3489879},"Mint Green":{center:8309634,edge:4562522},Chocolate:{center:10776152,edge:7619643},Emerald:{center:7914885,edge:4366705},"Cobalt Blue":{center:6326479,edge:5333688},"Desert Sand":{center:11771778,edge:8287067},Persimmon:{center:15181658,edge:12937055},"Mexican Pink":{center:14902930,edge:13191548},Strawberry:{center:14519919,edge:12016224},Sapphire:{center:5809096,edge:5470658},Turquoise:{center:6209720,edge:4035214},"Carrot Juice":{center:14391399,edge:13070159},"French Blue":{center:6069188,edge:3634074},Fandango:{center:14846646,edge:10770571},Carmine:{center:14702410,edge:11024443},"Burnt Sienna":{center:14053180,edge:11881261},Feldgrau:{center:9015944,edge:6187875},"Jade Green":{center:5620892,edge:3905911},Moonstone:{center:8303028,edge:5800848},Pistachio:{center:9941116,edge:6062412},"Rifle Green":{center:6580572,edge:4936257},Amber:{center:14332741,edge:11632682},"Satin Gold":{center:12557127,edge:9271097},"Azure Blue":{center:6140363,edge:4492203},"Tactical Pine":{center:4489835,edge:3105641},"Fire Engine":{center:15753039,edge:12859721},"Indigo Dye":{center:5470609,edge:4285561},Grape:{center:10319041,edge:7949728},Black:{center:3553080,edge:921359},Burgundy:{center:10706534,edge:7160138},"Shamrock Green":{center:9089379,edge:5608261},"Mystic Pearl":{center:13667181,edge:11556720},"Dark Lilac":{center:11632037,edge:9197434},Chestnut:{center:12480340,edge:10045496},Malachite:{center:9811031,edge:4036437},Aquamarine:{center:6336917,edge:4631476},"Ivory White":{center:12236465,edge:10591639},"Old Gold":{center:11898168,edge:9726245},"Gunship Green":{center:5605989,edge:4023895},"Deep Cyan":{center:3257770,edge:1611161},"Seal Brown":{center:6704453,edge:4666926},"Camo Green":{center:7705677,edge:5534529},Orange:{center:13736506,edge:12611399},"Celtic Blue":{center:4569325,edge:3704537},Purple:{center:11431086,edge:8669060},"Neon Blue":{center:7706361,edge:6841060},"Dark Green":{center:5333825,edge:2835759},"Marine Blue":{center:5138588,edge:3885946},Caramel:{center:13670706,edge:12022833},"Silver Blue":{center:8430776,edge:6323345}};function le(i){return"#"+(i&16777215).toString(16).padStart(6,"0")}function ze(i){if(!i)return"linear-gradient(180deg, #3A3A3A 0%, #282727 100%)";const n=Te[i];if(n)return`linear-gradient(180deg, ${le(n.center)} 0%, ${le(n.edge)} 100%)`;let r=0;for(let d=0;d<i.length;d++)r=(r<<5)-r+i.charCodeAt(d)|0;const o=Math.abs(r)%360;return`linear-gradient(180deg, hsl(${o}, 25%, 28%) 0%, hsl(${o}, 30%, 18%) 100%)`}const He=["src","alt"],Ve=V({__name:"LottieGift",props:{src:{},fallbackSrc:{},alt:{default:"Gift"},size:{default:100},autoplay:{type:Boolean,default:!0},loop:{type:Boolean,default:!0}},setup(i){let n=null;const r=async()=>(n||(n=await Ae(()=>import("./lottie-DzwejvuX.js").then(C=>C.l),__vite__mapDeps([0,1]))),n.default),o=i,d=_(null),v=_(!1);let m=null;async function b(){if(!d.value||!o.src){v.value=!0;return}m&&(m.destroy(),m=null),v.value=!1;try{const C=await r();if(!d.value)return;m=C.loadAnimation({container:d.value,renderer:"svg",loop:o.loop,autoplay:o.autoplay,path:o.src}),m.addEventListener("data_failed",()=>{v.value=!0,m?.destroy(),m=null}),m.addEventListener("error",()=>{v.value=!0,m?.destroy(),m=null})}catch{v.value=!0}}return Ge(()=>o.src,()=>{b()}),Q(()=>{b()}),Le(()=>{m&&(m.destroy(),m=null)}),(C,F)=>(c(),h("div",{ref_key:"container",ref:d,class:"lottie-gift",style:re({width:i.size+"px",height:i.size+"px"})},[v.value&&i.fallbackSrc?(c(),h("img",{key:0,src:i.fallbackSrc,alt:i.alt,class:"lottie-gift__fallback",loading:"lazy",draggable:"false"},null,8,He)):P("",!0)],4))}}),Ne=N(Ve,[["__scopeId","data-v-66204c08"]]),Re={class:"gift-card__image"},je=["src","alt"],Ie={key:2,class:"gift-card__placeholder"},Ze={class:"gift-card__info"},Ke={class:"gift-card__name"},Ue={class:"gift-card__serial"},We={key:0,width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor"},Je=V({__name:"GiftCard",props:{gift:{},selectable:{type:Boolean},isSelected:{type:Boolean}},emits:["click","buy","select"],setup(i,{emit:n}){const r=i,o=n,{hapticImpact:d}=ne(),v=_(!1),m=x(()=>{if(r.gift.animation_url)return r.gift.animation_url;if(r.gift.lottie_url)return r.gift.lottie_url;const u=r.gift.image_url;return u&&u.includes("nft.fragment.com/gift/")?u.replace(/\.(webp|jpg|png|medium\.jpg|large\.jpg|small\.jpg)$/i,".lottie.json"):null}),b=x(()=>Math.round(Math.min(window.innerWidth/3-16,140))),C=x(()=>r.gift.tg_id?r.gift.tg_id:r.gift.index?r.gift.index:r.gift.id),F=x(()=>{const u=r.gift.lowest_price_ton||r.gift.min_price_ton||r.gift.price||0,p=Number(u);return p<=0?null:p.toFixed(2).replace(/\.?0+$/,"")}),$=x(()=>({"--card-bg":ze(r.gift.backdrop)})),S=()=>{d("light"),r.selectable?o("select",r.gift):o("click",r.gift)},g=()=>{d("medium"),o("buy",r.gift)};return(u,p)=>(c(),h("div",{class:"gift-card gift-card-appear base-active-btn",style:re($.value),onClick:S},[t("div",Re,[m.value?(c(),K(Ne,{key:0,src:m.value,"fallback-src":i.gift.image_url,alt:i.gift.name,size:b.value,class:"gift-card__lottie"},null,8,["src","fallback-src","alt","size"])):i.gift.image_url&&!v.value?(c(),h("img",{key:1,src:i.gift.image_url,alt:i.gift.name,loading:"lazy",draggable:"false",onError:p[0]||(p[0]=y=>v.value=!0)},null,40,je)):(c(),h("div",Ie,[...p[1]||(p[1]=[t("span",{class:"gift-card__placeholder-emoji"},"ðŸŽ",-1)])]))]),t("div",Ze,[t("div",Ke,w(i.gift.name),1),t("div",Ue,"#"+w(C.value),1),F.value?(c(),h("button",{key:0,class:"gift-card__price",onClick:L(g,["stop"])},[p[2]||(p[2]=t("svg",{class:"gift-card__ton-icon",width:"12",height:"12",viewBox:"0 0 16 16",fill:"none"},[t("path",{d:"M12.7238 1.00488H3.27565C1.53846 1.00488 0.437395 2.87874 1.31137 4.39358L7.14243 14.5002C7.52294 15.1601 8.47652 15.1601 8.85703 14.5002L14.6893 4.39358C15.5621 2.88116 14.461 1.00488 12.725 1.00488H12.7238ZM7.13769 11.4694L5.86778 9.01168L2.80363 3.53153C2.60149 3.18078 2.85116 2.7313 3.27446 2.7313H7.1365V11.4705L7.13769 11.4694ZM13.1935 3.53035L10.1305 9.01287L8.86059 11.4694V2.73011H12.7226C13.1459 2.73011 13.3956 3.17959 13.1935 3.53035Z",fill:"currentColor"})],-1)),t("span",null,w(F.value),1)])):P("",!0)]),i.selectable?(c(),h("div",{key:0,class:G(["gift-card__checkbox",{"gift-card__checkbox--selected":i.isSelected}])},[i.isSelected?(c(),h("svg",We,[...p[3]||(p[3]=[t("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},null,-1)])])):P("",!0)],2)):P("",!0)],4))}}),qe=N(Je,[["__scopeId","data-v-15b742df"]]),Qe={class:"skeleton-card"},Ye=V({__name:"SkeletonCard",setup(i){return(n,r)=>(c(),h("div",Qe,[...r[0]||(r[0]=[ae('<div class="skeleton-card__image skeleton" data-v-ef5d93a6></div><div class="skeleton-card__body" data-v-ef5d93a6><div class="skeleton-card__title skeleton" data-v-ef5d93a6></div><div class="skeleton-card__serial skeleton" data-v-ef5d93a6></div><div class="skeleton-card__price skeleton" data-v-ef5d93a6></div></div>',2)])]))}}),Xe=N(Ye,[["__scopeId","data-v-ef5d93a6"]]),et={class:"balance-pill"},tt={class:"balance-pill__amount"},lt=V({__name:"BalancePill",props:{balance:{}},emits:["add"],setup(i){const n=i,r=x(()=>{const o=n.balance;return o>=1e3?o.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}):Number(o.toFixed(2)).toString()});return(o,d)=>(c(),h("div",et,[d[2]||(d[2]=t("svg",{class:"balance-pill__icon",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},[t("path",{d:"M12.7238 1.00488H3.27565C1.53846 1.00488 0.437395 2.87874 1.31137 4.39358L7.14243 14.5002C7.52294 15.1601 8.47652 15.1601 8.85703 14.5002L14.6893 4.39358C15.5621 2.88116 14.461 1.00488 12.725 1.00488H12.7238ZM7.13769 11.4694L5.86778 9.01168L2.80363 3.53153C2.60149 3.18078 2.85116 2.7313 3.27446 2.7313H7.1365V11.4705L7.13769 11.4694ZM13.1935 3.53035L10.1305 9.01287L8.86059 11.4694V2.73011H12.7226C13.1459 2.73011 13.3956 3.17959 13.1935 3.53035Z",fill:"currentColor"})],-1)),t("span",tt,w(r.value),1),t("button",{class:"balance-pill__add",onClick:d[0]||(d[0]=L(v=>o.$emit("add"),["stop"]))},[...d[1]||(d[1]=[t("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},[t("path",{d:"M7 1v12M1 7h12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)])])]))}}),rt=N(lt,[["__scopeId","data-v-0b0417e6"]]),W="market_prices_cache",J=5*60*1e3;function q(i){return i.length===0?0:Math.min(...i.map(n=>n.price))}function se(i){if(i.length===0)return 0;const n=[...i].sort((o,d)=>o.price-d.price),r=Math.floor(n.length/2);return n.length%2!==0?n[r].price:(n[r-1].price+n[r].price)/2}function ie(i){return i.length===0?null:i.reduce((n,r)=>r.price<n.price?r:n)}class at{cache={};constructor(){this.loadCache()}loadCache(){try{const n=localStorage.getItem(W);n&&(this.cache=JSON.parse(n),this.cleanExpiredCache())}catch(n){console.warn("Failed to load price cache:",n),this.cache={}}}persistCache(){try{localStorage.setItem(W,JSON.stringify(this.cache))}catch(n){console.warn("Failed to persist price cache:",n)}}cleanExpiredCache(){const n=Date.now();for(const[r,o]of Object.entries(this.cache))n-o.timestamp>J&&delete this.cache[r]}clearCache(){this.cache={},localStorage.removeItem(W)}getCachedPrice(n){const r=this.cache[n];return r?Date.now()-r.timestamp>J?(delete this.cache[n],0):q(r.prices):0}setCachedPrice(n,r){this.cache[n]={prices:r,timestamp:Date.now()}}async fetchFromApi(n){try{const r=await fetch(`/api/v1/gifts/${n}`);if(!r.ok)return null;const o=await r.json();return o.min_price_ton&&parseFloat(o.min_price_ton)>0?{source:"api",price:parseFloat(o.min_price_ton),currency:"TON",updatedAt:new Date}:null}catch{return null}}async getAggregatedPrice(n){const r=this.cache[n];if(r&&Date.now()-r.timestamp<J)return r.prices;const d=(await Promise.allSettled([this.fetchFromApi(n)])).filter(v=>v.status==="fulfilled").map(v=>v.value).filter(v=>v!==null&&v.price>0);return d.length>0&&this.setCachedPrice(n,d),d}async getAggregatedGifts(n){const r=new Map,o=10;for(let d=0;d<n.length;d+=o){const v=n.slice(d,d+o);await Promise.all(v.map(async m=>{const b=await this.getAggregatedPrice(m);b.length>0&&r.set(m,{giftId:m,name:"",model:"",prices:b,minPrice:q(b),medianPrice:se(b),bestDeal:ie(b)})}))}return r}}const T=new at;function nt(){const i=_(!1),n=_(null),r=_([]),o=_(new Map);Q(()=>{T.loadCache()});const d=g=>T.getCachedPrice(g),v=async g=>{i.value=!0,n.value=null;try{o.value=await T.getAggregatedGifts(g),T.persistCache()}catch(u){n.value="Failed to load prices",console.error("Preload prices error:",u)}finally{i.value=!1}};return{isLoading:i,error:n,gifts:r,aggregatedData:o,getCachedPrice:d,preloadPrices:v,getGiftPrices:async g=>{try{return await T.getAggregatedPrice(g)}catch(u){return console.error("Get gift prices error:",u),[]}},getBestPrice:g=>{const u=d(g);if(u>0)return u;const p=o.value.get(g);return p?p.minPrice:0},getPriceDisplay:g=>{const u=o.value.get(g);if(u&&u.bestDeal)return{price:u.minPrice.toFixed(2),source:u.bestDeal.source};const p=d(g);return p>0?{price:p.toFixed(2),source:"cached"}:{price:"â€”",source:"unavailable"}},enrichGiftsWithPrices:g=>g.map(u=>{const p=u.id||u.gift_id||"",y=o.value.get(p);let B=0,R=[],z=null,l="api";if(y)B=y.minPrice,R=y.prices,z=y.bestDeal,l=z?.source||"aggregated";else if(u.floor_price)B=typeof u.floor_price=="string"?parseFloat(u.floor_price):u.floor_price,l="api";else{const M=d(p);M>0&&(B=M,l="cached")}return{id:p,name:u.name||"",model:u.model||"",image:u.image,floorPrice:B,prices:R,bestDeal:z,priceSource:l}}),refreshPrices:async g=>{T.clearCache(),await v(g)},getPriceComparison:g=>{const u=o.value.get(g);return!u||u.prices.length===0?null:{min:u.minPrice,median:u.medianPrice,sources:u.prices.map(p=>p.source)}},calculateMinPrice:q,calculateMedianPrice:se,getBestDeal:ie}}const st={class:"market-view"},it={class:"market-header"},ot={class:"market-header__right"},ct={class:"market-tabs"},dt={class:"market-tabs__scroll"},ut=["onClick"],gt={class:"filter-bar"},ht={key:0,class:"filter-bar__chevron",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},pt={key:0,class:"filter-bar__chevron",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},ft={key:0,class:"filter-bar__chevron",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},vt={key:0,class:"active-filters"},mt=["onClick"],kt={class:"sort-menu"},_t=["onClick"],bt={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},yt={class:"gift-grid-wrapper"},wt={key:0,class:"gift-grid"},Ct={key:1,class:"gift-grid"},Pt={key:2,class:"pagination"},xt=["disabled"],Bt={class:"pagination__info"},Mt={class:"pagination__current"},St={class:"pagination__total"},$t=["disabled"],Gt={key:3,class:"empty-state"},Lt={key:0,class:"filter-sheet"},Ft={class:"filter-sheet__header"},Dt={class:"filter-sheet__title"},At={class:"filter-sheet__body"},Et={class:"filter-chips"},Ot=["onClick"],Tt={class:"filter-sheet__footer"},Z=50,zt=V({__name:"MarketView",setup(i){const n=De(),{hapticImpact:r}=ne(),{preloadPrices:o,enrichGiftsWithPrices:d}=nt(),v=[{id:"all",label:"Gifts"},{id:"upgrades",label:"Upgrades"}],m=_("all"),b=_(!0),C=_([]),F=_(""),$=_("listed_at desc"),S=_(!1),g=_(null),u=_(!1),p=_([]),y=_(1),B=_(50),R=_("1.33"),z=_("247.5K"),l=Fe({names:[],models:[],backdrops:[],patterns:[],symbols:[],rarities:[],minPrice:null,maxPrice:null}),M=_([]),oe=x(()=>[...new Set(M.value.map(a=>a.name).filter(Boolean))].sort()),ce=x(()=>[...new Set(M.value.map(a=>a.model).filter(Boolean))].sort()),de=x(()=>[...new Set(M.value.map(a=>a.backdrop).filter(Boolean))].sort()),ue=[{value:"common",label:"Common",color:"#6b7280"},{value:"uncommon",label:"Uncommon",color:"#22c55e"},{value:"rare",label:"Rare",color:"#3b82f6"},{value:"epic",label:"Epic",color:"#a855f7"},{value:"legendary",label:"Legendary",color:"#f59e0b"},{value:"mythic",label:"Mythic",color:"#ef4444"}],Y=x(()=>{const a=[];return l.names.forEach(e=>a.push({key:`name-${e}`,group:"names",value:e,label:e})),l.models.forEach(e=>a.push({key:`model-${e}`,group:"models",value:e,label:`Skin: ${e}`})),l.backdrops.forEach(e=>a.push({key:`backdrop-${e}`,group:"backdrops",value:e,label:`Backdrop: ${e}`})),l.patterns.forEach(e=>a.push({key:`pattern-${e}`,group:"patterns",value:e,label:`Pattern: ${e}`})),l.symbols.forEach(e=>a.push({key:`symbol-${e}`,group:"symbols",value:e,label:`Symbol: ${e}`})),l.rarities.forEach(e=>{const s=ue.find(f=>f.value===e);a.push({key:`rarity-${e}`,group:"rarities",value:e,label:s?.label||e})}),l.minPrice!==null&&a.push({key:"minPrice",group:"minPrice",value:String(l.minPrice),label:`from ${l.minPrice} TON`}),l.maxPrice!==null&&a.push({key:"maxPrice",group:"maxPrice",value:String(l.maxPrice),label:`to ${l.maxPrice} TON`}),a}),ge=x(()=>{switch(g.value){case"type":return"Type";case"model":return"Skin";case"backdrop":return"Backdrop";default:return""}}),he=x(()=>{switch(g.value){case"type":return oe.value;case"model":return ce.value;case"backdrop":return de.value;default:return[]}}),pe=a=>{switch(g.value){case"type":return l.names.includes(a);case"model":return l.models.includes(a);case"backdrop":return l.backdrops.includes(a);default:return!1}},fe=a=>{switch(g.value){case"type":U("names",a);break;case"model":U("models",a);break;case"backdrop":U("backdrops",a);break}},U=(a,e)=>{const s=l[a],f=s.indexOf(e);f>-1?s.splice(f,1):s.push(e)},ve=a=>{if(a.group==="minPrice")l.minPrice=null;else if(a.group==="maxPrice")l.maxPrice=null;else{const e=l[a.group],s=e.indexOf(a.value);s>-1&&e.splice(s,1)}D()},me=()=>{l.names=[],l.models=[],l.backdrops=[],l.patterns=[],l.symbols=[],l.rarities=[],l.minPrice=null,l.maxPrice=null},D=()=>{y.value=1,H()},ke=[{value:"listed_at desc",label:"Newest first"},{value:"listed_at asc",label:"Oldest first"},{value:"price asc",label:"Price: Low to High"},{value:"price desc",label:"Price: High to Low"}],_e=a=>{r("light"),m.value=a,a==="upgrades"&&n.push("/upgrade")},be=a=>{r("light"),$.value=a,S.value=!1,H()},ye=()=>{y.value>1&&(y.value--,H())},we=()=>{y.value<B.value&&(y.value++,H())},H=async()=>{b.value=!0;try{const a=(y.value-1)*Z,e=F.value?.trim();let s;if(e)s=await Ee(e,{limit:Z,collection_id:void 0});else{const k={is_on_sale:!0,sort:$.value,limit:Z,offset:a};l.rarities.length===1&&(k.rarity=l.rarities[0]),l.models.length===1&&(k.model=l.models[0]),l.backdrops.length===1&&(k.backdrop=l.backdrops[0]),l.patterns.length===1&&(k.pattern=l.patterns[0]),l.symbols.length===1&&(k.symbol=l.symbols[0]),l.minPrice!==null&&(k.min_price=l.minPrice),l.maxPrice!==null&&(k.max_price=l.maxPrice),s=await te(k)}let f=s.items||s||[];l.names.length>0&&(f=f.filter(k=>l.names.includes(k.name))),l.rarities.length>1&&(f=f.filter(k=>l.rarities.includes(k.rarity))),l.models.length>1&&(f=f.filter(k=>l.models.includes(k.model))),l.backdrops.length>1&&(f=f.filter(k=>l.backdrops.includes(k.backdrop))),l.patterns.length>1&&(f=f.filter(k=>l.patterns.includes(k.pattern))),l.symbols.length>1&&(f=f.filter(k=>l.symbols.includes(k.symbol))),M.value.length===0&&f.length>0&&(M.value=f),s.total&&(B.value=Math.ceil(s.total/Z));const X=f.map(k=>k.id||k.gift_id).filter(Boolean);X.length>0?(C.value=f,o(X).then(()=>{C.value=d(f)})):C.value=f}catch(a){console.error("Fetch gifts error:",a),C.value=[]}finally{b.value=!1}},Ce=async()=>{try{const a=await te({is_on_sale:!0,limit:500}),e=a.items||a||[];e.length>0&&(M.value=e)}catch{}},Pe=async()=>{try{const a=await Oe();a.volume_24h&&(z.value=xe(a.volume_24h)),a.ton_price&&(R.value=a.ton_price.toFixed(2))}catch{}},xe=a=>a>=1e6?(a/1e6).toFixed(1)+"M":a>=1e3?(a/1e3).toFixed(1)+"K":a.toString(),Be=a=>{r("light"),n.push(`/gift/${a.id}`)},Me=a=>{r("medium")},Se=a=>{r("light");const e=p.value.indexOf(a.id);e>-1?p.value.splice(e,1):p.value.push(a.id)},$e=()=>{r("heavy")};return Q(()=>{H(),Pe(),Ce()}),(a,e)=>(c(),h("div",st,[e[31]||(e[31]=t("div",{class:"online-indicator"},[t("span",{class:"online-dot"}),t("span",{class:"online-text"},"22 online")],-1)),t("div",it,[e[12]||(e[12]=t("div",{class:"market-header__spacer"},null,-1)),e[13]||(e[13]=t("h1",{class:"market-title"},"Market",-1)),t("div",ot,[A(rt,{balance:0,onAdd:()=>{}})])]),t("nav",ct,[t("div",dt,[(c(),h(E,null,O(v,s=>t("button",{key:s.id,class:G(["market-tabs__item",{active:m.value===s.id}]),onClick:f=>_e(s.id)},w(s.label),11,ut)),64))])]),t("div",gt,[t("button",{class:"filter-bar__sort-btn",onClick:e[0]||(e[0]=s=>S.value=!S.value)},[...e[14]||(e[14]=[t("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M3 6h18M6 12h12M9 18h6"})],-1)])]),t("button",{class:G(["filter-bar__dropdown",{"has-value":l.names.length>0}]),onClick:e[2]||(e[2]=s=>g.value=g.value==="type"?null:"type")},[t("span",null,w(l.names.length>0?l.names[0]+(l.names.length>1?` +${l.names.length-1}`:""):"Type"),1),l.names.length===0?(c(),h("svg",ht,[...e[15]||(e[15]=[t("path",{d:"m6 9 6 6 6-6"},null,-1)])])):(c(),h("svg",{key:1,class:"filter-bar__clear",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3",onClick:e[1]||(e[1]=L(s=>{l.names=[],D()},["stop"]))},[...e[16]||(e[16]=[t("path",{d:"M18 6 6 18"},null,-1),t("path",{d:"m6 6 12 12"},null,-1)])]))],2),t("button",{class:G(["filter-bar__dropdown",{"has-value":l.models.length>0}]),onClick:e[4]||(e[4]=s=>g.value=g.value==="model"?null:"model")},[t("span",null,w(l.models.length>0?l.models[0]+(l.models.length>1?` +${l.models.length-1}`:""):"Skin"),1),l.models.length===0?(c(),h("svg",pt,[...e[17]||(e[17]=[t("path",{d:"m6 9 6 6 6-6"},null,-1)])])):(c(),h("svg",{key:1,class:"filter-bar__clear",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3",onClick:e[3]||(e[3]=L(s=>{l.models=[],D()},["stop"]))},[...e[18]||(e[18]=[t("path",{d:"M18 6 6 18"},null,-1),t("path",{d:"m6 6 12 12"},null,-1)])]))],2),t("button",{class:G(["filter-bar__dropdown",{"has-value":l.backdrops.length>0}]),onClick:e[6]||(e[6]=s=>g.value=g.value==="backdrop"?null:"backdrop")},[t("span",null,w(l.backdrops.length>0?l.backdrops[0]+(l.backdrops.length>1?` +${l.backdrops.length-1}`:""):"Backdrop"),1),l.backdrops.length===0?(c(),h("svg",ft,[...e[19]||(e[19]=[t("path",{d:"m6 9 6 6 6-6"},null,-1)])])):(c(),h("svg",{key:1,class:"filter-bar__clear",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3",onClick:e[5]||(e[5]=L(s=>{l.backdrops=[],D()},["stop"]))},[...e[20]||(e[20]=[t("path",{d:"M18 6 6 18"},null,-1),t("path",{d:"m6 6 12 12"},null,-1)])]))],2)]),Y.value.length>0?(c(),h("div",vt,[(c(!0),h(E,null,O(Y.value,s=>(c(),h("button",{key:s.key,class:"active-filter-chip",onClick:f=>ve(s)},[t("span",null,w(s.label),1),e[21]||(e[21]=t("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[t("path",{d:"M18 6 6 18"}),t("path",{d:"m6 6 12 12"})],-1))],8,mt))),128)),t("button",{class:"clear-all-btn",onClick:e[7]||(e[7]=s=>{me(),D()})},"Clear")])):P("",!0),(c(),K(ee,{to:"body"},[A(I,{name:"sort-fade"},{default:j(()=>[S.value?(c(),h("div",{key:0,class:"sort-overlay",onClick:e[8]||(e[8]=L(s=>S.value=!1,["self"]))},[t("div",kt,[e[23]||(e[23]=t("div",{class:"sort-menu__header"},"Sort by",-1)),(c(),h(E,null,O(ke,s=>t("button",{key:s.value,class:G(["sort-menu__option",{active:$.value===s.value}]),onClick:f=>be(s.value)},[t("span",null,w(s.label),1),$.value===s.value?(c(),h("svg",bt,[...e[22]||(e[22]=[t("path",{d:"M20 6 9 17l-5-5"},null,-1)])])):P("",!0)],10,_t)),64))])])):P("",!0)]),_:1})])),t("div",yt,[b.value?(c(),h("div",wt,[(c(),h(E,null,O(12,s=>A(Xe,{key:"skeleton-"+s})),64))])):(c(),h("div",Ct,[(c(!0),h(E,null,O(C.value,s=>(c(),K(qe,{key:s.id,gift:s,selectable:u.value,"is-selected":p.value.includes(s.id),onClick:Be,onBuy:Me,onSelect:Se},null,8,["gift","selectable","is-selected"]))),128))])),!b.value&&B.value>1?(c(),h("div",Pt,[t("button",{class:"pagination__btn",disabled:y.value<=1,onClick:ye},[...e[24]||(e[24]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"m15 18-6-6 6-6"})],-1)])],8,xt),t("span",Bt,[t("span",Mt,w(y.value),1),e[25]||(e[25]=t("span",{class:"pagination__sep"},"/",-1)),t("span",St,w(B.value),1)]),t("button",{class:"pagination__btn",disabled:y.value>=B.value,onClick:we},[...e[26]||(e[26]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"m9 18 6-6-6-6"})],-1)])],8,$t)])):P("",!0),!b.value&&C.value.length===0?(c(),h("div",Gt,[...e[27]||(e[27]=[ae('<div class="empty-state__icon" data-v-7eeb1b4c><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-7eeb1b4c><path d="M21 8v13H3V8" data-v-7eeb1b4c></path><path d="M1 3h22v5H1z" data-v-7eeb1b4c></path><path d="M10 12h4" data-v-7eeb1b4c></path></svg></div><p class="empty-state__text" data-v-7eeb1b4c>No gifts available</p><p class="empty-state__hint" data-v-7eeb1b4c>Try adjusting your filters</p>',3)])])):P("",!0)]),A(I,{name:"fab-pop"},{default:j(()=>[p.value.length>0?(c(),h("button",{key:0,class:"bulk-fab",onClick:$e},[e[28]||(e[28]=t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"}),t("path",{d:"M3 6h18"}),t("path",{d:"M16 10a4 4 0 0 1-8 0"})],-1)),t("span",null,w(p.value.length),1)])):P("",!0)]),_:1}),(c(),K(ee,{to:"body"},[A(I,{name:"filter-overlay"},{default:j(()=>[g.value?(c(),h("div",{key:0,class:"filter-sheet-overlay",onClick:e[11]||(e[11]=L(s=>g.value=null,["self"]))},[A(I,{name:"sheet-slide"},{default:j(()=>[g.value?(c(),h("div",Lt,[e[30]||(e[30]=t("div",{class:"filter-sheet__handle"},null,-1)),t("div",Ft,[t("h3",Dt,w(ge.value),1),t("button",{class:"filter-sheet__close",onClick:e[9]||(e[9]=s=>g.value=null)},[...e[29]||(e[29]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6 6 18"}),t("path",{d:"m6 6 12 12"})],-1)])])]),t("div",At,[t("div",Et,[(c(!0),h(E,null,O(he.value,s=>(c(),h("button",{key:s,class:G(["filter-chip",{active:pe(s)}]),onClick:f=>fe(s)},w(s),11,Ot))),128))])]),t("div",Tt,[t("button",{class:"filter-sheet__done",onClick:e[10]||(e[10]=s=>{g.value=null,D()})}," Done ")])])):P("",!0)]),_:1})])):P("",!0)]),_:1})]))]))}}),Rt=N(zt,[["__scopeId","data-v-7eeb1b4c"]]);export{Rt as default};
