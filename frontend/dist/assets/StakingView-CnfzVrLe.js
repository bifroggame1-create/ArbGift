import{f as E,o,a as i,n as V,h as as,b as s,t as l,d,j as n,F as C,k as S,p as _,v as ls,x as os,i as is,y,m as ns,r as u,c as P,g as rs}from"./vue-DpDB_xhb.js";import{u as ds}from"./useTonConnect-Dk5kDw1P.js";import{i as m}from"./client-Byqmzb3A.js";import{_ as us}from"./ton_symbol-CfLG12-S.js";import{a as B}from"./index-DCUERR7g.js";import"./index-D5GkNzM3.js";const cs=E({__name:"TonIcon",props:{size:{default:14}},setup(x){return(F,k)=>(o(),i("img",{src:us,alt:"TON",class:"ton-icon",style:V({width:x.size+"px",height:x.size+"px"})},null,4))}}),c=B(cs,[["__scopeId","data-v-4f9c7613"]]),ps={class:"staking-view"},vs={class:"apy-hero"},_s={class:"apy-display"},ms={class:"apy-number"},ys={class:"apy-stats-row"},fs={class:"stat-item"},bs={class:"stat-value"},ws={class:"stat-label"},ks={class:"stat-item"},gs={class:"stat-value"},hs={class:"stat-label"},Cs={class:"stat-item"},Ss={class:"stat-value"},Ps={key:0,class:"stakes-section"},xs={class:"section-header"},Rs=["disabled"],As={class:"stakes-grid"},Ts={class:"stake-header"},Fs=["src","alt"],zs={class:"stake-info"},Gs={class:"stake-meta"},Ns={class:"value-badge"},$s={class:"stake-progress"},Es={class:"progress-bar"},Vs={class:"progress-text"},Bs={key:0},Ls={key:1},Ms={class:"stake-rewards"},Os={class:"reward-item"},Us={class:"reward-value earnings-counter"},Is={class:"reward-item"},Ds={class:"reward-value"},Ws=["onClick"],Ys={key:0},Hs={key:1},js={key:1,class:"empty-state"},qs={class:"tiers-section"},Ks={class:"tiers-grid"},Qs=["onClick"],Js={key:0,class:"tier-badge"},Xs={key:1,class:"tier-badge premium-badge"},Zs={class:"tier-title"},se={class:"tier-apr"},ee={class:"tier-days"},te={class:"tier-features"},ae={class:"feature"},le={key:0,class:"feature"},oe={class:"tier-example"},ie={class:"highlight"},ne={class:"available-section"},re={class:"section-header"},de={key:0,class:"connect-wallet-prompt"},ue={key:1,class:"no-gifts"},ce={key:2,class:"gifts-grid"},pe=["onClick"],ve={class:"gift-card"},_e=["src","alt"],me={class:"gift-details"},ye={class:"gift-meta"},fe={class:"value"},be={class:"potential-apr"},we={class:"highlight"},ke={class:"modal-gift-preview"},ge=["src","alt"],he={class:"preview-details"},Ce={class:"value-badge"},Se={class:"period-selector"},Pe={class:"period-options"},xe=["onClick"],Re={class:"period-label"},Ae={class:"period-apr"},Te={key:0,class:"stake-preview"},Fe={class:"preview-row"},ze={class:"preview-row"},Ge={class:"preview-row"},Ne={class:"preview-row highlight"},$e={class:"preview-row highlight"},Ee={class:"big"},Ve={class:"preview-row reward"},Be={class:"preview-row total"},Le={class:"big"},Me={class:"preview-row roi"},Oe={class:"big green"},Ue=["disabled"],Ie=E({__name:"StakingView",setup(x){const F=rs(),{wallet:k,connect:L}=ds(),M=u(600),O=u(125e3),U=u(45e3),I=u(1250),f=u([]),g=u([]),h=u(""),R=u(!1),r=u(null),v=u(""),D=u("1m"),p=u(null),z=P(()=>[{period:"1w",label:"7 Days",days:7,apy:300,bonus:"Flexible unlock",popular:!1,premium:!1,exampleReward:"5.75"},{period:"2w",label:"14 Days",days:14,apy:400,bonus:"+10% early bird",popular:!0,premium:!1,exampleReward:"15.34"},{period:"1m",label:"30 Days",days:30,apy:450,bonus:"+20% boost",popular:!1,premium:!1,exampleReward:"36.99"},{period:"3m",label:"90 Days",days:90,apy:600,bonus:"+50% mega boost",extraBonus:"NFT Badge",popular:!1,premium:!0,exampleReward:"148.77"}]),G=P(()=>!!k.value),W=P(()=>f.value.some(a=>a.is_unlockable)),Y=P(()=>{if(!h.value)return g.value;const a=h.value.toLowerCase();return g.value.filter(e=>e.name.toLowerCase().includes(a)||e.rarity.toLowerCase().includes(a))});async function b(){try{const a=await m.get("/staking/my-stakes");f.value=a.data.stakes||[]}catch(a){console.error("Failed to load stakes:",a)}}async function A(){if(!(!G.value||!k.value))try{const a=await m.get(`/gifts/owned/${k.value.account.address}`);g.value=a.data.gifts||[]}catch(a){console.error("Failed to load gifts:",a)}}function H(a){const w={common:1,uncommon:1.2,rare:1.5,epic:2,legendary:3,mythic:5}[a.rarity?.toLowerCase()]||1;return Math.round(600*w)}async function j(a){r.value=a,v.value="1m",R.value=!0,await q()}async function q(){if(!(!r.value||!v.value))try{const a=await m.get("/staking/preview",{params:{gift_value_ton:r.value.floor_price,period:v.value,rarity:r.value.rarity}});p.value=a.data}catch(a){console.error("Failed to load preview:",a)}}function T(){R.value=!1,r.value=null,v.value="",p.value=null}async function K(){if(!(!r.value||!v.value))try{await m.post("/staking/stake",{gift_address:r.value.address,period:v.value}),alert("‚úÖ Stake created successfully!"),T(),await b(),await A()}catch(a){console.error("Stake failed:",a),alert("‚ùå Failed to create stake")}}async function Q(a){a.is_unlockable?await J(a):await X(a)}async function J(a){try{await m.post(`/staking/claim/${a.id}`),alert(`‚úÖ Claimed ${a.total_at_unlock} TON!`),await b()}catch(e){console.error("Claim failed:",e),alert("‚ùå Failed to claim rewards")}}async function X(a){if(confirm(`‚ö†Ô∏è Early withdrawal penalty: 10% (${a.early_penalty} TON)

Continue?`))try{await m.post(`/staking/withdraw/${a.id}`),alert("Stake withdrawn with penalty"),await b()}catch(t){console.error("Withdrawal failed:",t),alert("Failed to withdraw")}}async function Z(){try{await m.post("/staking/claim-all"),alert("‚úÖ All rewards claimed!"),await b()}catch(a){console.error("Claim all failed:",a)}}async function ss(){await L(),await A()}function es(){F.push("/market")}function ts(){alert("Provably Fair verification coming soon!")}function N(a){return(typeof a=="string"?parseFloat(a):a).toFixed(2)}function $(a){return a>=1e6?`${(a/1e6).toFixed(1)}M`:a>=1e3?`${(a/1e3).toFixed(1)}K`:a.toString()}return as(async()=>{await b(),await A()}),(a,e)=>(o(),i("div",ps,[s("div",vs,[e[6]||(e[6]=s("div",{class:"apy-badge"},"üî• HIGHEST APR",-1)),e[7]||(e[7]=s("h1",{class:"apy-title"},"Stake Telegram Gifts",-1)),s("div",_s,[s("span",ms,l(M.value)+"%",1),e[2]||(e[2]=s("span",{class:"apy-label"},"APR",-1))]),e[8]||(e[8]=s("p",{class:"apy-subtitle"},"Lock your Gifts, earn TON daily",-1)),s("div",ys,[s("div",fs,[s("span",bs,l($(O.value)),1),s("span",ws,[d(c,{size:12}),e[3]||(e[3]=n(" Staked",-1))])]),s("div",ks,[s("span",gs,l($(U.value)),1),s("span",hs,[d(c,{size:12}),e[4]||(e[4]=n(" Paid",-1))])]),s("div",Cs,[s("span",Ss,l(I.value),1),e[5]||(e[5]=s("span",{class:"stat-label"},"Stakers",-1))])])]),f.value.length>0?(o(),i("section",Ps,[s("div",xs,[e[10]||(e[10]=s("h2",null,"Your Stakes",-1)),s("button",{onClick:Z,class:"claim-all-btn",disabled:!W.value},[...e[9]||(e[9]=[s("span",null,"üí∞",-1),s("span",null,"Claim All",-1)])],8,Rs)]),s("div",As,[(o(!0),i(C,null,S(f.value,t=>(o(),i("div",{key:t.id,class:"stake-card"},[s("div",Ts,[s("img",{src:t.gift.image_url,alt:t.gift.name,class:"gift-image"},null,8,Fs),s("div",zs,[s("h3",null,l(t.gift.name),1),s("div",Gs,[s("span",{class:y(["rarity-badge",`rarity-${t.gift.rarity}`])},l(t.gift.rarity),3),s("span",Ns,[n(l(t.gift_value_ton)+" ",1),d(c,{size:10})])])])]),s("div",$s,[s("div",Es,[s("div",{class:"progress-fill",style:V({width:t.progressPercent+"%"})},null,4)]),s("div",Vs,[t.is_unlockable?(o(),i("span",Bs,"‚úÖ Unlocked!")):(o(),i("span",Ls,"‚è≥ "+l(t.days_remaining)+" days left",1))])]),s("div",Ms,[s("div",Os,[e[11]||(e[11]=s("span",{class:"reward-label"},"Earned:",-1)),s("span",Us,[n("+"+l(N(t.earned_rewards))+" ",1),d(c,{size:14})])]),s("div",Is,[e[12]||(e[12]=s("span",{class:"reward-label"},"APR:",-1)),s("span",Ds,l(t.effective_apy)+"%",1)])]),s("button",{onClick:w=>Q(t),class:y(["action-btn",{unlocked:t.is_unlockable}])},[t.is_unlockable?(o(),i("span",Ys,[n("Claim "+l(N(t.total_at_unlock))+" ",1),d(c,{size:14})])):(o(),i("span",Hs,"Unlock Early (-10% penalty)"))],10,Ws)]))),128))])])):_("",!0),f.value.length===0?(o(),i("div",js,[...e[13]||(e[13]=[s("div",{class:"empty-icon"},"üéÅ",-1),s("h3",null,"No active stakes",-1),s("p",null,"Start staking your Gifts to earn up to 600% APR!",-1)])])):_("",!0),s("section",qs,[e[18]||(e[18]=s("h2",null,"Choose Your Lock Period",-1)),s("div",Ks,[(o(!0),i(C,null,S(z.value,t=>(o(),i("div",{key:t.period,class:y(["tier-card",{popular:t.popular,premium:t.premium}]),onClick:w=>D.value=t.period},[t.popular?(o(),i("div",Js,"POPULAR")):_("",!0),t.premium?(o(),i("div",Xs,"BEST VALUE")):_("",!0),s("h3",Zs,l(t.label),1),s("div",se,[n(l(t.apy)+"% ",1),e[14]||(e[14]=s("span",null,"APR",-1))]),s("div",ee,l(t.days)+" days lock",1),s("div",te,[s("div",ae,"‚úÖ "+l(t.bonus),1),t.extraBonus?(o(),i("div",le,"‚ú® "+l(t.extraBonus),1)):_("",!0)]),s("div",oe,[s("span",null,[e[15]||(e[15]=n("100 ",-1)),d(c,{size:10}),e[16]||(e[16]=n(" stake ‚Üí",-1))]),s("span",ie,[n(l(t.exampleReward)+" ",1),d(c,{size:10}),e[17]||(e[17]=n(" profit",-1))])])],10,Qs))),128))])]),s("section",ne,[s("div",re,[e[19]||(e[19]=s("h2",null,"Your Gifts",-1)),ls(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>h.value=t),type:"text",placeholder:"Search gifts...",class:"search-input"},null,512),[[os,h.value]])]),G.value?g.value.length===0?(o(),i("div",ue,[e[23]||(e[23]=s("div",{class:"no-gifts-icon"},"üò¢",-1)),e[24]||(e[24]=s("p",null,"You don't have any Gifts to stake",-1)),s("button",{onClick:es,class:"browse-btn"},"Browse Marketplace")])):(o(),i("div",ce,[(o(!0),i(C,null,S(Y.value,t=>(o(),i("div",{key:t.address,class:"gift-card-wrapper",onClick:w=>j(t)},[s("div",ve,[s("img",{src:t.image_url,alt:t.name},null,8,_e),s("div",me,[s("h4",null,l(t.name),1),s("div",ye,[s("span",{class:y(["rarity",`rarity-${t.rarity}`])},l(t.rarity),3),s("span",fe,[n(l(t.floor_price)+" ",1),d(c,{size:10})])]),s("div",be,[e[25]||(e[25]=n(" Earn up to ",-1)),s("span",we,l(H(t))+"%",1),e[26]||(e[26]=n(" APR ",-1))])])])],8,pe))),128))])):(o(),i("div",de,[e[20]||(e[20]=s("div",{class:"prompt-icon"},"üîó",-1)),e[21]||(e[21]=s("h3",null,"Connect Wallet",-1)),e[22]||(e[22]=s("p",null,"Connect your TON wallet to see your Gifts",-1)),s("button",{onClick:ss,class:"connect-btn"},"Connect TON Wallet")]))]),e[43]||(e[43]=is('<section class="how-it-works" data-v-bb36d6e4><h2 data-v-bb36d6e4>How It Works</h2><div class="steps-grid" data-v-bb36d6e4><div class="step" data-v-bb36d6e4><div class="step-number" data-v-bb36d6e4>1</div><h3 data-v-bb36d6e4>Select Gift</h3><p data-v-bb36d6e4>Choose a Gift from your inventory</p></div><div class="step" data-v-bb36d6e4><div class="step-number" data-v-bb36d6e4>2</div><h3 data-v-bb36d6e4>Choose Period</h3><p data-v-bb36d6e4>Pick lock period: 7, 14, 30, or 90 days</p></div><div class="step" data-v-bb36d6e4><div class="step-number" data-v-bb36d6e4>3</div><h3 data-v-bb36d6e4>Earn Rewards</h3><p data-v-bb36d6e4>Get daily TON rewards automatically</p></div><div class="step" data-v-bb36d6e4><div class="step-number" data-v-bb36d6e4>4</div><h3 data-v-bb36d6e4>Claim</h3><p data-v-bb36d6e4>Unlock after period + claim your profit</p></div></div></section>',1)),s("section",{class:"provably-fair"},[e[27]||(e[27]=s("div",{class:"fair-icon"},"üîê",-1)),e[28]||(e[28]=s("h3",null,"Provably Fair Rewards",-1)),e[29]||(e[29]=s("p",null,"All staking rewards are calculated transparently on-chain. Verify anytime.",-1)),s("button",{onClick:ts,class:"verify-btn"},"Verify Fairness")]),R.value?(o(),i("div",{key:2,class:"modal-overlay",onClick:T},[s("div",{class:"modal-content",onClick:e[1]||(e[1]=ns(()=>{},["stop"]))},[s("button",{class:"modal-close",onClick:T},"‚úï"),s("h2",null,"Stake "+l(r.value?.name),1),s("div",ke,[s("img",{src:r.value?.image_url,alt:r.value?.name},null,8,ge),s("div",he,[s("span",{class:y(["rarity-badge",`rarity-${r.value?.rarity}`])},l(r.value?.rarity),3),s("span",Ce,[n(l(r.value?.floor_price)+" ",1),d(c,{size:10})])])]),s("div",Se,[e[30]||(e[30]=s("h3",null,"Select Lock Period",-1)),s("div",Pe,[(o(!0),i(C,null,S(z.value,t=>(o(),i("button",{key:t.period,class:y(["period-option",{selected:v.value===t.period}]),onClick:w=>v.value=t.period},[s("div",Re,l(t.label),1),s("div",Ae,l(t.apy)+"% APR",1)],10,xe))),128))])]),p.value?(o(),i("div",Te,[e[39]||(e[39]=s("h3",null,"Stake Preview",-1)),s("div",Fe,[e[31]||(e[31]=s("span",null,"Gift Value:",-1)),s("span",null,[n(l(p.value.gift_value_ton)+" ",1),d(c,{size:12})])]),s("div",ze,[e[32]||(e[32]=s("span",null,"Lock Period:",-1)),s("span",null,l(p.value.period_days)+" days",1)]),s("div",Ge,[e[33]||(e[33]=s("span",null,"Base APR:",-1)),s("span",null,l(p.value.base_apy_percent)+"%",1)]),s("div",Ne,[e[34]||(e[34]=s("span",null,"Rarity Bonus:",-1)),s("span",null,"√ó"+l(p.value.rarity_multiplier),1)]),s("div",$e,[e[35]||(e[35]=s("span",null,"Effective APR:",-1)),s("span",Ee,l(p.value.effective_apy_percent)+"%",1)]),e[40]||(e[40]=s("div",{class:"preview-divider"},null,-1)),s("div",Ve,[e[36]||(e[36]=s("span",null,"Expected Reward:",-1)),s("span",null,[n("+"+l(p.value.expected_reward_ton)+" ",1),d(c,{size:14})])]),s("div",Be,[e[37]||(e[37]=s("span",null,"Total at Unlock:",-1)),s("span",Le,[n(l(p.value.total_at_unlock_ton)+" ",1),d(c,{size:16})])]),s("div",Me,[e[38]||(e[38]=s("span",null,"ROI:",-1)),s("span",Oe,"+"+l(p.value.roi_percent)+"%",1)])])):_("",!0),s("button",{onClick:K,class:"confirm-stake-btn",disabled:!v.value},[...e[41]||(e[41]=[s("span",null,"üîí",-1),s("span",null,"Confirm Stake",-1)])],8,Ue),e[42]||(e[42]=s("div",{class:"modal-warning"}," ‚ö†Ô∏è Early withdrawal penalty: 10% of Gift value ",-1))])])):_("",!0)]))}}),Ke=B(Ie,[["__scopeId","data-v-bb36d6e4"]]);export{Ke as default};
