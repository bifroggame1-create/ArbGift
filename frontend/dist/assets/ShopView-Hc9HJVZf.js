import{d as A,o as E,b as a,e as s,F as _,v as m,t as i,k as d,f as $,n as g,j as P,A as z,E as k,B as D,r,a as n}from"./vue-CF-r4DcL.js";import{a as Z,_ as I}from"./index-BrllXF1s.js";import{g as R,c as j}from"./client-COG1KRRB.js";const K={class:"shop-view"},q={class:"stars-bg"},J={class:"shop-header"},Q={class:"header-balance"},U={class:"balance-value"},W={class:"shop-tabs"},X=["onClick"],Y={class:"tab-icon"},ss={class:"tab-label"},es={key:0,class:"featured-banner"},ts={key:1,class:"gifts-section"},ns={class:"section-header"},as={class:"header-actions"},is=["disabled"],ls={key:0,class:"loading-state"},os={key:1,class:"error-state"},rs={key:2,class:"gifts-grid"},cs=["onClick"],ds=["src","alt"],us={key:0,class:"discount-badge"},vs={class:"gift-info"},ps={class:"gift-name"},hs={class:"gift-price-row"},_s={class:"gift-price"},ms={key:0,class:"original-price"},gs={key:0,class:"listings-badge"},ks={key:2,class:"lootpacks-section"},fs={class:"lootpacks-grid"},bs=["onClick"],ys={class:"pack-icon"},ws={class:"pack-info"},Cs={class:"pack-name"},Ms={class:"pack-contains"},xs={class:"pack-price"},$s={class:"price-value"},Ls={class:"pack-chance"},Bs={class:"purchase-modal"},Gs={class:"modal-header"},Ts={class:"modal-gift-preview"},Fs=["src","alt"],Ns={class:"preview-info"},Vs={class:"preview-name"},Hs={class:"listings-section"},Os={class:"listings-header"},Ss={class:"listings-count"},As={key:0,class:"listings-loading"},Es={key:1,class:"no-listings"},Ps={key:2,class:"listings-list"},zs=["onClick"],Ds={class:"listing-market"},Zs={key:0,class:"best-price-badge"},Is={class:"listing-price"},Rs={class:"price-ton"},js=A({__name:"ShopView",setup(Ks){const{init:L}=Z(),B=r(0),v=r("gifts"),u=r(!1),c=r(null),o=r([]),p=r(!1),b=r(!1),f=r(null),G=[{id:"gifts",label:"Ð“Ð¸Ñ„Ñ‚Ñ‹",icon:"ðŸŽ"},{id:"lootpacks",label:"Ð›ÑƒÑ‚Ð¿Ð°ÐºÐ¸",icon:"ðŸ“¦"}],w=r([]),y={getgems:{name:"GetGems",color:"#00a2ff"},tonnel:{name:"Tonnel",color:"#8b5cf6"},mrkt:{name:"MRKT",color:"#22c55e"},fragment:{name:"Fragment",color:"#f59e0b"}},T=l=>l>=10?"legendary":l>=3?"epic":l>=.5?"rare":"common",C=async()=>{p.value=!0,f.value=null;try{const l=await R({is_on_sale:!0,sort:"price_asc",limit:50});w.value=(l.items||l).map(e=>{const t=e.min_price_ton?parseFloat(e.min_price_ton):e.price||0;return{id:e.id,address:e.address,name:e.name,image:e.image_url||"/gifts/default.webp",price:t,rarity:e.rarity||T(t),bgGradient:`linear-gradient(135deg, ${e.backdrop||"#1a1a2e"}, #16213e)`,listingsCount:e.listings_count||0,bestMarket:void 0}})}catch(l){f.value=l.message||"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð³Ð¸Ñ„Ñ‚Ñ‹",console.error("Gifts fetch error:",l)}finally{p.value=!1}},F=async l=>{b.value=!0;try{const e=await j(l);o.value=e||[]}catch(e){console.error("Listings fetch error:",e),o.value=[]}finally{b.value=!1}};E(async()=>{await L(),C()});const N=r([{id:1,name:"Ð¡Ñ‚Ð°Ñ€Ñ‚Ð¾Ð²Ñ‹Ð¹",icon:"ðŸ“¦",contains:3,price:.5,maxMultiplier:5,gradient:"linear-gradient(135deg, #1e3a8a, #3b82f6)"},{id:2,name:"ÐŸÑ€Ð¾",icon:"ðŸ’Ž",contains:5,price:2,maxMultiplier:10,gradient:"linear-gradient(135deg, #7c3aed, #a855f7)"},{id:3,name:"Ð­Ð»Ð¸Ñ‚Ð½Ñ‹Ð¹",icon:"ðŸ‘‘",contains:10,price:5,maxMultiplier:50,gradient:"linear-gradient(135deg, #d97706, #f59e0b)"}]),V=l=>({left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,width:`${Math.random()*2+1}px`,height:`${Math.random()*2+1}px`,animationDelay:`${Math.random()*3}s`,animationDuration:`${Math.random()*2+2}s`}),H=async l=>{c.value=l,o.value=[],u.value=!0,await F(l.id)},O=l=>{},M=l=>{window.open(l.listing_url,"_blank")},S=()=>{if(c.value){if(o.value.length>0){const l=o.value.reduce((e,t)=>parseFloat(e.price_ton)<parseFloat(t.price_ton)?e:t);M(l)}u.value=!1}},x=()=>{C()};return(l,e)=>(n(),a("div",K,[s("div",q,[(n(),a(_,null,m(20,t=>s("div",{key:t,class:"star",style:k(V())},null,4)),64))]),s("header",J,[e[5]||(e[5]=s("div",{class:"header-title"},[s("h1",null,"ÐœÐ°Ð³Ð°Ð·Ð¸Ð½"),s("span",{class:"shop-subtitle"},"Ð“Ð¸Ñ„Ñ‚Ñ‹ Ð¸ Ð»ÑƒÑ‚Ð±Ð¾ÐºÑÑ‹")],-1)),s("div",Q,[e[4]||(e[4]=s("svg",{class:"balance-icon-svg",width:"14",height:"14",viewBox:"0 0 56 56",fill:"none"},[s("circle",{cx:"28",cy:"28",r:"28",fill:"#0098EA"}),s("path",{d:"M37.5603 15.6277H18.4386C14.9228 15.6277 12.6944 19.4202 14.4632 22.4861L26.2644 42.9409C27.0345 44.2765 28.9644 44.2765 29.7345 42.9409L41.5765 22.4861C43.3045 19.4202 41.0761 15.6277 37.5603 15.6277Z",fill:"white"})],-1)),s("span",U,i(B.value.toFixed(2)),1),s("button",{class:"balance-add",onClick:e[0]||(e[0]=t=>l.$router.push("/topup"))},"+")])]),s("div",W,[(n(),a(_,null,m(G,t=>s("button",{key:t.id,class:g(["tab-btn",{active:v.value===t.id}]),onClick:h=>v.value=t.id},[s("span",Y,i(t.icon),1),s("span",ss,i(t.label),1)],10,X)),64))]),v.value==="gifts"?(n(),a("div",es,[...e[6]||(e[6]=[s("div",{class:"banner-content"},[s("span",{class:"banner-badge"},"ðŸ”¥ HOT"),s("h3",null,"ÐÐ¾Ð²Ð°Ñ ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ñ"),s("p",null,"Ð­ÐºÑÐºÐ»ÑŽÐ·Ð¸Ð²Ð½Ñ‹Ðµ Ð³Ð¸Ñ„Ñ‚Ñ‹ Valentine's")],-1),s("div",{class:"banner-gift"},"ðŸŽ",-1)])])):d("",!0),v.value==="gifts"?(n(),a("div",ts,[s("div",ns,[e[9]||(e[9]=s("h2",{class:"section-title-with-icon"},[s("svg",{width:"16",height:"16",viewBox:"0 0 56 56",fill:"none"},[s("circle",{cx:"28",cy:"28",r:"28",fill:"#0098EA"}),s("path",{d:"M37.5603 15.6277H18.4386C14.9228 15.6277 12.6944 19.4202 14.4632 22.4861L26.2644 42.9409C27.0345 44.2765 28.9644 44.2765 29.7345 42.9409L41.5765 22.4861C43.3045 19.4202 41.0761 15.6277 37.5603 15.6277Z",fill:"white"})]),$(" TON Ð“Ð¸Ñ„Ñ‚Ñ‹ ")],-1)),s("div",as,[s("button",{class:"refresh-btn",onClick:x,disabled:p.value},[(n(),a("svg",{class:g({rotating:p.value}),width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[...e[7]||(e[7]=[s("path",{d:"M23 4v6h-6M1 20v-6h6"},null,-1),s("path",{d:"M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"},null,-1)])],2))],8,is),e[8]||(e[8]=s("button",{class:"filter-btn"},[s("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M22 3H2l8 9.46V19l4 2v-8.54L22 3z"})])],-1))])]),p.value?(n(),a("div",ls,[...e[10]||(e[10]=[s("div",{class:"loading-spinner"},null,-1),s("span",null,"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð³Ð¸Ñ„Ñ‚Ð¾Ð²...",-1)])])):f.value?(n(),a("div",os,[e[11]||(e[11]=s("span",{class:"error-icon"},"âš ï¸",-1)),s("span",null,i(f.value),1),s("button",{class:"btn-retry",onClick:x},"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ")])):(n(),a("div",rs,[(n(!0),a(_,null,m(w.value,t=>(n(),a("div",{key:t.id,class:"gift-card",onClick:h=>H(t)},[s("div",{class:"gift-image",style:k({background:t.bgGradient})},[s("img",{src:t.image,alt:t.name},null,8,ds),t.discount?(n(),a("div",us,"-"+i(t.discount)+"%",1)):d("",!0)],4),s("div",vs,[s("span",ps,i(t.name),1),s("div",hs,[s("span",_s,[e[12]||(e[12]=s("svg",{class:"price-icon-svg",width:"10",height:"10",viewBox:"0 0 56 56",fill:"none"},[s("circle",{cx:"28",cy:"28",r:"28",fill:"#0098EA"}),s("path",{d:"M37.5603 15.6277H18.4386C14.9228 15.6277 12.6944 19.4202 14.4632 22.4861L26.2644 42.9409C27.0345 44.2765 28.9644 44.2765 29.7345 42.9409L41.5765 22.4861C43.3045 19.4202 41.0761 15.6277 37.5603 15.6277Z",fill:"white"})],-1)),$(" "+i(t.price)+" TON ",1)]),t.originalPrice?(n(),a("span",ms,i(t.originalPrice),1)):d("",!0)])]),s("div",{class:g(["gift-rarity",t.rarity])},i(t.rarity),3),t.listingsCount>1?(n(),a("div",gs,i(t.listingsCount)+" Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¹ ",1)):d("",!0)],8,cs))),128))]))])):d("",!0),v.value==="lootpacks"?(n(),a("div",ks,[e[15]||(e[15]=s("div",{class:"section-header"},[s("h2",null,"ðŸ“¦ Ð›ÑƒÑ‚Ð¿Ð°ÐºÐ¸")],-1)),s("div",fs,[(n(!0),a(_,null,m(N.value,t=>(n(),a("div",{key:t.id,class:"lootpack-card",style:k({background:t.gradient}),onClick:h=>O()},[e[14]||(e[14]=s("div",{class:"pack-glow"},null,-1)),s("div",ys,i(t.icon),1),s("div",ws,[s("span",Cs,i(t.name),1),s("span",Ms,i(t.contains)+" Ð³Ð¸Ñ„Ñ‚Ð¾Ð²",1)]),s("div",xs,[s("span",$s,i(t.price),1),e[13]||(e[13]=s("span",{class:"price-currency"},"TON",-1))]),s("div",Ls,[s("span",null,"Ð¨Ð°Ð½Ñ x"+i(t.maxMultiplier),1)])],12,bs))),128))])])):d("",!0),(n(),P(D,{to:"body"},[u.value?(n(),a("div",{key:0,class:"modal-overlay",onClick:e[3]||(e[3]=z(t=>u.value=!1,["self"]))},[s("div",Bs,[e[20]||(e[20]=s("div",{class:"modal-handle"},null,-1)),s("div",Gs,[s("h3",null,"ÐšÑƒÐ¿Ð¸Ñ‚ÑŒ "+i(c.value?.name),1),s("button",{class:"modal-close",onClick:e[1]||(e[1]=t=>u.value=!1)},"Ã—")]),s("div",Ts,[s("div",{class:"preview-image",style:k({background:c.value?.bgGradient})},[s("img",{src:c.value?.image,alt:c.value?.name},null,8,Fs)],4),s("div",Ns,[s("span",Vs,i(c.value?.name),1),s("span",{class:g(["preview-rarity",c.value?.rarity])},i(c.value?.rarity),3)])]),s("div",Hs,[s("div",Os,[e[16]||(e[16]=s("span",{class:"listings-title"},"ÐŸÑ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð½Ð° Ð¼Ð°Ñ€ÐºÐµÑ‚Ð°Ñ…",-1)),s("span",Ss,i(o.value.length)+" Ð»Ð¸ÑÑ‚Ð¸Ð½Ð³Ð¾Ð²",1)]),b.value?(n(),a("div",As,[...e[17]||(e[17]=[s("div",{class:"mini-spinner"},null,-1),s("span",null,"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¹...",-1)])])):o.value.length===0?(n(),a("div",Es,[...e[18]||(e[18]=[s("span",null,"ÐÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ð»Ð¸ÑÑ‚Ð¸Ð½Ð³Ð¾Ð²",-1)])])):(n(),a("div",Ps,[(n(!0),a(_,null,m(o.value,(t,h)=>(n(),a("div",{key:t.id,class:g(["listing-item",{best:h===0}]),onClick:qs=>M(t)},[s("div",Ds,[s("span",{class:"market-badge",style:k({background:y[t.market_slug]?.color||"#6b7280"})},i(y[t.market_slug]?.name||t.market_name),5),h===0?(n(),a("span",Zs,"Ð›ÑƒÑ‡ÑˆÐ°Ñ Ñ†ÐµÐ½Ð°")):d("",!0)]),s("div",Is,[s("span",Rs,i(t.price_ton)+" TON",1),e[19]||(e[19]=s("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"}),s("polyline",{points:"15 3 21 3 21 9"}),s("line",{x1:"10",y1:"14",x2:"21",y2:"3"})],-1))])],10,zs))),128))]))]),o.value.length>0?(n(),a("button",{key:0,class:"btn-confirm-purchase",onClick:S}," ÐšÑƒÐ¿Ð¸Ñ‚ÑŒ Ð·Ð° "+i(o.value[0]?.price_ton)+" TON Ð½Ð° "+i(y[o.value[0]?.market_slug]?.name||o.value[0]?.market_name),1)):d("",!0),s("button",{class:"btn-cancel",onClick:e[2]||(e[2]=t=>u.value=!1)}," Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ ")])])):d("",!0)]))]))}}),Ws=I(js,[["__scopeId","data-v-4c102d6e"]]);export{Ws as default};
