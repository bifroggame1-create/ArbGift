import{l as Ht}from"./client-pJ2CWAUX.js";import{d as Yt,j as Xt,y as qt,c as O,b as d,t as D,n as ut,k as Vt,z as yt,F as $t,f as Ut,r as N,l as Wt,o as H}from"./vue-Dr6T3rTv.js";import{a as zt}from"./index-6vjp85YO.js";const jt={class:"ball-escape-view"},Kt={class:"game-header"},Zt={class:"game-id"},Jt={class:"label"},Qt={class:"balance-badge"},te={class:"arena-container"},ee={key:0,class:"result-text won"},ae={key:1,class:"result-text lost"},le={class:"hash-row"},oe={class:"hash-value"},ne={class:"bet-row"},se=["onClick","disabled"],ie={class:"action-row"},re=["disabled"],ce={key:0},de={key:1},he={key:2},g=340,At=460,h=120,M=12,gt=.45,ue=.22,It=.5,ge=.6,Rt=.988,fe=.012,pe=.025,ft=7,nt=16,Y=170,Z=150,S=360,x=80,J=.016,me=5,ve=.55,Pt=.6,be=.35,Et=.992,Me=Yt({__name:"BallEscapeView",setup(Se){const pt=N(null),$=N(10),xt=[.5,1,3,5,10],I=N(1),n=N("idle"),F=N(1),mt=N(Math.floor(Math.random()*9e5)+1e5),st=N("---");let R=null,X=0,L=0,Q=0,o=0,s=0,e=0,a=0,f=[],P=0,it=0,tt=null,et=0,vt=.02;const bt=[{main:"#fbbf24",glow:"rgba(251, 191, 36, ",light:"#fde68a"},{main:"#22d3ee",glow:"rgba(34, 211, 238, ",light:"#67e8f9"},{main:"#a855f7",glow:"rgba(168, 85, 247, ",light:"#c084fc"},{main:"#4ade80",glow:"rgba(74, 222, 128, ",light:"#86efac"},{main:"#f97316",glow:"rgba(249, 115, 22, ",light:"#fdba74"}],Mt={main:"#ec4899",glow:"rgba(236, 72, 153, ",light:"#f9a8d4"};let rt=Mt,St=0,ct=5e3,at=!1,U=1,C=!1,q=null,lt=0;const Ft=Wt(()=>n.value==="won"?"#4ade80":n.value==="lost"?"#ef4444":F.value>=2?"#4ade80":"#22d3ee");function Lt(c){n.value==="idle"&&(I.value=c)}async function Tt(){if(n.value==="playing"||$.value<I.value)return;Ct(),rt=bt[Math.floor(Math.random()*bt.length)],$.value-=I.value,n.value="playing",F.value=1,mt.value=Math.floor(Math.random()*9e5)+1e5;const c=-Math.PI/2+(Math.random()-.5)*1.2,t=30+Math.random()*40;o=Math.cos(c)*t,s=Math.sin(c)*t;const l=Math.random()*Math.PI*2,i=4+Math.random()*3;e=Math.cos(l)*i,a=Math.sin(l)*i+2,X=0,L=J,Q=Math.random()*Math.PI*2,f=[],P=0,C=!1,q=null,lt=0;try{const v=await Ht({amount:I.value,client_seed:Math.random().toString(36).substring(2,10),nonce:Date.now(),user_id:"user"});at=v.escaped,ct=v.duration_ms,U=v.multiplier,st.value=v.server_seed_hash.slice(0,6)+"..."+v.server_seed_hash.slice(-4)}catch{at=Math.random()<.4,ct=4e3+Math.random()*3e3,U=1.5+Math.random()*3.5,st.value=Math.random().toString(36).slice(2,8)+"..."}St=Date.now(),R=requestAnimationFrame(ot)}function ot(){const c=Date.now()-St,t=Math.min(c/ct,1);F.value=1+(U-1)*t,L=J,X+=J;const l=Q+X;if(C){if(a+=be,e*=Et,a*=Et,lt===0){const p=Y+o,m=((at?g*.25:g*.75)-p)*.004;e+=m}o+=e,s+=a;const u=Y+o;if(Z+s>=S-M&&(s=S-M-Z,a=-Math.abs(a)*ve,e*=.85,lt++,q=u<g/2?"green":"red",lt>=me||Math.abs(a)<1.2)){a=0,e=0,Gt(q==="green");return}if(u<=M&&(o=M-Y,e=Math.abs(e)*Pt),u>=g-M&&(o=g-M-Y,e=-Math.abs(e)*Pt),Math.sqrt(o*o+s*s)<h+M+5&&s<0){const p=Math.atan2(s,o),r=h+M+6;o=Math.cos(p)*r,s=Math.sin(p)*r;const m=Math.cos(p),G=Math.sin(p),E=e*m+a*G;E<0&&(e-=2*E*m*.5,a-=2*E*G*.5)}f.unshift({x:Y+o,y:Z+s}),f.length>nt&&f.pop(),W(),R=requestAnimationFrame(ot);return}const i=Math.sqrt(o*o+s*s);if(i>1){const u=L*L,T=fe*u*i;e+=o/i*T,a+=s/i*T}const v=pe*L;e+=-a*v,a+=e*v,a+=ue,e*=Rt,a*=Rt;const w=Math.sqrt(e*e+a*a);w>ft&&(e=e/w*ft,a=a/w*ft),o+=e,s+=a,f.unshift({x:o,y:s}),f.length>nt&&f.pop(),P*=.88;const _=h-M,z=Math.sqrt(o*o+s*s);if(z>_){const u=Math.atan2(s,o);if(Math.abs(kt(u-l))<gt/2&&z>_-5){C=!0,f=[],e=Math.cos(u)*6,a=Math.sin(u)*5+3,W(),R=requestAnimationFrame(ot);return}o=Math.cos(u)*_,s=Math.sin(u)*_;const p=Math.cos(u),r=Math.sin(u),m=e*p+a*r;if(m>0){e-=2*m*p,a-=2*m*r,e*=It,a*=It;const G=ge+Math.abs(m)*.3;e-=p*G,a-=r*G;const E=-r,y=p,k=L*h*.5;e+=E*k,a+=y*k;const A=(Math.random()-.5)*2.5;e+=E*A,a+=y*A,P=1,it=u}}if(t>=1&&!C){C=!0,f=[];const u=at?-60:60;o=0,s=h,e=u/25,a=2}W(),R=requestAnimationFrame(ot)}function Gt(c){R&&cancelAnimationFrame(R),F.value=U,c?(n.value="won",$.value+=I.value*U):n.value="lost",W(),setTimeout(()=>{n.value="idle",F.value=1,q=null,_t()},2500)}function kt(c){for(;c>Math.PI;)c-=Math.PI*2;for(;c<-Math.PI;)c+=Math.PI*2;return c}function W(){const c=pt.value;if(!c)return;const t=c.getContext("2d");if(!t)return;const l=Y,i=Z;t.fillStyle="#0a0c14",t.fillRect(0,0,g,At);const v=S+x/2,w=t.createLinearGradient(0,S-60,0,S+x);w.addColorStop(0,"rgba(34, 197, 94, 0)"),w.addColorStop(.3,"rgba(34, 197, 94, 0.08)"),w.addColorStop(.6,"rgba(34, 197, 94, 0.25)"),w.addColorStop(1,"rgba(34, 197, 94, 0.5)"),t.fillStyle=w,t.fillRect(0,S-60,g/2,x+60);const _=t.createLinearGradient(0,S-60,0,S+x);_.addColorStop(0,"rgba(239, 68, 68, 0)"),_.addColorStop(.3,"rgba(239, 68, 68, 0.08)"),_.addColorStop(.6,"rgba(239, 68, 68, 0.25)"),_.addColorStop(1,"rgba(239, 68, 68, 0.5)"),t.fillStyle=_,t.fillRect(g/2,S-60,g/2,x+60),t.fillStyle="rgba(34, 197, 94, 0.6)",t.fillRect(0,S+10,g/2,x-10),t.fillStyle="rgba(239, 68, 68, 0.6)",t.fillRect(g/2,S+10,g/2,x-10),t.save(),t.shadowColor="rgba(255, 255, 255, 0.5)",t.shadowBlur=8,t.strokeStyle="rgba(255, 255, 255, 0.6)",t.lineWidth=2,t.beginPath(),t.moveTo(g/2,S-30),t.lineTo(g/2,S+x),t.stroke(),t.restore(),t.font="28px -apple-system, sans-serif",t.textAlign="center",t.textBaseline="middle";const z=g/4,u=q==="green";t.globalAlpha=u?1:.7,t.fillText("ðŸ‘‘",z-18,v+8),t.fillText("ðŸ’Ž",z+18,v+8),t.globalAlpha=1;const T=g*3/4,dt=q==="red";t.globalAlpha=dt?1:.7,t.fillText("ðŸ’€",T-18,v+8),t.fillText("â˜ ï¸",T+18,v+8),t.globalAlpha=1;const p=Q+X,r=rt,m=t.createRadialGradient(l,i,h-20,l,i,h+15);m.addColorStop(0,r.glow+"0.0)"),m.addColorStop(.6,r.glow+"0.12)"),m.addColorStop(1,r.glow+"0.0)"),t.fillStyle=m,t.beginPath(),t.arc(l,i,h+15,0,Math.PI*2),t.fill();const G=p-gt/2,E=p+gt/2;t.save(),t.lineWidth=10,t.lineCap="round";const y=t.createLinearGradient(l-h,i-h,l+h,i+h);if(y.addColorStop(0,r.main),y.addColorStop(.3,r.light),y.addColorStop(.5,r.main),y.addColorStop(.8,r.main),y.addColorStop(1,r.light),t.strokeStyle=y,t.shadowColor=r.glow+"0.5)",t.shadowBlur=12,t.beginPath(),t.arc(l,i,h,E,G+Math.PI*2),t.stroke(),t.restore(),P>.05&&n.value==="playing"&&!C){const j=l+Math.cos(it)*h,K=i+Math.sin(it)*h,b=t.createRadialGradient(j,K,0,j,K,30*P);b.addColorStop(0,r.glow+`${P*.8})`),b.addColorStop(.5,r.glow+`${P*.4})`),b.addColorStop(1,r.glow+"0)"),t.fillStyle=b,t.beginPath(),t.arc(j,K,30*P,0,Math.PI*2),t.fill()}const k=t.createRadialGradient(l-30,i-30,0,l,i,h);if(k.addColorStop(0,r.glow+"0.05)"),k.addColorStop(.5,r.glow+"0.02)"),k.addColorStop(1,"rgba(0, 0, 0, 0)"),t.fillStyle=k,t.beginPath(),t.arc(l,i,h-10,0,Math.PI*2),t.fill(),f.length>1&&n.value==="playing"){const j=Math.sqrt(e*e+a*a),K=Math.min(j/8,1);for(let b=1;b<f.length;b++){const Bt=(1-b/nt)*(.3+K*.5),Ot=M*(1-b/nt*.7);t.fillStyle=`rgba(34, 211, 238, ${Bt})`,t.beginPath();const Dt=C?f[b].x:l+f[b].x,Nt=C?f[b].y:i+f[b].y;t.arc(Dt,Nt,Ot,0,Math.PI*2),t.fill()}}let A,V;C?(A=Y+o,V=Z+s):(A=l+o,V=i+s);const wt=Math.sqrt(e*e+a*a),ht=Math.min(.4+wt/10,1);t.shadowColor=n.value==="won"?`rgba(74, 222, 128, ${ht})`:n.value==="lost"?`rgba(239, 68, 68, ${ht})`:`rgba(34, 211, 238, ${ht})`,t.shadowBlur=10+wt*2;const B=t.createRadialGradient(A-3,V-3,0,A,V,M);n.value==="won"?(B.addColorStop(0,"#86efac"),B.addColorStop(1,"#22c55e")):n.value==="lost"?(B.addColorStop(0,"#fca5a5"),B.addColorStop(1,"#ef4444")):(B.addColorStop(0,"#67e8f9"),B.addColorStop(1,"#06b6d4")),t.fillStyle=B,t.beginPath(),t.arc(A,V,M,0,Math.PI*2),t.fill(),t.shadowBlur=0,t.fillStyle="rgba(255, 255, 255, 0.4)",t.beginPath(),t.arc(A-3,V-3,M*.3,0,Math.PI*2),t.fill(),n.value==="idle"&&(t.textAlign="center",t.textBaseline="middle",t.fillStyle="rgba(255, 255, 255, 0.8)",t.font="bold 18px -apple-system, sans-serif",t.fillText("This is Preview",l,i+h+30),t.fillStyle="rgba(255, 255, 255, 0.4)",t.font="13px -apple-system, sans-serif",t.fillText("Tap button below to play",l,i+h+52))}function _t(){rt=Mt,et=Math.random()*Math.PI*2,vt=.015,X=0,L=J,Q=Math.PI*.7;const c=()=>{et+=vt;const t=h*.4;o=Math.cos(et)*t,s=Math.sin(et)*t*.6+15,e=0,a=0,X+=J,W(),tt=requestAnimationFrame(c)};c()}function Ct(){tt&&(cancelAnimationFrame(tt),tt=null)}return Xt(()=>{_t()}),qt(()=>{R&&cancelAnimationFrame(R),Ct()}),(c,t)=>(H(),O("div",jt,[d("header",Kt,[d("button",{class:"header-close",onClick:t[0]||(t[0]=l=>c.$router.back())},[...t[1]||(t[1]=[d("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[d("path",{d:"M18 6L6 18M6 6l12 12"})],-1),d("span",null,"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ",-1)])]),d("div",Zt,[d("span",Jt,"Game #"+D(mt.value),1)]),d("div",Qt,[d("span",null,D($.value.toFixed(2))+" â—‡",1)])]),d("div",te,[d("canvas",{ref_key:"gameCanvas",ref:pt,class:"game-canvas",width:g,height:At},null,512),d("div",{class:ut(["multiplier-overlay",n.value])},[d("div",{class:"multiplier-value",style:Vt({color:Ft.value})},D(F.value.toFixed(2))+"x ",5),n.value==="won"?(H(),O("div",ee,"ESCAPED!")):yt("",!0),n.value==="lost"?(H(),O("div",ae,"DEAD")):yt("",!0)],2)]),d("div",le,[t[2]||(t[2]=d("span",{class:"hash-label"},"Hash:",-1)),d("span",oe,D(st.value),1)]),d("div",ne,[(H(),O($t,null,Ut(xt,l=>d("button",{key:l,class:ut(["bet-btn",{active:I.value===l}]),onClick:i=>Lt(l),disabled:n.value==="playing"},D(l)+" â—‡ ",11,se)),64))]),d("div",ie,[d("button",{class:ut(["play-btn",{playing:n.value==="playing"}]),disabled:n.value==="playing"||$.value<I.value,onClick:Tt},[n.value==="idle"?(H(),O("span",ce,"Play "+D(I.value)+" â—‡",1)):n.value==="playing"?(H(),O("span",de,D(F.value.toFixed(2))+"x",1)):(H(),O("span",he,"Play Again"))],10,re)])]))}}),ye=zt(Me,[["__scopeId","data-v-8374202a"]]);export{ye as default};
