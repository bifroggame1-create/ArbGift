import{f as F,a as i,n as N,y as k,i as L,b as t,F as _,k as C,c as b,o,h as U,m as E,t as g,v as Q,x as J,r as p,l as T,p as M,d as S,u as K,j,g as tt}from"./vue-DpDB_xhb.js";import{a as I,u as et}from"./index-DCUERR7g.js";import{T as G}from"./TelegramGiftCard-B167vEZV.js";import{j as st}from"./client-Byqmzb3A.js";import"./index-D5GkNzM3.js";const lt={class:"probability-wheel-container"},ot=["d"],it=["d"],at=["transform"],nt=F({__name:"ProbabilityWheel",props:{probability:{},isSpinning:{type:Boolean},resultAngle:{}},setup(n){const m=n,f=b(()=>m.isSpinning?{transform:`rotate(${m.resultAngle}deg)`}:{}),d=b(()=>{const s=m.probability*360,l=100+70*Math.cos((s-90)*Math.PI/180),v=100+70*Math.sin((s-90)*Math.PI/180);return`M 100,100 L 100,30 A 70,70 0 ${s>180?1:0},1 ${l},${v} Z`}),u=b(()=>{const s=m.probability*360,l=100+70*Math.cos((s-90)*Math.PI/180),v=100+70*Math.sin((s-90)*Math.PI/180),y=360-s>180?1:0;return`M 100,100 L ${l},${v} A 70,70 0 ${y},1 100,30 Z`});return(s,l)=>(o(),i("div",lt,[(o(),i("svg",{class:k(["probability-wheel",{spinning:n.isSpinning}]),style:N(f.value),viewBox:"0 0 200 200",width:"280",height:"280"},[l[1]||(l[1]=L('<defs data-v-7d8282c3><linearGradient id="successGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-7d8282c3><stop offset="0%" style="stop-color:#10b981;stop-opacity:1;" data-v-7d8282c3></stop><stop offset="100%" style="stop-color:#34d399;stop-opacity:1;" data-v-7d8282c3></stop></linearGradient><linearGradient id="failGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-7d8282c3><stop offset="0%" style="stop-color:#ef4444;stop-opacity:1;" data-v-7d8282c3></stop><stop offset="100%" style="stop-color:#dc2626;stop-opacity:1;" data-v-7d8282c3></stop></linearGradient><filter id="glow" data-v-7d8282c3><feGaussianBlur stdDeviation="2" result="coloredBlur" data-v-7d8282c3></feGaussianBlur><feMerge data-v-7d8282c3><feMergeNode in="coloredBlur" data-v-7d8282c3></feMergeNode><feMergeNode in="SourceGraphic" data-v-7d8282c3></feMergeNode></feMerge></filter></defs>',1)),t("path",{d:d.value,fill:"url(#successGradient)",stroke:"#fff","stroke-width":"2",filter:"url(#glow)"},null,8,ot),t("path",{d:u.value,fill:"url(#failGradient)",stroke:"#fff","stroke-width":"2",filter:"url(#glow)"},null,8,it),l[2]||(l[2]=t("circle",{cx:"100",cy:"100",r:"35",fill:"#1f2937",stroke:"#fff","stroke-width":"2"},null,-1)),l[3]||(l[3]=t("text",{x:"100",y:"110","text-anchor":"middle","font-size":"24",fill:"#fff"}," ‚ö° ",-1)),(o(),i(_,null,C(12,v=>t("g",{key:v,transform:`rotate(${v*30} 100 100)`},[...l[0]||(l[0]=[t("line",{x1:"100",y1:"15",x2:"100",y2:"25",stroke:"#fff","stroke-width":"2",opacity:"0.5"},null,-1)])],8,at)),64))],6)),l[4]||(l[4]=L('<div class="needle-container" data-v-7d8282c3><div class="needle" data-v-7d8282c3><svg width="40" height="60" viewBox="0 0 40 60" data-v-7d8282c3><defs data-v-7d8282c3><linearGradient id="needleGradient" x1="0%" y1="0%" x2="0%" y2="100%" data-v-7d8282c3><stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1;" data-v-7d8282c3></stop><stop offset="100%" style="stop-color:#f59e0b;stop-opacity:1;" data-v-7d8282c3></stop></linearGradient></defs><polygon points="20,50 25,10 20,0 15,10" fill="url(#needleGradient)" stroke="#fff" stroke-width="1" data-v-7d8282c3></polygon><circle cx="20" cy="50" r="6" fill="#fbbf24" stroke="#fff" stroke-width="2" data-v-7d8282c3></circle></svg></div></div><div class="outer-ring" data-v-7d8282c3></div>',2))]))}}),rt=I(nt,[["__scopeId","data-v-7d8282c3"]]),dt={class:"modal-content"},ct={class:"modal-header"},ut={class:"modal-title"},vt={class:"search-box"},ft={class:"filters"},pt=["onClick"],gt={class:"gift-grid-modal"},mt={key:0,class:"loading-grid"},yt={key:1,class:"grid"},bt={key:2,class:"empty-state"},ht=F({__name:"GiftSelectionModal",props:{mode:{},excludeId:{}},emits:["select","close"],setup(n,{emit:m}){const f=n,d=m,u=p([]),s=p(!0),l=p(""),v=p("all"),y=[{label:"All",value:"all"},{label:"Common",value:"common"},{label:"Rare",value:"rare"},{label:"Epic",value:"epic"},{label:"Legendary",value:"legendary"}],w=b(()=>{let c=u.value;if(f.excludeId&&(c=c.filter(a=>a.id!==f.excludeId)),v.value!=="all"&&(c=c.filter(a=>(a.rarity||"common").toLowerCase()===v.value.toLowerCase())),l.value){const a=l.value.toLowerCase();c=c.filter(r=>r.name.toLowerCase().includes(a))}return c}),B=c=>{d("select",c)},x=async()=>{try{s.value=!0;const c=await st({limit:50});u.value=c.gifts||[]}catch(c){console.error("Failed to load gifts:",c)}finally{s.value=!1}};return U(()=>{x()}),(c,a)=>(o(),i("div",{class:"modal-overlay",onClick:a[2]||(a[2]=E(r=>d("close"),["self"]))},[t("div",dt,[t("div",ct,[t("h2",ut,"Select "+g(n.mode==="input"?"Input":"Target")+" Gift",1),t("button",{onClick:a[0]||(a[0]=r=>d("close")),class:"close-button"},[...a[3]||(a[3]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",vt,[a[4]||(a[4]=t("svg",{class:"search-icon w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),Q(t("input",{"onUpdate:modelValue":a[1]||(a[1]=r=>l.value=r),type:"text",placeholder:"Search gifts...",class:"search-input"},null,512),[[J,l.value]])]),t("div",ft,[(o(),i(_,null,C(y,r=>t("button",{key:r.value,class:k([{active:v.value===r.value},"filter-button"]),onClick:A=>v.value=r.value},g(r.label),11,pt)),64))]),t("div",gt,[s.value?(o(),i("div",mt,[(o(),i(_,null,C(6,r=>t("div",{key:r,class:"loading-card"})),64))])):w.value.length>0?(o(),i("div",yt,[(o(!0),i(_,null,C(w.value,r=>(o(),T(G,{key:r.id,gift:r,onClick:A=>B(r)},null,8,["gift","onClick"]))),128))])):(o(),i("div",bt,[...a[5]||(a[5]=[t("div",{class:"empty-icon"},"üîç",-1),t("div",{class:"empty-text"},"No gifts found",-1)])]))])])]))}}),kt=I(ht,[["__scopeId","data-v-207431da"]]),wt={key:0,class:"confetti-container"},xt={class:"result-icon"},$t={key:0,class:"icon-win"},_t={key:1,class:"icon-loss"},Ct={class:"result-title"},Mt={class:"gifts-display"},St={class:"gift-slot"},Gt={class:"slot-label"},Bt={key:0,class:"overlay-x"},At={class:"result-details"},Ft={class:"detail-row"},It={class:"detail-value"},Lt={class:"detail-row"},Tt={class:"detail-value"},Vt={class:"detail-value"},Rt={class:"action-buttons"},Pt=F({__name:"UpgradeResultModal",props:{result:{}},emits:["close"],setup(n,{emit:m}){const f=m,d=u=>{const s=["#10b981","#3b82f6","#f59e0b","#ef4444","#a855f7"];return{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*3}s`,backgroundColor:s[u%s.length]}};return(u,s)=>(o(),i("div",{class:"modal-overlay",onClick:s[2]||(s[2]=E(l=>f("close"),["self"]))},[t("div",{class:k(["modal-content",n.result.won?"win":"loss"])},[n.result.won?(o(),i("div",wt,[(o(),i(_,null,C(50,l=>t("div",{key:l,class:"confetti",style:N(d(l))},null,4)),64))])):M("",!0),t("div",xt,[n.result.won?(o(),i("span",$t,"üéä")):(o(),i("span",_t,"üíî"))]),t("h2",Ct,g(n.result.won?"Upgrade Successful!":"Upgrade Failed"),1),t("div",Mt,[t("div",St,[s[3]||(s[3]=t("div",{class:"slot-label"},"Lost",-1)),S(G,{gift:n.result.input_gift},null,8,["gift"])]),t("div",{class:k(["arrow",{failed:!n.result.won}])},[...s[4]||(s[4]=[t("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})],-1)])],2),t("div",{class:k(["gift-slot",{"grayed-out":!n.result.won}])},[t("div",Gt,g(n.result.won?"Won!":"Target"),1),S(G,{gift:n.result.target_gift},null,8,["gift"]),n.result.won?M("",!0):(o(),i("div",Bt,[...s[5]||(s[5]=[t("svg",{class:"w-16 h-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]))],2)]),t("div",At,[t("div",Ft,[s[6]||(s[6]=t("span",{class:"detail-label"},"Probability",-1)),t("span",It,g((n.result.probability*100).toFixed(1))+"%",1)]),t("div",Lt,[s[7]||(s[7]=t("span",{class:"detail-label"},"Result Angle",-1)),t("span",Tt,g(n.result.result_angle.toFixed(1))+"¬∞",1)]),t("div",{class:k(["detail-row highlight",n.result.won?"win":"loss"])},[s[8]||(s[8]=t("span",{class:"detail-label"},"Outcome",-1)),t("span",Vt,g(n.result.won?"SUCCESS":"FAILED"),1)],2)]),s[9]||(s[9]=L('<div class="provably-fair" data-v-d6f2667f><div class="fair-header" data-v-d6f2667f><span class="fair-icon" data-v-d6f2667f>üîê</span><span class="fair-title" data-v-d6f2667f>Provably Fair</span></div><button class="verify-button" data-v-d6f2667f> Verify Result </button></div>',1)),t("div",Rt,[t("button",{class:"action-button primary",onClick:s[0]||(s[0]=l=>f("close"))},g(n.result.won?"Claim Reward üéÅ":"Try Again ‚ö°"),1),t("button",{class:"action-button secondary",onClick:s[1]||(s[1]=l=>f("close"))}," Close ")])],2)]))}}),jt=I(Pt,[["__scopeId","data-v-d6f2667f"]]),Nt={class:"upgrade-view min-h-screen bg-gray-950 pb-24"},Ut={class:"px-4 pt-6 pb-4 bg-gradient-to-b from-purple-900/20 to-transparent"},Et={class:"mx-4 mt-6"},zt={class:"gift-selection"},Dt={class:"selection-slot"},Ht={key:0,class:"selected-gift"},Wt={class:"selection-slot"},Zt={key:0,class:"selected-gift"},qt={key:0,class:"mx-4 mt-8"},Xt={class:"wheel-container"},Yt={class:"probability-info"},Ot={class:"probability-percentage"},Qt={class:"value-comparison"},Jt={class:"comparison-row"},Kt={class:"comparison-item"},te={class:"comparison-value"},ee={width:"12",height:"12",viewBox:"0 0 56 56",fill:"none",style:{display:"inline-block","vertical-align":"middle","margin-right":"2px"}},se={class:"comparison-item"},le={class:"comparison-value highlight"},oe={width:"12",height:"12",viewBox:"0 0 56 56",fill:"none",style:{display:"inline-block","vertical-align":"middle","margin-right":"2px"}},ie={class:"comparison-ratio"},ae={class:"ratio-value"},ne={class:"fixed bottom-0 left-0 right-0 bg-gray-900/95 backdrop-blur-sm border-t border-gray-800 p-4 pb-safe z-40"},re=["disabled"],de={key:0},ce={key:1},ue={key:2},ve=F({__name:"UpgradeView",setup(n){const m=tt(),{hapticImpact:f}=et(),d=p(null),u=p(null),s=p(!1),l=p("input"),v=p(!1),y=p(0),w=p(!1),B=p(null),x=b(()=>d.value?parseFloat(String(d.value.min_price_ton||0)):0),c=b(()=>u.value?parseFloat(String(u.value.min_price_ton||0)):0),a=b(()=>{if(!x.value||!c.value)return .5;const h=.5,e=x.value/c.value,$=h*e;return Math.max(.01,Math.min($,.95))}),r=b(()=>d.value&&u.value&&!v.value),A=()=>{f("light"),l.value="input",s.value=!0},V=()=>{f("light"),l.value="target",s.value=!0},z=h=>{l.value==="input"?d.value=h:u.value=h,s.value=!1},D=async()=>{if(!r.value)return;f("heavy"),v.value=!0;const h=3,e=Math.random()*360,$=h*360+e,W=3e3,Z=Date.now(),R=()=>{const q=Date.now()-Z,P=Math.min(q/W,1),X=1-Math.pow(1-P,3);if(y.value=X*$,P<1)requestAnimationFrame(R);else{const Y=a.value*360,O=e%360<Y;B.value={won:O,input_gift:d.value,target_gift:u.value,probability:a.value,result_angle:e},w.value=!0,v.value=!1}};R()},H=()=>{w.value=!1,d.value=null,u.value=null,y.value=0};return U(()=>{}),(h,e)=>(o(),i("div",Nt,[t("div",Ut,[t("button",{onClick:e[0]||(e[0]=$=>K(m).back()),class:"mb-4 text-gray-400 hover:text-white transition-colors flex items-center space-x-2"},[...e[2]||(e[2]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),t("span",null,"Back",-1)])]),e[3]||(e[3]=t("h1",{class:"text-3xl font-bold text-white mb-2"},"‚ö° Upgrade",-1)),e[4]||(e[4]=t("p",{class:"text-gray-400 text-sm"},"Transform one gift into another ‚Ä¢ Spin the wheel",-1))]),t("div",Et,[e[10]||(e[10]=t("h2",{class:"text-lg font-semibold text-white mb-4"},"Select Gifts",-1)),t("div",zt,[t("div",Dt,[e[6]||(e[6]=t("div",{class:"slot-label"},"From",-1)),d.value?(o(),i("div",Ht,[S(G,{gift:d.value,onClick:A},null,8,["gift"])])):(o(),i("button",{key:1,onClick:A,class:"selection-placeholder"},[...e[5]||(e[5]=[t("svg",{class:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),t("span",{class:"text-sm text-gray-400"},"Select Gift",-1)])]))]),e[9]||(e[9]=t("div",{class:"arrow-container"},[t("svg",{class:"w-8 h-8 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})])],-1)),t("div",Wt,[e[8]||(e[8]=t("div",{class:"slot-label"},"To",-1)),u.value?(o(),i("div",Zt,[S(G,{gift:u.value,onClick:V},null,8,["gift"])])):(o(),i("button",{key:1,onClick:V,class:"selection-placeholder"},[...e[7]||(e[7]=[t("svg",{class:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),t("span",{class:"text-sm text-gray-400"},"Select Target",-1)])]))])])]),d.value&&u.value?(o(),i("div",qt,[e[18]||(e[18]=t("h2",{class:"text-lg font-semibold text-white mb-4 text-center"},"Success Probability",-1)),t("div",Xt,[S(rt,{probability:a.value,"is-spinning":v.value,"result-angle":y.value},null,8,["probability","is-spinning","result-angle"]),t("div",Yt,[t("div",Ot,g((a.value*100).toFixed(1))+"%",1),e[11]||(e[11]=t("div",{class:"probability-label"},"Chance to Win",-1))])]),t("div",Qt,[t("div",Jt,[t("div",Kt,[e[13]||(e[13]=t("div",{class:"comparison-label"},"Input Value",-1)),t("div",te,[(o(),i("svg",ee,[...e[12]||(e[12]=[t("circle",{cx:"28",cy:"28",r:"28",fill:"#0098EA"},null,-1),t("path",{d:"M37.5603 15.6277H18.4386C14.9228 15.6277 12.6944 19.4202 14.4632 22.4861L26.2644 42.9409C27.0345 44.2765 28.9644 44.2765 29.7345 42.9409L41.5765 22.4861C43.3045 19.4202 41.0761 15.6277 37.5603 15.6277Z",fill:"white"},null,-1)])])),j(" "+g(x.value.toFixed(2)),1)])]),e[16]||(e[16]=t("div",{class:"comparison-arrow"},"‚Üí",-1)),t("div",se,[e[15]||(e[15]=t("div",{class:"comparison-label"},"Target Value",-1)),t("div",le,[(o(),i("svg",oe,[...e[14]||(e[14]=[t("circle",{cx:"28",cy:"28",r:"28",fill:"#0098EA"},null,-1),t("path",{d:"M37.5603 15.6277H18.4386C14.9228 15.6277 12.6944 19.4202 14.4632 22.4861L26.2644 42.9409C27.0345 44.2765 28.9644 44.2765 29.7345 42.9409L41.5765 22.4861C43.3045 19.4202 41.0761 15.6277 37.5603 15.6277Z",fill:"white"},null,-1)])])),j(" "+g(c.value.toFixed(2)),1)])])]),t("div",ie,[e[17]||(e[17]=t("span",{class:"ratio-label"},"Multiplier:",-1)),t("span",ae,"x"+g((c.value/x.value).toFixed(2)),1)])])])):M("",!0),s.value?(o(),T(kt,{key:1,mode:l.value,"exclude-id":l.value==="target"?d.value?.id:void 0,onSelect:z,onClose:e[1]||(e[1]=$=>s.value=!1)},null,8,["mode","exclude-id"])):M("",!0),t("div",ne,[t("button",{disabled:!r.value,class:k([r.value?"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700":"bg-gray-700 cursor-not-allowed","w-full py-4 rounded-xl font-bold text-white transition-all transform active:scale-[0.98] disabled:opacity-50"]),onClick:D},[!d.value||!u.value?(o(),i("span",de," Select both gifts to spin ")):v.value?(o(),i("span",ce," Spinning... ")):(o(),i("span",ue," ‚ö° Spin the Wheel "))],10,re)]),w.value?(o(),T(jt,{key:2,result:B.value,onClose:H},null,8,["result"])):M("",!0)]))}}),he=I(ve,[["__scopeId","data-v-de9ea6be"]]);export{he as default};
