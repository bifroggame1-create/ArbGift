import{l as Ht}from"./client-pJ2CWAUX.js";import{d as Nt,j as Yt,y as Xt,c as O,b as h,t as H,n as gt,k as qt,z as yt,F as Vt,f as $t,r as N,l as Ut,o as Y}from"./vue-DrcrC0TO.js";import{a as Wt}from"./index-nHsVjOhL.js";const zt={class:"ball-escape-view"},jt={class:"game-header"},Kt={class:"game-id"},Zt={class:"label"},Jt={class:"balance-badge"},Qt={class:"arena-container"},te={key:0,class:"result-text won"},ee={key:1,class:"result-text lost"},ae={class:"hash-row"},oe={class:"hash-value"},le={class:"bet-row"},ne=["onClick","disabled"],se={class:"action-row"},ie=["disabled"],re={key:0},ce={key:1},de={key:2},p=340,At=460,d=120,m=12,ft=.45,he=.3,ue=.85,ge=.8,It=.998,fe=.02,pe=.04,pt=12,it=16,X=170,Q=150,w=360,L=80,tt=.016,me=5,ve=.55,Rt=.6,Me=.35,xt=.992,be=Nt({__name:"BallEscapeView",setup(Se){const mt=N(null),U=N(10),Pt=[.5,1,3,5,10],E=N(1),i=N("idle"),D=N(1),vt=N(Math.floor(Math.random()*9e5)+1e5),rt=N("---");let F=null,q=0,G=0,et=0,n=0,s=0,e=0,a=0,v=[],T=0,ct=0,at=null,ot=0,Mt=.02;const bt=[{main:"#fbbf24",glow:"rgba(251, 191, 36, ",light:"#fde68a"},{main:"#22d3ee",glow:"rgba(34, 211, 238, ",light:"#67e8f9"},{main:"#a855f7",glow:"rgba(168, 85, 247, ",light:"#c084fc"},{main:"#4ade80",glow:"rgba(74, 222, 128, ",light:"#86efac"},{main:"#f97316",glow:"rgba(249, 115, 22, ",light:"#fdba74"}],St={main:"#ec4899",glow:"rgba(236, 72, 153, ",light:"#f9a8d4"};let dt=St,_t=0,lt=5e3,ht=!1,W=1,A=!1,V=null,nt=0;const Et=Ut(()=>i.value==="won"?"#4ade80":i.value==="lost"?"#ef4444":D.value>=2?"#4ade80":"#22d3ee");function Ft(r){i.value==="idle"&&(E.value=r)}async function Tt(){if(i.value==="playing"||U.value<E.value)return;wt(),dt=bt[Math.floor(Math.random()*bt.length)],U.value-=E.value,i.value="playing",D.value=1,vt.value=Math.floor(Math.random()*9e5)+1e5;const r=-Math.PI/2+(Math.random()-.5)*1.2,t=30+Math.random()*40;n=Math.cos(r)*t,s=Math.sin(r)*t;const o=Math.random()*Math.PI*2,c=4+Math.random()*3;e=Math.cos(o)*c,a=Math.sin(o)*c+2,q=0,G=tt,et=Math.random()*Math.PI*2,v=[],T=0,A=!1,V=null,nt=0;try{const S=await Ht({amount:E.value,client_seed:Math.random().toString(36).substring(2,10),nonce:Date.now(),user_id:"user"});ht=S.escaped,lt=S.duration_ms,W=S.multiplier,rt.value=S.server_seed_hash.slice(0,6)+"..."+S.server_seed_hash.slice(-4)}catch{ht=Math.random()<.4,lt=4e3+Math.random()*3e3,W=1.5+Math.random()*3.5,rt.value=Math.random().toString(36).slice(2,8)+"..."}_t=Date.now(),F=requestAnimationFrame(st)}function st(){const r=Date.now()-_t,t=Math.min(r/lt,1);D.value=1+(W-1)*t,G=tt,q+=tt;const o=et+q;if(A){if(a+=Me,e*=xt,a*=xt,nt===0){const g=X+n,u=((ht?p*.25:p*.75)-g)*.004;e+=u}n+=e,s+=a;const f=X+n;if(Q+s>=w-m&&(s=w-m-Q,a=-Math.abs(a)*ve,e*=.85,nt++,V=f<p/2?"green":"red",nt>=me||Math.abs(a)<1.2)){a=0,e=0,Lt(V==="green");return}if(f<=m&&(n=m-X,e=Math.abs(e)*Rt),f>=p-m&&(n=p-m-X,e=-Math.abs(e)*Rt),Math.sqrt(n*n+s*s)<d+m+5&&s<0){const g=Math.atan2(s,n),l=d+m+6;n=Math.cos(g)*l,s=Math.sin(g)*l;const u=Math.cos(g),_=Math.sin(g),b=e*u+a*_;b<0&&(e-=2*b*u*.5,a-=2*b*_*.5)}v.unshift({x:X+n,y:Q+s}),v.length>it&&v.pop(),z(),F=requestAnimationFrame(st);return}const c=Math.sqrt(n*n+s*s);if(c>1){const f=G*G,M=fe*f*c;e+=n/c*M,a+=s/c*M}const S=pe*G;e+=-a*S,a+=e*S,a+=he,e*=It,a*=It;const I=Math.sqrt(e*e+a*a);I>pt&&(e=e/I*pt,a=a/I*pt),n+=e,s+=a,v.unshift({x:n,y:s}),v.length>it&&v.pop(),T*=.88;const y=d-m;if(Math.sqrt(n*n+s*s)>=y){const f=Math.atan2(s,n);if(Math.abs(Dt(f-o))<ft/2){A=!0,v=[];const _=Math.max(Math.sqrt(e*e+a*a),5),b=o;e=Math.cos(b)*_,a=Math.sin(b)*_,n=Math.cos(b)*(d+m+2),s=Math.sin(b)*(d+m+2),z(),F=requestAnimationFrame(st);return}n=Math.cos(f)*y,s=Math.sin(f)*y;const g=Math.cos(f),l=Math.sin(f),u=e*g+a*l;if(u>0){const _=e-u*g,b=a-u*l,R=-u*ue;e=_+R*g,a=b+R*l;const k=ge+Math.abs(u)*.2;e-=g*k,a-=l*k;const x=-l,P=g,K=G*d*.4;e+=x*K,a+=P*K;const $=(Math.random()-.5)*1.5;e+=x*$,a+=P*$,T=1,ct=f}}if(t>=1&&!A){const f=r-lt;if(f>2e3){A=!0,v=[];const M=o;n=Math.cos(M)*(d+m+2),s=Math.sin(M)*(d+m+2),e=Math.cos(M)*5,a=Math.sin(M)*5}else{const M=o,j=Math.cos(M)*y,g=Math.sin(M)*y,l=j-n,u=g-s,_=Math.sqrt(l*l+u*u);if(_>1){const b=1+f*.002;e+=l/_*b,a+=u/_*b}}}z(),F=requestAnimationFrame(st)}function Lt(r){F&&cancelAnimationFrame(F),D.value=W,r?(i.value="won",U.value+=E.value*W):i.value="lost",z(),setTimeout(()=>{i.value="idle",D.value=1,V=null,Ct()},2500)}function Dt(r){for(;r>Math.PI;)r-=Math.PI*2;for(;r<-Math.PI;)r+=Math.PI*2;return r}function z(){const r=mt.value;if(!r)return;const t=r.getContext("2d");if(!t)return;const o=X,c=Q;t.fillStyle="#0a0c14",t.fillRect(0,0,p,At);const S=w+L/2,I=t.createLinearGradient(0,w-60,0,w+L);I.addColorStop(0,"rgba(34, 197, 94, 0)"),I.addColorStop(.3,"rgba(34, 197, 94, 0.08)"),I.addColorStop(.6,"rgba(34, 197, 94, 0.25)"),I.addColorStop(1,"rgba(34, 197, 94, 0.5)"),t.fillStyle=I,t.fillRect(0,w-60,p/2,L+60);const y=t.createLinearGradient(0,w-60,0,w+L);y.addColorStop(0,"rgba(239, 68, 68, 0)"),y.addColorStop(.3,"rgba(239, 68, 68, 0.08)"),y.addColorStop(.6,"rgba(239, 68, 68, 0.25)"),y.addColorStop(1,"rgba(239, 68, 68, 0.5)"),t.fillStyle=y,t.fillRect(p/2,w-60,p/2,L+60),t.fillStyle="rgba(34, 197, 94, 0.6)",t.fillRect(0,w+10,p/2,L-10),t.fillStyle="rgba(239, 68, 68, 0.6)",t.fillRect(p/2,w+10,p/2,L-10),t.save(),t.shadowColor="rgba(255, 255, 255, 0.5)",t.shadowBlur=8,t.strokeStyle="rgba(255, 255, 255, 0.6)",t.lineWidth=2,t.beginPath(),t.moveTo(p/2,w-30),t.lineTo(p/2,w+L),t.stroke(),t.restore(),t.font="28px -apple-system, sans-serif",t.textAlign="center",t.textBaseline="middle";const ut=p/4,f=V==="green";t.globalAlpha=f?1:.7,t.fillText("ðŸ‘‘",ut-18,S+8),t.fillText("ðŸ’Ž",ut+18,S+8),t.globalAlpha=1;const M=p*3/4,j=V==="red";t.globalAlpha=j?1:.7,t.fillText("ðŸ’€",M-18,S+8),t.fillText("â˜ ï¸",M+18,S+8),t.globalAlpha=1;const g=et+q,l=dt,u=t.createRadialGradient(o,c,d-20,o,c,d+15);u.addColorStop(0,l.glow+"0.0)"),u.addColorStop(.6,l.glow+"0.12)"),u.addColorStop(1,l.glow+"0.0)"),t.fillStyle=u,t.beginPath(),t.arc(o,c,d+15,0,Math.PI*2),t.fill();const _=g-ft/2,b=g+ft/2;t.save(),t.lineWidth=10,t.lineCap="round";const R=t.createLinearGradient(o-d,c-d,o+d,c+d);if(R.addColorStop(0,l.main),R.addColorStop(.3,l.light),R.addColorStop(.5,l.main),R.addColorStop(.8,l.main),R.addColorStop(1,l.light),t.strokeStyle=R,t.shadowColor=l.glow+"0.5)",t.shadowBlur=12,t.beginPath(),t.arc(o,c,d,b,_+Math.PI*2),t.stroke(),t.restore(),T>.05&&i.value==="playing"&&!A){const Z=o+Math.cos(ct)*d,J=c+Math.sin(ct)*d,C=t.createRadialGradient(Z,J,0,Z,J,30*T);C.addColorStop(0,l.glow+`${T*.8})`),C.addColorStop(.5,l.glow+`${T*.4})`),C.addColorStop(1,l.glow+"0)"),t.fillStyle=C,t.beginPath(),t.arc(Z,J,30*T,0,Math.PI*2),t.fill()}const k=t.createRadialGradient(o-30,c-30,0,o,c,d);if(k.addColorStop(0,l.glow+"0.05)"),k.addColorStop(.5,l.glow+"0.02)"),k.addColorStop(1,"rgba(0, 0, 0, 0)"),t.fillStyle=k,t.beginPath(),t.arc(o,c,d-10,0,Math.PI*2),t.fill(),v.length>1&&i.value==="playing"){const Z=Math.sqrt(e*e+a*a),J=Math.min(Z/8,1);for(let C=1;C<v.length;C++){const Gt=(1-C/it)*(.3+J*.5),kt=m*(1-C/it*.7);t.fillStyle=`rgba(34, 211, 238, ${Gt})`,t.beginPath();const Bt=A?v[C].x:o+v[C].x,Ot=A?v[C].y:c+v[C].y;t.arc(Bt,Ot,kt,0,Math.PI*2),t.fill()}}let x,P;A?(x=X+n,P=Q+s):(x=o+n,P=c+s);const K=Math.sqrt(e*e+a*a),$=Math.min(.4+K/10,1);t.shadowColor=i.value==="won"?`rgba(74, 222, 128, ${$})`:i.value==="lost"?`rgba(239, 68, 68, ${$})`:`rgba(34, 211, 238, ${$})`,t.shadowBlur=10+K*2;const B=t.createRadialGradient(x-3,P-3,0,x,P,m);i.value==="won"?(B.addColorStop(0,"#86efac"),B.addColorStop(1,"#22c55e")):i.value==="lost"?(B.addColorStop(0,"#fca5a5"),B.addColorStop(1,"#ef4444")):(B.addColorStop(0,"#67e8f9"),B.addColorStop(1,"#06b6d4")),t.fillStyle=B,t.beginPath(),t.arc(x,P,m,0,Math.PI*2),t.fill(),t.shadowBlur=0,t.fillStyle="rgba(255, 255, 255, 0.4)",t.beginPath(),t.arc(x-3,P-3,m*.3,0,Math.PI*2),t.fill(),i.value==="idle"&&(t.textAlign="center",t.textBaseline="middle",t.fillStyle="rgba(255, 255, 255, 0.8)",t.font="bold 18px -apple-system, sans-serif",t.fillText("This is Preview",o,c+d+30),t.fillStyle="rgba(255, 255, 255, 0.4)",t.font="13px -apple-system, sans-serif",t.fillText("Tap button below to play",o,c+d+52))}function Ct(){dt=St,ot=Math.random()*Math.PI*2,Mt=.015,q=0,G=tt,et=Math.PI*.7;const r=()=>{ot+=Mt;const t=d*.4;n=Math.cos(ot)*t,s=Math.sin(ot)*t*.6+15,e=0,a=0,q+=tt,z(),at=requestAnimationFrame(r)};r()}function wt(){at&&(cancelAnimationFrame(at),at=null)}return Yt(()=>{Ct()}),Xt(()=>{F&&cancelAnimationFrame(F),wt()}),(r,t)=>(Y(),O("div",zt,[h("header",jt,[h("button",{class:"header-close",onClick:t[0]||(t[0]=o=>r.$router.back())},[...t[1]||(t[1]=[h("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[h("path",{d:"M18 6L6 18M6 6l12 12"})],-1),h("span",null,"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ",-1)])]),h("div",Kt,[h("span",Zt,"Game #"+H(vt.value),1)]),h("div",Jt,[h("span",null,H(U.value.toFixed(2))+" â—‡",1)])]),h("div",Qt,[h("canvas",{ref_key:"gameCanvas",ref:mt,class:"game-canvas",width:p,height:At},null,512),h("div",{class:gt(["multiplier-overlay",i.value])},[h("div",{class:"multiplier-value",style:qt({color:Et.value})},H(D.value.toFixed(2))+"x ",5),i.value==="won"?(Y(),O("div",te,"ESCAPED!")):yt("",!0),i.value==="lost"?(Y(),O("div",ee,"DEAD")):yt("",!0)],2)]),h("div",ae,[t[2]||(t[2]=h("span",{class:"hash-label"},"Hash:",-1)),h("span",oe,H(rt.value),1)]),h("div",le,[(Y(),O(Vt,null,$t(Pt,o=>h("button",{key:o,class:gt(["bet-btn",{active:E.value===o}]),onClick:c=>Ft(o),disabled:i.value==="playing"},H(o)+" â—‡ ",11,ne)),64))]),h("div",se,[h("button",{class:gt(["play-btn",{playing:i.value==="playing"}]),disabled:i.value==="playing"||U.value<E.value,onClick:Tt},[i.value==="idle"?(Y(),O("span",re,"Play "+H(E.value)+" â—‡",1)):i.value==="playing"?(Y(),O("span",ce,H(D.value.toFixed(2))+"x",1)):(Y(),O("span",de,"Play Again"))],10,ie)])]))}}),ye=Wt(be,[["__scopeId","data-v-3fc44e24"]]);export{ye as default};
