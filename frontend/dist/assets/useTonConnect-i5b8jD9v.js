const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-NC_ueuhw.js","assets/_commonjsHelpers-BosuxZz1.js"])))=>i.map(i=>d[i]);
import{_ as U}from"./index-D9_dVF2h.js";import{l as s,r as u}from"./vue-ao1au3Rh.js";let n=null;const e=u(null),r=u(!1),c=u(!1);function I(){const l=s(()=>e.value?e.value.account.address:null),v=s(()=>{if(!l.value)return null;const t=l.value;return`${t.slice(0,4)}...${t.slice(-4)}`}),w=s(()=>e.value?e.value.account.chain:null),m=s(()=>e.value?{name:e.value.device.appName,icon:e.value.imageUrl,platform:e.value.device.platform}:null),p=async t=>{if(n)return n;try{const{TonConnectUI:o}=await U(async()=>{const{TonConnectUI:a}=await import("./index-NC_ueuhw.js");return{TonConnectUI:a}},__vite__mapDeps([0,1])),i={manifestUrl:`${window.location.origin}/tonconnect-manifest.json`,uiPreferences:{theme:"DARK"}};if(n=new o(i),window.Telegram?.WebApp){const a=`https://t.me/${t||"giftmarket_bot"}/app`;n.uiOptions={twaReturnUrl:a},console.log("TonConnect initialized for TMA with return URL:",a)}return n.onStatusChange(a=>{e.value=a,r.value=!!a,c.value=!1}),n.wallet&&(e.value=n.wallet,r.value=!0),n}catch(o){return console.warn("TonConnect UI not available:",o),null}},h=async()=>{if(!n)throw new Error("TonConnect not initialized");c.value=!0;try{await n.openModal()}catch(t){throw c.value=!1,t}},T=async()=>{n&&(await n.disconnect(),e.value=null,r.value=!1)},f=async t=>{if(!n||!r.value)throw new Error("Wallet not connected");return await n.sendTransaction(t)};return{wallet:e,isConnected:r,isConnecting:c,address:l,shortAddress:v,chain:w,walletInfo:m,init:p,connect:h,disconnect:T,sendTransaction:f,transferNFT:async t=>{if(!n||!l.value)throw new Error("Wallet not connected");const{nftAddress:o,amount:d="50000000",forwardPayload:i}=t,a=[{address:o,amount:d,payload:i}];return await f({validUntil:Math.floor(Date.now()/1e3)+600,messages:a})},getUI:()=>n}}export{I as u};
