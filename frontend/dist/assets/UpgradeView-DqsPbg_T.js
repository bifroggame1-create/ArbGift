import{d as F,c as a,k as P,n as k,a as T,b as t,F as _,f as M,l as b,o,j,A as U,t as g,D as Z,E as Q,r as p,h as L,z as C,g as S,I as J,H as K}from"./vue-Dr6T3rTv.js";import{a as I,u as tt}from"./index-CeoM6lsU.js";import{T as G}from"./TelegramGiftCard-DACXLpKe.js";import{g as et}from"./client-pJ2CWAUX.js";const st={class:"probability-wheel-container"},lt=["d"],ot=["d"],at=["transform"],it=F({__name:"ProbabilityWheel",props:{probability:{},isSpinning:{type:Boolean},resultAngle:{}},setup(n){const m=n,f=b(()=>m.isSpinning?{transform:`rotate(${m.resultAngle}deg)`}:{}),d=b(()=>{const e=m.probability*360,l=100+70*Math.cos((e-90)*Math.PI/180),v=100+70*Math.sin((e-90)*Math.PI/180);return`M 100,100 L 100,30 A 70,70 0 ${e>180?1:0},1 ${l},${v} Z`}),u=b(()=>{const e=m.probability*360,l=100+70*Math.cos((e-90)*Math.PI/180),v=100+70*Math.sin((e-90)*Math.PI/180),y=360-e>180?1:0;return`M 100,100 L ${l},${v} A 70,70 0 ${y},1 100,30 Z`});return(e,l)=>(o(),a("div",st,[(o(),a("svg",{class:k(["probability-wheel",{spinning:n.isSpinning}]),style:P(f.value),viewBox:"0 0 200 200",width:"280",height:"280"},[l[1]||(l[1]=T('<defs data-v-7d8282c3><linearGradient id="successGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-7d8282c3><stop offset="0%" style="stop-color:#10b981;stop-opacity:1;" data-v-7d8282c3></stop><stop offset="100%" style="stop-color:#34d399;stop-opacity:1;" data-v-7d8282c3></stop></linearGradient><linearGradient id="failGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-7d8282c3><stop offset="0%" style="stop-color:#ef4444;stop-opacity:1;" data-v-7d8282c3></stop><stop offset="100%" style="stop-color:#dc2626;stop-opacity:1;" data-v-7d8282c3></stop></linearGradient><filter id="glow" data-v-7d8282c3><feGaussianBlur stdDeviation="2" result="coloredBlur" data-v-7d8282c3></feGaussianBlur><feMerge data-v-7d8282c3><feMergeNode in="coloredBlur" data-v-7d8282c3></feMergeNode><feMergeNode in="SourceGraphic" data-v-7d8282c3></feMergeNode></feMerge></filter></defs>',1)),t("path",{d:d.value,fill:"url(#successGradient)",stroke:"#fff","stroke-width":"2",filter:"url(#glow)"},null,8,lt),t("path",{d:u.value,fill:"url(#failGradient)",stroke:"#fff","stroke-width":"2",filter:"url(#glow)"},null,8,ot),l[2]||(l[2]=t("circle",{cx:"100",cy:"100",r:"35",fill:"#1f2937",stroke:"#fff","stroke-width":"2"},null,-1)),l[3]||(l[3]=t("text",{x:"100",y:"110","text-anchor":"middle","font-size":"24",fill:"#fff"}," ‚ö° ",-1)),(o(),a(_,null,M(12,v=>t("g",{key:v,transform:`rotate(${v*30} 100 100)`},[...l[0]||(l[0]=[t("line",{x1:"100",y1:"15",x2:"100",y2:"25",stroke:"#fff","stroke-width":"2",opacity:"0.5"},null,-1)])],8,at)),64))],6)),l[4]||(l[4]=T('<div class="needle-container" data-v-7d8282c3><div class="needle" data-v-7d8282c3><svg width="40" height="60" viewBox="0 0 40 60" data-v-7d8282c3><defs data-v-7d8282c3><linearGradient id="needleGradient" x1="0%" y1="0%" x2="0%" y2="100%" data-v-7d8282c3><stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1;" data-v-7d8282c3></stop><stop offset="100%" style="stop-color:#f59e0b;stop-opacity:1;" data-v-7d8282c3></stop></linearGradient></defs><polygon points="20,50 25,10 20,0 15,10" fill="url(#needleGradient)" stroke="#fff" stroke-width="1" data-v-7d8282c3></polygon><circle cx="20" cy="50" r="6" fill="#fbbf24" stroke="#fff" stroke-width="2" data-v-7d8282c3></circle></svg></div></div><div class="outer-ring" data-v-7d8282c3></div>',2))]))}}),nt=I(it,[["__scopeId","data-v-7d8282c3"]]),rt={class:"modal-content"},dt={class:"modal-header"},ct={class:"modal-title"},ut={class:"search-box"},vt={class:"filters"},ft=["onClick"],pt={class:"gift-grid-modal"},gt={key:0,class:"loading-grid"},mt={key:1,class:"grid"},yt={key:2,class:"empty-state"},bt=F({__name:"GiftSelectionModal",props:{mode:{},excludeId:{}},emits:["select","close"],setup(n,{emit:m}){const f=n,d=m,u=p([]),e=p(!0),l=p(""),v=p("all"),y=[{label:"All",value:"all"},{label:"Common",value:"common"},{label:"Rare",value:"rare"},{label:"Epic",value:"epic"},{label:"Legendary",value:"legendary"}],w=b(()=>{let c=u.value;if(f.excludeId&&(c=c.filter(i=>i.id!==f.excludeId)),v.value!=="all"&&(c=c.filter(i=>(i.rarity||"common").toLowerCase()===v.value.toLowerCase())),l.value){const i=l.value.toLowerCase();c=c.filter(r=>r.name.toLowerCase().includes(i))}return c}),B=c=>{d("select",c)},x=async()=>{try{e.value=!0;const c=await et({limit:50});u.value=c.gifts||[]}catch(c){console.error("Failed to load gifts:",c)}finally{e.value=!1}};return j(()=>{x()}),(c,i)=>(o(),a("div",{class:"modal-overlay",onClick:i[2]||(i[2]=U(r=>d("close"),["self"]))},[t("div",rt,[t("div",dt,[t("h2",ct,"Select "+g(n.mode==="input"?"Input":"Target")+" Gift",1),t("button",{onClick:i[0]||(i[0]=r=>d("close")),class:"close-button"},[...i[3]||(i[3]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",ut,[i[4]||(i[4]=t("svg",{class:"search-icon w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),Z(t("input",{"onUpdate:modelValue":i[1]||(i[1]=r=>l.value=r),type:"text",placeholder:"Search gifts...",class:"search-input"},null,512),[[Q,l.value]])]),t("div",vt,[(o(),a(_,null,M(y,r=>t("button",{key:r.value,class:k([{active:v.value===r.value},"filter-button"]),onClick:A=>v.value=r.value},g(r.label),11,ft)),64))]),t("div",pt,[e.value?(o(),a("div",gt,[(o(),a(_,null,M(6,r=>t("div",{key:r,class:"loading-card"})),64))])):w.value.length>0?(o(),a("div",mt,[(o(!0),a(_,null,M(w.value,r=>(o(),L(G,{key:r.id,gift:r,onClick:A=>B(r)},null,8,["gift","onClick"]))),128))])):(o(),a("div",yt,[...i[5]||(i[5]=[t("div",{class:"empty-icon"},"üîç",-1),t("div",{class:"empty-text"},"No gifts found",-1)])]))])])]))}}),ht=I(bt,[["__scopeId","data-v-207431da"]]),kt={key:0,class:"confetti-container"},wt={class:"result-icon"},xt={key:0,class:"icon-win"},$t={key:1,class:"icon-loss"},_t={class:"result-title"},Mt={class:"gifts-display"},Ct={class:"gift-slot"},St={class:"slot-label"},Gt={key:0,class:"overlay-x"},Bt={class:"result-details"},At={class:"detail-row"},Ft={class:"detail-value"},It={class:"detail-row"},Tt={class:"detail-value"},Lt={class:"detail-value"},Rt={class:"action-buttons"},Vt=F({__name:"UpgradeResultModal",props:{result:{}},emits:["close"],setup(n,{emit:m}){const f=m,d=u=>{const e=["#10b981","#3b82f6","#f59e0b","#ef4444","#a855f7"];return{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*3}s`,backgroundColor:e[u%e.length]}};return(u,e)=>(o(),a("div",{class:"modal-overlay",onClick:e[2]||(e[2]=U(l=>f("close"),["self"]))},[t("div",{class:k(["modal-content",n.result.won?"win":"loss"])},[n.result.won?(o(),a("div",kt,[(o(),a(_,null,M(50,l=>t("div",{key:l,class:"confetti",style:P(d(l))},null,4)),64))])):C("",!0),t("div",wt,[n.result.won?(o(),a("span",xt,"üéä")):(o(),a("span",$t,"üíî"))]),t("h2",_t,g(n.result.won?"Upgrade Successful!":"Upgrade Failed"),1),t("div",Mt,[t("div",Ct,[e[3]||(e[3]=t("div",{class:"slot-label"},"Lost",-1)),S(G,{gift:n.result.input_gift},null,8,["gift"])]),t("div",{class:k(["arrow",{failed:!n.result.won}])},[...e[4]||(e[4]=[t("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})],-1)])],2),t("div",{class:k(["gift-slot",{"grayed-out":!n.result.won}])},[t("div",St,g(n.result.won?"Won!":"Target"),1),S(G,{gift:n.result.target_gift},null,8,["gift"]),n.result.won?C("",!0):(o(),a("div",Gt,[...e[5]||(e[5]=[t("svg",{class:"w-16 h-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]))],2)]),t("div",Bt,[t("div",At,[e[6]||(e[6]=t("span",{class:"detail-label"},"Probability",-1)),t("span",Ft,g((n.result.probability*100).toFixed(1))+"%",1)]),t("div",It,[e[7]||(e[7]=t("span",{class:"detail-label"},"Result Angle",-1)),t("span",Tt,g(n.result.result_angle.toFixed(1))+"¬∞",1)]),t("div",{class:k(["detail-row highlight",n.result.won?"win":"loss"])},[e[8]||(e[8]=t("span",{class:"detail-label"},"Outcome",-1)),t("span",Lt,g(n.result.won?"SUCCESS":"FAILED"),1)],2)]),e[9]||(e[9]=T('<div class="provably-fair" data-v-d6f2667f><div class="fair-header" data-v-d6f2667f><span class="fair-icon" data-v-d6f2667f>üîê</span><span class="fair-title" data-v-d6f2667f>Provably Fair</span></div><button class="verify-button" data-v-d6f2667f> Verify Result </button></div>',1)),t("div",Rt,[t("button",{class:"action-button primary",onClick:e[0]||(e[0]=l=>f("close"))},g(n.result.won?"Claim Reward üéÅ":"Try Again ‚ö°"),1),t("button",{class:"action-button secondary",onClick:e[1]||(e[1]=l=>f("close"))}," Close ")])],2)]))}}),Nt=I(Vt,[["__scopeId","data-v-d6f2667f"]]),Pt={class:"upgrade-view min-h-screen bg-gray-950 pb-24"},jt={class:"px-4 pt-6 pb-4 bg-gradient-to-b from-purple-900/20 to-transparent"},Ut={class:"mx-4 mt-6"},zt={class:"gift-selection"},Dt={class:"selection-slot"},Et={key:0,class:"selected-gift"},Wt={class:"selection-slot"},Ht={key:0,class:"selected-gift"},Ot={key:0,class:"mx-4 mt-8"},qt={class:"wheel-container"},Xt={class:"probability-info"},Yt={class:"probability-percentage"},Zt={class:"value-comparison"},Qt={class:"comparison-row"},Jt={class:"comparison-item"},Kt={class:"comparison-value"},te={class:"comparison-item"},ee={class:"comparison-value highlight"},se={class:"comparison-ratio"},le={class:"ratio-value"},oe={class:"fixed bottom-0 left-0 right-0 bg-gray-900/95 backdrop-blur-sm border-t border-gray-800 p-4 pb-safe z-40"},ae=["disabled"],ie={key:0},ne={key:1},re={key:2},de=F({__name:"UpgradeView",setup(n){const m=K(),{hapticImpact:f}=tt(),d=p(null),u=p(null),e=p(!1),l=p("input"),v=p(!1),y=p(0),w=p(!1),B=p(null),x=b(()=>d.value?parseFloat(String(d.value.min_price_ton||0)):0),c=b(()=>u.value?parseFloat(String(u.value.min_price_ton||0)):0),i=b(()=>{if(!x.value||!c.value)return .5;const h=.5,s=x.value/c.value,$=h*s;return Math.max(.01,Math.min($,.95))}),r=b(()=>d.value&&u.value&&!v.value),A=()=>{f("light"),l.value="input",e.value=!0},R=()=>{f("light"),l.value="target",e.value=!0},z=h=>{l.value==="input"?d.value=h:u.value=h,e.value=!1},D=async()=>{if(!r.value)return;f("heavy"),v.value=!0;const h=3,s=Math.random()*360,$=h*360+s,W=3e3,H=Date.now(),V=()=>{const O=Date.now()-H,N=Math.min(O/W,1),q=1-Math.pow(1-N,3);if(y.value=q*$,N<1)requestAnimationFrame(V);else{const X=i.value*360,Y=s%360<X;B.value={won:Y,input_gift:d.value,target_gift:u.value,probability:i.value,result_angle:s},w.value=!0,v.value=!1}};V()},E=()=>{w.value=!1,d.value=null,u.value=null,y.value=0};return j(()=>{}),(h,s)=>(o(),a("div",Pt,[t("div",jt,[t("button",{onClick:s[0]||(s[0]=$=>J(m).back()),class:"mb-4 text-gray-400 hover:text-white transition-colors flex items-center space-x-2"},[...s[2]||(s[2]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),t("span",null,"Back",-1)])]),s[3]||(s[3]=t("h1",{class:"text-3xl font-bold text-white mb-2"},"‚ö° Upgrade",-1)),s[4]||(s[4]=t("p",{class:"text-gray-400 text-sm"},"Transform one gift into another ‚Ä¢ Spin the wheel",-1))]),t("div",Ut,[s[10]||(s[10]=t("h2",{class:"text-lg font-semibold text-white mb-4"},"Select Gifts",-1)),t("div",zt,[t("div",Dt,[s[6]||(s[6]=t("div",{class:"slot-label"},"From",-1)),d.value?(o(),a("div",Et,[S(G,{gift:d.value,onClick:A},null,8,["gift"])])):(o(),a("button",{key:1,onClick:A,class:"selection-placeholder"},[...s[5]||(s[5]=[t("svg",{class:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),t("span",{class:"text-sm text-gray-400"},"Select Gift",-1)])]))]),s[9]||(s[9]=t("div",{class:"arrow-container"},[t("svg",{class:"w-8 h-8 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})])],-1)),t("div",Wt,[s[8]||(s[8]=t("div",{class:"slot-label"},"To",-1)),u.value?(o(),a("div",Ht,[S(G,{gift:u.value,onClick:R},null,8,["gift"])])):(o(),a("button",{key:1,onClick:R,class:"selection-placeholder"},[...s[7]||(s[7]=[t("svg",{class:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),t("span",{class:"text-sm text-gray-400"},"Select Target",-1)])]))])])]),d.value&&u.value?(o(),a("div",Ot,[s[16]||(s[16]=t("h2",{class:"text-lg font-semibold text-white mb-4 text-center"},"Success Probability",-1)),t("div",qt,[S(nt,{probability:i.value,"is-spinning":v.value,"result-angle":y.value},null,8,["probability","is-spinning","result-angle"]),t("div",Xt,[t("div",Yt,g((i.value*100).toFixed(1))+"%",1),s[11]||(s[11]=t("div",{class:"probability-label"},"Chance to Win",-1))])]),t("div",Zt,[t("div",Qt,[t("div",Jt,[s[12]||(s[12]=t("div",{class:"comparison-label"},"Input Value",-1)),t("div",Kt,g(x.value.toFixed(2))+" TON",1)]),s[14]||(s[14]=t("div",{class:"comparison-arrow"},"‚Üí",-1)),t("div",te,[s[13]||(s[13]=t("div",{class:"comparison-label"},"Target Value",-1)),t("div",ee,g(c.value.toFixed(2))+" TON",1)])]),t("div",se,[s[15]||(s[15]=t("span",{class:"ratio-label"},"Multiplier:",-1)),t("span",le,"x"+g((c.value/x.value).toFixed(2)),1)])])])):C("",!0),e.value?(o(),L(ht,{key:1,mode:l.value,"exclude-id":l.value==="target"?d.value?.id:void 0,onSelect:z,onClose:s[1]||(s[1]=$=>e.value=!1)},null,8,["mode","exclude-id"])):C("",!0),t("div",oe,[t("button",{disabled:!r.value,class:k([r.value?"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700":"bg-gray-700 cursor-not-allowed","w-full py-4 rounded-xl font-bold text-white transition-all transform active:scale-[0.98] disabled:opacity-50"]),onClick:D},[!d.value||!u.value?(o(),a("span",ie," Select both gifts to spin ")):v.value?(o(),a("span",ne," Spinning... ")):(o(),a("span",re," ‚ö° Spin the Wheel "))],10,ae)]),w.value?(o(),L(Nt,{key:2,result:B.value,onClose:E},null,8,["result"])):C("",!0)]))}}),ge=I(de,[["__scopeId","data-v-c04849e0"]]);export{ge as default};
