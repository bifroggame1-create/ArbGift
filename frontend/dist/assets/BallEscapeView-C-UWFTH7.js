import{l as Lt}from"./client-COG1KRRB.js";import{d as Ht,o as Ot,G as Nt,b as F,e as r,t as B,n as ht,E as Xt,k as Ct,F as Yt,v as qt,r as D,c as Vt,a as L}from"./vue-CF-r4DcL.js";import{_ as $t}from"./index-f1N1sTxI.js";const Ut={class:"ball-escape-view"},Wt={class:"game-header"},zt={class:"game-id"},Kt={class:"label"},Zt={class:"balance-badge"},jt={class:"arena-container"},Jt={key:0,class:"result-text won"},Qt={key:1,class:"result-text lost"},te={class:"hash-row"},ee={class:"hash-value"},ae={class:"bet-row"},le=["onClick","disabled"],oe={class:"action-row"},ne=["disabled"],se={key:0},ie={key:1},re={key:2},f=340,yt=460,h=120,H=12,ut=.45,ce=.35,At=.82,de=1.8,It=.995,he=.025,ue=.06,gt=14,nt=16,z=170,K=150,v=360,R=80,Z=.028,ge=Ht({__name:"BallEscapeView",setup(fe){const ft=D(null),Y=D(10),Pt=[.5,1,3,5,10],y=D(1),o=D("idle"),x=D(1),pt=D(Math.floor(Math.random()*9e5)+1e5),st=D("---");let A=null,O=0,E=0,j=0,c=0,d=0,e=0,a=0,g=[],I=0,it=0,J=null,Q=0,mt=.02;const vt=[{main:"#fbbf24",glow:"rgba(251, 191, 36, ",light:"#fde68a"},{main:"#22d3ee",glow:"rgba(34, 211, 238, ",light:"#67e8f9"},{main:"#a855f7",glow:"rgba(168, 85, 247, ",light:"#c084fc"},{main:"#4ade80",glow:"rgba(74, 222, 128, ",light:"#86efac"},{main:"#f97316",glow:"rgba(249, 115, 22, ",light:"#fdba74"}],bt={main:"#ec4899",glow:"rgba(236, 72, 153, ",light:"#f9a8d4"};let rt=bt,St=0,ct=5e3,tt=!1,q=1,M=!1,N=null;const Rt=Vt(()=>o.value==="won"?"#4ade80":o.value==="lost"?"#ef4444":x.value>=2?"#4ade80":"#22d3ee");function xt(s){o.value==="idle"&&(y.value=s)}async function Et(){if(o.value==="playing"||Y.value<y.value)return;_t(),rt=vt[Math.floor(Math.random()*vt.length)],Y.value-=y.value,o.value="playing",x.value=1,pt.value=Math.floor(Math.random()*9e5)+1e5;const s=-Math.PI/2+(Math.random()-.5)*1.2,t=30+Math.random()*40;c=Math.cos(s)*t,d=Math.sin(s)*t;const l=Math.random()*Math.PI*2,n=4+Math.random()*3;e=Math.cos(l)*n,a=Math.sin(l)*n+2,O=0,E=Z,j=Math.random()*Math.PI*2,g=[],I=0,M=!1,N=null;try{const p=await Lt({amount:y.value,client_seed:Math.random().toString(36).substring(2,10),nonce:Date.now(),user_id:"user"});tt=p.escaped,ct=p.duration_ms,q=p.multiplier,st.value=p.server_seed_hash.slice(0,6)+"..."+p.server_seed_hash.slice(-4)}catch{tt=Math.random()<.4,ct=4e3+Math.random()*3e3,q=1.5+Math.random()*3.5,st.value=Math.random().toString(36).slice(2,8)+"..."}St=Date.now(),A=requestAnimationFrame(et)}function et(){const s=Date.now()-St,t=Math.min(s/ct,1);x.value=1+(q-1)*t,E=Z,O+=Z;const l=j+O;if(M){a+=.4,e*=.99;const u=z+c,at=((tt?f*.25:f*.75)-u)*.003;if(e+=at,c+=e,d+=a,g.unshift({x:z+c,y:K+d}),g.length>nt&&g.pop(),K+d>=v-H){N=z+c<f/2?"green":"red",d=v-H-K,a=0,e=0,Gt(N==="green");return}V(),A=requestAnimationFrame(et);return}const n=Math.sqrt(c*c+d*d);if(n>1){const u=E*E,G=he*u*n;e+=c/n*G,a+=d/n*G}const p=ue*E;e+=-a*p,a+=e*p,a+=ce,e*=It,a*=It;const _=Math.sqrt(e*e+a*a);_>gt&&(e=e/_*gt,a=a/_*gt),c+=e,d+=a,g.unshift({x:c,y:d}),g.length>nt&&g.pop(),I*=.88;const b=h-H,$=Math.sqrt(c*c+d*d);if($>b){const u=Math.atan2(d,c);if(Math.abs(Tt(u-l))<ut/2&&$>b-5){M=!0,g=[],e=Math.cos(u)*4,a=Math.sin(u)*4+2,V(),A=requestAnimationFrame(et);return}c=Math.cos(u)*b,d=Math.sin(u)*b;const P=Math.cos(u),i=Math.sin(u),S=e*P+a*i;if(S>0){e-=2*S*P,a-=2*S*i,e*=At,a*=At;const lt=de+Math.abs(S)*.3;e-=P*lt,a-=i*lt;const ot=-i,w=P,T=E*h*.5;e+=ot*T,a+=w*T;const C=(Math.random()-.5)*2.5;e+=ot*C,a+=w*C,I=1,it=u}}if(t>=1&&!M){M=!0,g=[];const u=tt?-60:60;c=0,d=h,e=u/25,a=2}V(),A=requestAnimationFrame(et)}function Gt(s){A&&cancelAnimationFrame(A),x.value=q,s?(o.value="won",Y.value+=y.value*q):o.value="lost",V(),setTimeout(()=>{o.value="idle",x.value=1,N=null,Mt()},2500)}function Tt(s){for(;s>Math.PI;)s-=Math.PI*2;for(;s<-Math.PI;)s+=Math.PI*2;return s}function V(){const s=ft.value;if(!s)return;const t=s.getContext("2d");if(!t)return;const l=z,n=K;t.fillStyle="#0a0c14",t.fillRect(0,0,f,yt);const p=v+R/2,_=t.createLinearGradient(0,v-60,0,v+R);_.addColorStop(0,"rgba(34, 197, 94, 0)"),_.addColorStop(.3,"rgba(34, 197, 94, 0.08)"),_.addColorStop(.6,"rgba(34, 197, 94, 0.25)"),_.addColorStop(1,"rgba(34, 197, 94, 0.5)"),t.fillStyle=_,t.fillRect(0,v-60,f/2,R+60);const b=t.createLinearGradient(0,v-60,0,v+R);b.addColorStop(0,"rgba(239, 68, 68, 0)"),b.addColorStop(.3,"rgba(239, 68, 68, 0.08)"),b.addColorStop(.6,"rgba(239, 68, 68, 0.25)"),b.addColorStop(1,"rgba(239, 68, 68, 0.5)"),t.fillStyle=b,t.fillRect(f/2,v-60,f/2,R+60),t.fillStyle="rgba(34, 197, 94, 0.6)",t.fillRect(0,v+10,f/2,R-10),t.fillStyle="rgba(239, 68, 68, 0.6)",t.fillRect(f/2,v+10,f/2,R-10),t.save(),t.shadowColor="rgba(255, 255, 255, 0.5)",t.shadowBlur=8,t.strokeStyle="rgba(255, 255, 255, 0.6)",t.lineWidth=2,t.beginPath(),t.moveTo(f/2,v-30),t.lineTo(f/2,v+R),t.stroke(),t.restore(),t.font="28px -apple-system, sans-serif",t.textAlign="center",t.textBaseline="middle";const $=f/4,u=N==="green";t.globalAlpha=u?1:.7,t.fillText("ðŸ‘‘",$-18,p+8),t.fillText("ðŸ’Ž",$+18,p+8),t.globalAlpha=1;const G=f*3/4,at=N==="red";t.globalAlpha=at?1:.7,t.fillText("ðŸ’€",G-18,p+8),t.fillText("â˜ ï¸",G+18,p+8),t.globalAlpha=1;const P=j+O,i=rt,S=t.createRadialGradient(l,n,h-20,l,n,h+15);S.addColorStop(0,i.glow+"0.0)"),S.addColorStop(.6,i.glow+"0.12)"),S.addColorStop(1,i.glow+"0.0)"),t.fillStyle=S,t.beginPath(),t.arc(l,n,h+15,0,Math.PI*2),t.fill();const lt=P-ut/2,ot=P+ut/2;t.save(),t.lineWidth=10,t.lineCap="round";const w=t.createLinearGradient(l-h,n-h,l+h,n+h);if(w.addColorStop(0,i.main),w.addColorStop(.3,i.light),w.addColorStop(.5,i.main),w.addColorStop(.8,i.main),w.addColorStop(1,i.light),t.strokeStyle=w,t.shadowColor=i.glow+"0.5)",t.shadowBlur=12,t.beginPath(),t.arc(l,n,h,ot,lt+Math.PI*2),t.stroke(),t.restore(),I>.05&&o.value==="playing"&&!M){const U=l+Math.cos(it)*h,W=n+Math.sin(it)*h,m=t.createRadialGradient(U,W,0,U,W,30*I);m.addColorStop(0,i.glow+`${I*.8})`),m.addColorStop(.5,i.glow+`${I*.4})`),m.addColorStop(1,i.glow+"0)"),t.fillStyle=m,t.beginPath(),t.arc(U,W,30*I,0,Math.PI*2),t.fill()}const T=t.createRadialGradient(l-30,n-30,0,l,n,h);if(T.addColorStop(0,i.glow+"0.05)"),T.addColorStop(.5,i.glow+"0.02)"),T.addColorStop(1,"rgba(0, 0, 0, 0)"),t.fillStyle=T,t.beginPath(),t.arc(l,n,h-10,0,Math.PI*2),t.fill(),g.length>1&&o.value==="playing"){const U=Math.sqrt(e*e+a*a),W=Math.min(U/8,1);for(let m=1;m<g.length;m++){const kt=(1-m/nt)*(.3+W*.5),Ft=H*(1-m/nt*.7);t.fillStyle=`rgba(34, 211, 238, ${kt})`,t.beginPath();const Bt=M?g[m].x:l+g[m].x,Dt=M?g[m].y:n+g[m].y;t.arc(Bt,Dt,Ft,0,Math.PI*2),t.fill()}}let C,X;M?(C=z+c,X=K+d):(C=l+c,X=n+d);const wt=Math.sqrt(e*e+a*a),dt=Math.min(.4+wt/10,1);t.shadowColor=o.value==="won"?`rgba(74, 222, 128, ${dt})`:o.value==="lost"?`rgba(239, 68, 68, ${dt})`:`rgba(34, 211, 238, ${dt})`,t.shadowBlur=10+wt*2;const k=t.createRadialGradient(C-3,X-3,0,C,X,H);o.value==="won"?(k.addColorStop(0,"#86efac"),k.addColorStop(1,"#22c55e")):o.value==="lost"?(k.addColorStop(0,"#fca5a5"),k.addColorStop(1,"#ef4444")):(k.addColorStop(0,"#67e8f9"),k.addColorStop(1,"#06b6d4")),t.fillStyle=k,t.beginPath(),t.arc(C,X,H,0,Math.PI*2),t.fill(),t.shadowBlur=0,t.fillStyle="rgba(255, 255, 255, 0.4)",t.beginPath(),t.arc(C-3,X-3,H*.3,0,Math.PI*2),t.fill(),o.value==="idle"&&(t.textAlign="center",t.textBaseline="middle",t.fillStyle="rgba(255, 255, 255, 0.8)",t.font="bold 18px -apple-system, sans-serif",t.fillText("This is Preview",l,n+h+30),t.fillStyle="rgba(255, 255, 255, 0.4)",t.font="13px -apple-system, sans-serif",t.fillText("Tap button below to play",l,n+h+52))}function Mt(){rt=bt,Q=Math.random()*Math.PI*2,mt=.015,O=0,E=Z,j=Math.PI*.7;const s=()=>{Q+=mt;const t=h*.4;c=Math.cos(Q)*t,d=Math.sin(Q)*t*.6+15,e=0,a=0,O+=Z,V(),J=requestAnimationFrame(s)};s()}function _t(){J&&(cancelAnimationFrame(J),J=null)}return Ot(()=>{Mt()}),Nt(()=>{A&&cancelAnimationFrame(A),_t()}),(s,t)=>(L(),F("div",Ut,[r("header",Wt,[r("button",{class:"header-close",onClick:t[0]||(t[0]=l=>s.$router.back())},[...t[1]||(t[1]=[r("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1),r("span",null,"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ",-1)])]),r("div",zt,[r("span",Kt,"Game #"+B(pt.value),1)]),r("div",Zt,[r("span",null,B(Y.value.toFixed(2))+" â—‡",1)])]),r("div",jt,[r("canvas",{ref_key:"gameCanvas",ref:ft,class:"game-canvas",width:f,height:yt},null,512),r("div",{class:ht(["multiplier-overlay",o.value])},[r("div",{class:"multiplier-value",style:Xt({color:Rt.value})},B(x.value.toFixed(2))+"x ",5),o.value==="won"?(L(),F("div",Jt,"ESCAPED!")):Ct("",!0),o.value==="lost"?(L(),F("div",Qt,"DEAD")):Ct("",!0)],2)]),r("div",te,[t[2]||(t[2]=r("span",{class:"hash-label"},"Hash:",-1)),r("span",ee,B(st.value),1)]),r("div",ae,[(L(),F(Yt,null,qt(Pt,l=>r("button",{key:l,class:ht(["bet-btn",{active:y.value===l}]),onClick:n=>xt(l),disabled:o.value==="playing"},B(l)+" â—‡ ",11,le)),64))]),r("div",oe,[r("button",{class:ht(["play-btn",{playing:o.value==="playing"}]),disabled:o.value==="playing"||Y.value<y.value,onClick:Et},[o.value==="idle"?(L(),F("span",se,"Play "+B(y.value)+" â—‡",1)):o.value==="playing"?(L(),F("span",ie,B(x.value.toFixed(2))+"x",1)):(L(),F("span",re,"Play Again"))],10,ne)])]))}}),be=$t(ge,[["__scopeId","data-v-c86d8155"]]);export{be as default};
